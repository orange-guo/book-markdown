<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://orange-guo.github.io/markdowns/blog</id>
    <title>Markdowns Blog</title>
    <updated>2023-02-22T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://orange-guo.github.io/markdowns/blog"/>
    <subtitle>Markdowns Blog</subtitle>
    <icon>https://orange-guo.github.io/markdowns/https://github.com/orange-guo.png</icon>
    <entry>
        <title type="html"><![CDATA[在springdoc-v2中在不配置@ParameterObject的情况下实现Pageable以及Sort对象到API参数的转换]]></title>
        <id>https://orange-guo.github.io/markdowns/blog/2023/02/22/index</id>
        <link href="https://orange-guo.github.io/markdowns/blog/2023/02/22/index"/>
        <updated>2023-02-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="介绍">介绍<a href="#介绍" class="hash-link" aria-label="Direct link to 介绍" title="Direct link to 介绍">​</a></h2><p><code>springdoc</code>是一个可以快速生成<code>API</code>文档的第三方公共库, 并提供了<code>UI</code>页面以供访问.<br>
同时它也提供了<code>spring-webmvc</code>中的<code>handler</code>中的复杂对象到<code>API</code>参数的映射, 这是一个将复杂对象的内部值映射到<code>API</code>参数上的功能.
官方要求需要使用<code>@ParameterObject</code>来进行修饰.<br>
对于<code>spring-data-commons</code>中的<code>Pageable</code>和<code>Sort</code>, <code>springdoc</code>提供了开箱即用的功能, 只需要在配置文件中启用即可<br></p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">springdoc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">model-converters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pageable-converter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>对于已经存在的项目, 当刚引入<code>springdoc</code>时, 需要配置大量的<code>@ParameterObject</code>注解以实现参数转换功能.<br>
这个过程通常比较繁琐, 因为对于一个具有一定规模的项目而言, 其对外提供的<code>API</code>往往会非常多,
需要进行大量的修改功能才能实现该功能<br>
那么此时我们需要一种解决方案, 即如何在不配置<code>@ParameterObject</code>的情况下实现<code>Pageable</code>以及<code>Sort</code>对象到API参数的转换</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="思路">思路<a href="#思路" class="hash-link" aria-label="Direct link to 思路" title="Direct link to 思路">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="parameterobject">@ParameterObject<a href="#parameterobject" class="hash-link" aria-label="Direct link to @ParameterObject" title="Direct link to @ParameterObject">​</a></h3><blockquote><p>在<code>springdoc</code>中, <code>@ParameterObject</code>注解的获取是来自于<code>spring-webmvc</code>中的<code>HandlerMethod</code>对象,</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="handlermethod">HandlerMethod<a href="#handlermethod" class="hash-link" aria-label="Direct link to HandlerMethod" title="Direct link to HandlerMethod">​</a></h3><p>这个对象是我们在<code>Controller</code>中声明的<code>Handler</code>的抽象, 它主要保存了我们声明的<code>Handler</code>的一些元信息. <br>
它的<code>MethodParameter[] parameters</code>属性包含了该方法的所有参数的信息.<br></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="methodparameter">MethodParameter<a href="#methodparameter" class="hash-link" aria-label="Direct link to MethodParameter" title="Direct link to MethodParameter">​</a></h3><p><code>MethodParameter</code>对象的<code>Annotation[] parameterAnnotations</code>属性包含了该参数的所有注解.<br>
我们可以尝试修改<code>Annotation[] parameterAnnotations</code>属性以实现动态添加<code>@ParameterObject</code>注解的功能.<br></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="handlermapping">HandlerMapping<a href="#handlermapping" class="hash-link" aria-label="Direct link to HandlerMapping" title="Direct link to HandlerMapping">​</a></h3><p>我们不能直接从<code>spring</code>容器中获取到<code>MethodHandler</code>, 因为其是保存在<code>HandlerMapping</code>中的, <code>HandlerMapping</code>
可以从容器中获取到.<br></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="beanpostprocessor">BeanPostProcessor<a href="#beanpostprocessor" class="hash-link" aria-label="Direct link to BeanPostProcessor" title="Direct link to BeanPostProcessor">​</a></h3><p><code>spring</code>中提供了<code>BeanPostProcess</code>机制, 主要实现了对<code>Bean</code>的创建进行拦截处理.<br>
我们可以实现<code>BeanPostProcessor</code>来对<code>HandlerMapping</code>中的<code>MethodHandler</code>中的<code>MethodParameter</code>的<code>parameterAnnotations</code>
进行修改以实现追加<code>@ParameterObject</code>注解</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="解决方案">解决方案<a href="#解决方案" class="hash-link" aria-label="Direct link to 解决方案" title="Direct link to 解决方案">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="新增appendspringdocannotationbeanpostprocessor用于实现增加parameterobject注解的能力">新增<code>AppendSpringdocAnnotationBeanPostProcessor</code>用于实现增加<code>@ParameterObject</code>注解的能力<a href="#新增appendspringdocannotationbeanpostprocessor用于实现增加parameterobject注解的能力" class="hash-link" aria-label="Direct link to 新增appendspringdocannotationbeanpostprocessor用于实现增加parameterobject注解的能力" title="Direct link to 新增appendspringdocannotationbeanpostprocessor用于实现增加parameterobject注解的能力">​</a></h3><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">AppendSpringdocAnnotationBeanPostProcessor.kt</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * We must add @ParameterObject annotation to Pageable and Sort parameter to ensure that springdoc can generate correct.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * But declaring @ParameterObject in the controller method is not a good idea, because it will take some time to.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * So we can use this class to avoid declaring @ParameterObject on method parameter which type is Pageable or Sort.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @author Xiangcheng.Kuo</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @see org.springdoc.core.annotations.ParameterObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @see &lt;a href="https://springdoc.org/v2/#how-can-i-map-pageable-spring-data-commons-object-to-correct-url-parameter-in-swagger-ui"&gt;13.22. How can I map Pageable (spring-data-commons) object to correct URL-Parameter in Swagger UI?&lt;/a&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">internal</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> AppendSpringdocAnnotationBeanPostProcessor </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> BeanPostProcessor </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">override</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fun</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">postProcessAfterInitialization</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bean</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> beanName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Any </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bean </span><span class="token operator" style="color:#393A34">!</span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> AbstractHandlerMethodMapping</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bean</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">handlerMethods</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">forEach</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handlerMethod</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HandlerMethod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            handlerMethod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">methodParameters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">filter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Pageable</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">java</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isAssignableFrom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">it</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parameterType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> Sort</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">java</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isAssignableFrom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">it</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parameterType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">forEach</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> methodParameter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> MethodParameter </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token function" style="color:#d73a49">addAnnotationForParameter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">methodParameter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fun</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addAnnotationForParameter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">methodParameter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> MethodParameter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> parameterAnnotationsField </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FieldUtils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getDeclaredField</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MethodParameter</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">java</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string-literal singleline string" style="color:#e3116c">"parameterAnnotations"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> annotations</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> MutableList</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Annotation</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parameterAnnotationsField</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">methodParameter</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Annotation</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token operator" style="color:#393A34">?:</span><span class="token plain"> emptyArray</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Annotation</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toMutableList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">annotations</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">anyMatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ParameterObject</span><span class="token operator" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token operator" style="color:#393A34">::</span><span class="token plain">isInstance</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        annotations</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FakeParameterObject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        parameterAnnotationsField</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">methodParameter</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> annotations</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toTypedArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="新增parameterobject的实现类-由于kotlin不支持继承annotation-需要新建java类来继承annotation">新增<code>@ParameterObject</code>的实现类, 由于<code>kotlin</code>不支持继承<code>annotation</code>, 需要新建<code>java</code>类来继承<code>annotation</code><a href="#新增parameterobject的实现类-由于kotlin不支持继承annotation-需要新建java类来继承annotation" class="hash-link" aria-label="Direct link to 新增parameterobject的实现类-由于kotlin不支持继承annotation-需要新建java类来继承annotation" title="Direct link to 新增parameterobject的实现类-由于kotlin不支持继承annotation-需要新建java类来继承annotation">​</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">FakeParameterObject.java</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Avoid the following kotlin compile error</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This type has a constructor, and thus must be initialized here</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This type is final, so it cannot be inherited from</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @author Xiangcheng.Kuo</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @see &lt;a href="https://stackoverflow.com/questions/51608924/implement-inherit-extend-annotation-in-kotlin"&gt;Implement (/inherit/~extend) annotation in Kotlin&lt;/a&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">FakeParameterObject</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">ParameterObject</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Class</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">extends</span><span class="token generics"> </span><span class="token generics class-name">Annotation</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">annotationType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">FakeParameterObject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">ParameterObject</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FakeParameterObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="新增configuration-将appendspringdocannotationbeanpostprocessor添加到容器中">新增Configuration, 将<code>AppendSpringdocAnnotationBeanPostProcessor</code>添加到容器中<a href="#新增configuration-将appendspringdocannotationbeanpostprocessor添加到容器中" class="hash-link" aria-label="Direct link to 新增configuration-将appendspringdocannotationbeanpostprocessor添加到容器中" title="Direct link to 新增configuration-将appendspringdocannotationbeanpostprocessor添加到容器中">​</a></h3><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">ApidocAutoConfiguration.kt</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @author Xiangcheng.Kuo</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation builtin">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">internal</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> ApidocAutoConfiguration </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation builtin">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation builtin">@ConditionalOnProperty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Constants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SPRINGDOC_ENABLED</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> matchIfMissing </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">fun</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">appendSpringdocAnnotationBeanPostProcessor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> BeanPostProcessor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">AppendSpringdocAnnotationBeanPostProcessor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考">参考<a href="#参考" class="hash-link" aria-label="Direct link to 参考" title="Direct link to 参考">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="springdoc-v2">springdoc-v2<a href="#springdoc-v2" class="hash-link" aria-label="Direct link to springdoc-v2" title="Direct link to springdoc-v2">​</a></h3><ul><li><a href="https://springdoc.org/v2/" target="_blank" rel="noopener noreferrer">springdoc v2</a></li><li><a href="https://springdoc.org/v2/#how-can-i-map-pageable-spring-data-commons-object-to-correct-url-parameter-in-swagger-ui" target="_blank" rel="noopener noreferrer">13.22. How can I map Pageable (spring-data-commons) object to correct URL-Parameter in Swagger UI?</a></li><li><a href="https://springdoc.org/v2/#how-can-i-extract-fields-from-parameter-object" target="_blank" rel="noopener noreferrer">13.61. How can I extract fields from parameter object ?</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spring">spring<a href="#spring" class="hash-link" aria-label="Direct link to spring" title="Direct link to spring">​</a></h3><ul><li><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/method/HandlerMethod.html" target="_blank" rel="noopener noreferrer">Class HandlerMethod</a></li><li><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/MethodParameter.html" target="_blank" rel="noopener noreferrer">Class MethodParameter</a></li><li><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/HandlerMapping.html" target="_blank" rel="noopener noreferrer">Interface HandlerMapping</a></li><li><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/config/BeanPostProcessor.html" target="_blank" rel="noopener noreferrer">Interface BeanPostProcessor</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kotlin">kotlin<a href="#kotlin" class="hash-link" aria-label="Direct link to kotlin" title="Direct link to kotlin">​</a></h3><ul><li><a href="https://stackoverflow.com/questions/51608924/implement-inherit-extend-annotation-in-kotlin" target="_blank" rel="noopener noreferrer">Implement (/inherit/~extend) annotation in Kotlin</a></li></ul>]]></content>
        <author>
            <name>Xiangcheng Kuo</name>
            <uri>https://github.com/orange-guo</uri>
        </author>
        <category label="springdoc" term="springdoc"/>
        <category label="spring" term="spring"/>
    </entry>
</feed>