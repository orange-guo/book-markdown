# 制定sprint计划

## sprint计划会议

#### 原因

Sprint计划会议非常关键，应该算是Scrum中最重要的活动（这当然是我的主观意见）。
要是它执行得不好，整个sprint甚至都会被毁掉。
举办sprint计划会议，是为了让团队获得足够的信息，能够在几个星期内不受干扰地工作，也是为了让产品负责人能对此有充分的信心。

#### 成果

- sprint目标
- 团队成员名单（以及他们的投入程度，如果不是100％的话）
- sprint backlog(故事列表)
- 确定sprint演示日期
- 确定每日Scrum会议的时间和地点

## 产品负责人必须参加

#### 原因

每个故事都含有三个变量，它们两两之间都对彼此有着强烈依赖。

- 范围 (scope)
- 重要性 (importance)
- 估算 (estimate)

##### 会议大概流程

- 产品负责人先概括一下这个sprint中希望能够达成的目标，还有他认为最重要的故事。
- 团队从最重要的故事开始逐一讨论每个故事
    - 估算时间。
    - 针对范围提出些重要问题
      例 `删除用户’这个故事，是否要遍历该用户所有未执行的事务并把它们取消`

> 在某些情况下，团队对故事做出的时间估算，跟产品负责人的想法不太一样。这可能会让他调整故事的重要性；或者修改故事的范围，导致团队重新估算，然后一连串诸如此类的连锁反应。

## 不能在质量上让步

#### 内部质量

一般指用户看不到的要素, 它们对系统的可维护性有深远影响
可维护性包括系统设计的一致性、测试覆盖率、代码可读性和重构等等

#### 外部质量

系统用户可以感知的。运行缓慢、让人迷糊的用户界面就属于外部质量低劣。
> 一般来说，系统内部质量优秀，外部质量仍有可能很差。而内部质量差的系统，外部质量肯定也不怎么样。松散的沙滩上怎么可能建起精美的楼阁

#### 以外部质量作为范围的一部分(三个变量中的范围), 在估算不够的情况下缩小

有时出于业务考虑，可能会先发布一个系统版本，其用户界面给人的感觉可能比较简陋，而且反应也很慢, 不过随后会发布一个干净的版本。
通常需要让产品负责人做权衡，因为他是负责定义项目范围的人。

#### 团队需要保证系统质量

不管什么时候，团队都要保证系统质量，没有任何回旋余地。

#### 不可以通过牺牲内部质量来节省故事量

牺牲内部质量是一个糟糕透顶的想法
现在节省下来一点时间，接下来的日子里你就要一直为它付出代价
一旦我们放松要求，允许代码库中暗藏问题，后面就很难恢复质量了

###### 如何解决

试着把话题转回到范围上来。

- 是否把范围缩小一点？这样实现时间就能缩短。
- 简化处理的功能，把`高级处理`当作一个单独的故事，放到以后再实现。
- 降低其他故事的优先级，好让集中处理这一个。

## 无休止的sprint计划会议

> Scrum中的一切事情都有时间盒。

#### 当会议接近尾声但没有得出结果怎么办

通常需要直接打断会议并中止它，具体一点，告诉团队和产品负责人：“这个会议要在10分钟以后结束。我们到目前为止还没有一个真正的sprint计划。是按照已经得出的结论去执行，还是明早8点再开4小时的会？”
> 学会按照时间盒安排工作，学会制定合乎情理的时间盒，这对会议长度和sprint长度同样有帮助。

## sprint计划会议

#### 时间规划(13:00–17:00, 每小时休息10分钟)

|                                       时间段                                       |                     说明                      |
|:-------------------------------------------------------------------------------:|:-------------------------------------------:|
|                                   13:00–13:30                                   | 产品负责人对sprint目标进行总体介绍，概括产品backlog。确定演示的时间和地点 |
|                                   13:30–15:00                                   |
 团队估算时间，在必要的情况下拆分backlog条目。产品负责人在必要时修改重要性评分。理清每个条目的含义。所有重要性高的backlog条目都要填写“如何演示” |
|                                   15:00–16:00                                   |    团队选择要放入sprint中的故事。计算生产率，用作核查工作安排的基础。     |
|                                   16:00–17:00                                   |                把故事进一步拆分成任务。                 |

#### sprint长度

> 范围从工作开始启动到sprint演示日期
> 时间短就好, 这样会变得敏捷, 有利于随机应变
> 短的sprint＝短反馈周期＝更频繁的交付＝更频繁的客户反馈＝在错误方向上花的时间更少＝学习和改进的速度更快，众多好处接踵而来。
> 绝大部分团队的sprint长度都是三周

#### 确定sprint目标

sprint目标应该是尚未达成的。“打动CEO”这个目标不错，可如果这个系统已经给他留下了深刻印象，那就算了。这种状况下大家都可以放假回家，sprint目标依然能完成。

#### 决定sprint要包含的故事

团队只能选择最重要的backlog
团队从`产品backlog`中根据估算的生产率选出列表顶部的backlog放入`sprint backlog`中
在sprint中包含多少故事由团队决定，而不是产品负责人或其他人。

## 产品负责人如何对sprint放哪些故事产生影响

- 重设优先级, 将故事设为最高重要级那么团队不得不把它放到sprint里来
- 拆分故事, 将一个故事一分为二从中选出最重要的故事重新设置优先级

## 团队怎样决定把哪些故事放到sprint里

#### 本能反应

如果sprint时间不长，小团队根据直觉进行估算可以收到很好的效果，

#### 生产率计算

可用人天*投入程度(根据一次sprint得出)=实际生产

#### 投入程度计算

假设在上个sprint里面，3人团队在3个星期内工作了45个人天，一共完成18个故事点。
18 / 45 得出百分之40的投入程度
根据实际可用人天来选择可以完成的故事

#### 生产率计算满足的条件

必须满足两个条件：团队已经完成了几个sprint（这样就可以得到统计数据），会以几乎完全相同的方式（团队长度不变，工作状态等条件不变）来进行下一个sprint。当然也不是绝对如此。

#### 常识

如果上一个sprint干得很糟，是因为大部分成员都病了一星期。那你差不多可以放心假设这次运气不会那么坏，给这个sprint设个高点的投入程度；如果团队最近刚装了一个执行速度快如闪电的持续集成系统，那你也可以因此提高一下投入程度；如果有新人加入这个sprint，就得把他的培训占用的精力也算进来，降低投入程度；等等。
只要条件允许，你就应该看看从前的sprint，计算出平均数，这样可以得到更合理的估算。

##### 默认投入程度

第一次可以使用默认投入程度百分之70

## 索引卡

创建一些索引卡，把它们放到墙上根据重要性从左到右展示故事

#### 索引卡比计算机和投影仪好的理由

- 大家站起来四处走动可以更长时间地保持清醒，并留心会议进展。
- 他们有更多的个人参与感
- 多个故事可以同时编辑。
- 重新划分优先级变得易如反

#### 不要将任务拆分出现在产品backlog中

1. 任务拆分的随机性比较强，在sprint进行中，它们常常会发生变化，不断调整，所以保持产品backlog的同步很让人头大
2. 任务拆分的即时贴可以和故事索引卡一起，在sprint backlog中被直接重用

## 任务定义完成

日常的一些认识往往要好过正式的检查列表。(现在我们常说“如果Scrum团队中的测试人员说可以，那这个故事就算完成了”)
如果你常常对怎样定义完成感到困惑（就像我们刚开始一样），你或许应该在每个故事上都添加一个字段，起名为“何谓完成”。

## 使用计划扑克做时间估算

#### 为啥要每个人都参加？

- 在计划的时候，还不知道到底谁会来实现哪个故事的哪个部分
- 每个故事一般有好几个人参与，也包括不同类型的专长（界面设计、编程、测试等）
- 团队成员必须要对故事内容有一定的理解才能进行估算, 每个人都做估算，可以确保他们都理解了每个条目的内容
- 每个人都对故事做估算，我们就会常常发现两个人对同一个故事的估算结果差异很大。可以尽早发现这种问题并进行讨论

#### 估算被影响

> 如果让整个团队进行估算，通常那个对故事理解最透彻的人会第一个发言。不幸的是，这会严重影响其他人的估算。

#### 计划扑克避免估算时间被影响

在估算故事的时候，每个人都选出一张纸牌来表示他的时间估算(故事点)
，并把它正面朝下扣在桌上。所有人都完成以后，桌上的纸牌会被同时揭开。这样每个人都会被迫进行自我思考，而不依赖其他人估算结果。

## 明确故事内容

#### 确保产品负责人和团队对故事有同样的理解

确保每个故事的所有字段都被填满（更精确地说，这里提到的是具有高优先级，应该在这个sprint里面完成的故事）

#### `如何演示`应非常精简

用最平白浅显的语言描述如何手工执行最典型的测试场景。`先这样，然后那样，最后验证这一点。`
这种简单的描述常常能够发现对于故事范围的最严重的误解。这种事发现得越早越好

#### 大故事拆分成小的故事

很大的故事基本上都能进行拆分。确定每个小故事可以交付业务价值就行。
确保故事的大小在2至8个人—天之间。一个普通团队的生产率大约是40—60，所以大概每个sprint可以完成10个故事。有时会减少到5个，有时也会到15个。这个数量范围之间的索引卡比较容易管理

#### 把故事拆分成任务

故事是可以交付的东西，是产品负责人所关心的。任务是不可交付的东西，产品负责人对它也不关心。
> 把sprint计划会议的时间放到足够长确保有时间拆分，但如果不够的话, 就不做了。
> 在实践TDD几乎每个故事的第一个任务是`编写一个失败的测试`，最后一个任务是`重构`

## 定下每日例会的时间地点

默认做法选一个大家都不会有异议的最早时间
一般9:00, 9:30或者10:00
最关键的是必须是每个人都能完全接受的时间

## 如果会议时间不够的话可以把哪些本该做的事情砍掉(优先级列表, 不优先的可以砍掉)

- sprint目标和演示日期。
- 经团队认可、要添加到当前sprint中的故事列表。
- sprint中每个故事的估算值。
- sprint中每个故事的“如何演示”。
- 生产率和资源计算，用作sprint计划的现实核查。包括团队成员的名单及每个人的承诺（不然就没法计算生产率）。
- 明确每日例会固定举行的时间地点。这只需要花几分钟，但如果时间不够用，ScrumMaster可以在会后直接定下来，邮件通知所有人。
- 把故事拆分成任务。这个拆分也可以在每日例会上做，不过这会稍稍打乱sprint的流程。

## 技术故事

> 技术故事或非功能性条目
> 需要完成但又不属于可交付物的东西，跟任何故事都没有直接关联，不会给产品负责人带来直接的价值

#### 例子

- 安装持续构建服务器
- 编写系统设计概览
- ...

#### 如何确保技术故事能够被加入到sprint里

> 技术故事常常会因为某种原因给设置一个低优先级，例如被产品负责人要求做给产品负责人带来直接的价值的故事

- 试着避免技术故事。努力找到一种方式，把技术故事变成可以衡量业务价值的普通故事。有助于产品负责人做出正确的权衡。
- 如果无法把技术故事转变成普通故事，那就看看这项工作能不能当作另一个故事中的某个任务。
- 如果以上二者都不管用，那就把它定义为一个技术故事，用另外一个单独的列表来存放。产品负责人能看到它，但是不能编辑它。用“投入程度”和“预估生产率”这两个参数来跟产品负责人协商，从sprint里拨出一些时间来完成这些技术故事。

## 总结

> sprint计划会议是Scrum中最重要的活动。在这里投入大量努力，保证它顺利完成，后面的工作就会轻松很多。
> 如果每个人（所有的团队成员和产品负责人）离开会场时都面带微笑，第二天醒来时面带微笑，在第一次的每日例会上面带微笑，那sprint计划会议就是成功的。
