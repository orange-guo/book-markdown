"use strict";(self.webpackChunkmarkdowns=self.webpackChunkmarkdowns||[]).push([[1353],{8789:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"/2023/03/15/2023-03-15/ldap-client-failover","metadata":{"permalink":"/markdowns/blog/2023/03/15/2023-03-15/ldap-client-failover","source":"@site/blog/2023-03-15/2023-03-15-ldap-client-failover.md","title":"\u901a\u8fc7\u589e\u52a0timeout-control\u4ee5\u89e3\u51b3\u5f53tcp\u8fde\u63a5\u4e00\u76f4\u5904\u4e8eSYN_SENT\u72b6\u6001\u5bfc\u81f4java\u4e2d\u7684ldap-client\u7684failover\u4e0d\u5de5\u4f5c\u7684\u95ee\u9898","description":"\u4eca\u5929\u9047\u5230\u4e00\u4e2a\u95ee\u9898\u662f\u5f53\u6d4b\u8bd5\u6a21\u62dfldap\u7684\u670d\u52a1\u7aef\u4e3b\u8282\u70b9\u6302\u6389\u7684\u65f6\u5019\u5e76\u5728\u9875\u9762\u70b9\u51fb\u767b\u5f55, \u540e\u7aef\u4e00\u76f4\u672a\u4f5c\u51fa\u54cd\u5e94.","date":"2023-03-15T00:00:00.000Z","formattedDate":"March 15, 2023","tags":[{"label":"problem-solving","permalink":"/markdowns/blog/tags/problem-solving"},{"label":"java","permalink":"/markdowns/blog/tags/java"},{"label":"ldap","permalink":"/markdowns/blog/tags/ldap"},{"label":"failover","permalink":"/markdowns/blog/tags/failover"},{"label":"spring","permalink":"/markdowns/blog/tags/spring"}],"readingTime":9.01,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["problem-solving","java","ldap","failover","spring"]},"nextItem":{"title":"IntelliJ IDEA\u4e2d\u5b9e\u73b0\u81ea\u5b9a\u4e49\u6ce8\u89e3\u4e2d\u7684\u8bed\u6cd5\u9ad8\u4eae","permalink":"/markdowns/blog/2023/03/14/intellij-idea-language-injection"}},"content":"\u4eca\u5929\u9047\u5230\u4e00\u4e2a\u95ee\u9898\u662f\u5f53\u6d4b\u8bd5\u6a21\u62df`ldap`\u7684\u670d\u52a1\u7aef\u4e3b\u8282\u70b9\u6302\u6389\u7684\u65f6\u5019\u5e76\u5728\u9875\u9762\u70b9\u51fb\u767b\u5f55, \u540e\u7aef\u4e00\u76f4\u672a\u4f5c\u51fa\u54cd\u5e94.<br/>\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u4ee3\u7801\u4e2d\u7684`ldap-client`\u7684`failover`\u672a\u751f\u6548, \u901a\u8fc7\u6392\u67e5\u53d1\u73b0`ldap-client`\u4e00\u76f4\u5728\u8fde\u63a5`ldap`\u7684\u4e3b\u8282\u70b9,\\n\u5e76\u4e14`tcp`\u8fde\u63a5\u4e00\u76f4\u5904\u4e8e`SYN_SENT`\u72b6\u6001.<br/>\\n\u7531\u4e8e`ldap-client`\u6ca1\u6709\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709\u63a7\u5236\u8d85\u65f6, \u5bfc\u81f4\u4ee3\u7801\u4e00\u76f4\u5835\u585e, \u4ece\u800c\u5bfc\u81f4`failover`\u4e0d\u5de5\u4f5c.<br/>\\n\u4e0b\u9762\u5c06\u5f00\u59cb\u4ecb\u7ecd\u5177\u4f53\u7ec6\u8282\u4ee5\u53ca\u89e3\u51b3\u65b9\u6848.<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u6392\u67e5\u8fc7\u7a0b\\n\\n### \u786e\u8ba4\u670d\u52a1\u914d\u7f6e\u7684`ldap`\u5730\u5740\u6709\u90a3\u4e9b\\n\\n\u6267\u884c`docker inspect`\u547d\u4ee4, \u786e\u8ba4\u670d\u52a1\u914d\u7f6e\u7684`ldap`\u5730\u5740\\n\\n```log\\nsudo docker inspect fastone-api |grep \'spring.ldap.urls\'\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```log\\n                \\"spring.ldap.urls=ldap://10.0.3.16:389,ldap://10.0.3.3:389\\",\\n```\\n\\n\u53ef\u4ee5\u770b\u5230\u914d\u7f6e\u4e86\u4e24\u4e2a`ldap`\u5730\u5740\u5206\u522b\u4e3a\\n\\n- ldap://10.0.3.16:389\\n- ldap://10.0.3.3:389\\n\\n### \u786e\u8ba4\u670d\u52a1\u7684\u8fdb\u7a0bID\\n\\n\u6267\u884c`ps`\u547d\u4ee4, \u786e\u8ba4\u670d\u52a1\u7684\u8fdb\u7a0bID\\n\\n```bash\\nps -ef |grep FastoneApplication\\n```\\n\\n\u547d\u4ee4\u8f93\u51fa\u5982\u4e0b\\n\\n```log\\nubuntu   22663 14459  0 16:52 pts/5    00:00:00 grep --color=auto FastoneApplication\\nroot     31320 31246  1 14:23 ?        00:02:39 java -cp @/app/jib-classpath-file com.fastonetech.fastone.FastoneApplication\\n```\\n\\n\u53ef\u4ee5\u770b\u5230\u8fdb\u7a0bID\u4e3a`31320`, \u63a5\u4e0b\u6765\u901a\u8fc7`lsof`\u547d\u4ee4\u67e5\u770b`31320`\u8fdb\u7a0b\u7684`tcp`\u8fde\u63a5\u72b6\u6001<br/>\\n\\n### \u786e\u8ba4\u670d\u52a1\u8fdb\u7a0b\u7684`tcp`\u8fde\u63a5\u72b6\u6001\\n\\n\u901a\u8fc7`lsof`\u67e5\u770b`tcp`\u8fde\u63a5\u72b6\u6001\\n\\n```bash\\nsudo lsof -p 31320 |grep \'10.0.3.16\'\\n```\\n\\n\u547d\u4ee4\u8f93\u51fa\u5982\u4e0b\\n\\n```log\\njava    31320 root  506u     IPv6            5728853       0t0     TCP fastone:37408->10.0.3.16:ldap (SYN_SENT)\\n```\\n\\n\u53ef\u4ee5\u770b\u5230\u670d\u52a1\u8fdb\u7a0b\u7684`tcp`\u8fde\u63a5\u72b6\u6001\u4e00\u76f4\u5904\u4e8e`SYN_SENT`\u72b6\u6001.<br/>\\n\\n> `SYN_SENT`\u72b6\u6001\u7684\u8fde\u63a5, \u8bf4\u660e\u5ba2\u6237\u7aef\u5df2\u7ecf\u53d1\u9001\u4e86`SYN`\u5305, \u4f46\u662f\u6ca1\u6709\u6536\u5230`SYN/ACK`\u5305, \u6b64\u65f6\u4f1a\u5904\u4e8e`SYN_SENT`\u72b6\u6001<br/>\\n\\n## Workaround\\n\\n\u7531\u4e8e\u8fd9\u4e2a\u95ee\u9898\u4f1a`blocking`\u6d4b\u8bd5\u8fdb\u5ea6\u6240\u4ee5\u9700\u8981\u5148\u7ed9\u51fa\u4e00\u4e2a`workaround`\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898.<br/>\\n\u76ee\u524d\u7684\u89e3\u51b3\u65b9\u6848\u662f\u901a\u8fc7`iptables`\u9650\u5236`tcp`\u8fde\u63a5, \u4f7f\u5176\u76f4\u63a5`Connection refused`. \u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u6d4b\u8bd5\u80fd\u591f\u7ee7\u7eed\u8fdb\u884c<br/>\\n\\n### \u901a\u8fc7`iptables`\u65b0\u589e`OUTPUT`\u89c4\u5219\u4f7f`tcp`\u8fde\u63a5\u76f4\u63a5\u5931\u8d25\\n\\n- \u65b0\u589eOUTPUT\u89c4\u5219\\n\\n> \u6ce8\u610f`target`\u5e94\u8be5\u4e3a`REJECT`\u800c\u4e0d\u662f`DROP`.<br/>\\n> \u8fd9\u662f\u56e0\u4e3a`DROP`\u5bf9\u4e8e`tcp`\u8fde\u63a5\u6765\u8bf4, \u4f1a\u76f4\u63a5\u4e22\u5f03\u6570\u636e\u5305.<br/>\\n> \u6240\u4ee5\u9700\u8981\u4f7f\u7528`REJECT`\u6765\u62d2\u7edd\u8fde\u63a5, \u5e76\u4e14\u9700\u8981\u6307\u5b9a`--reject-with tcp-reset`\u6765\u62d2\u7edd\u8fde\u63a5.<br/>\\n> \u8fd9\u6837\u5ba2\u6237\u7aef\u4f1a\u77e5\u9053\u8fde\u63a5\u88ab\u62d2\u7edd\u4e86\u800c\u4e0d\u662f\u4e00\u76f4\u5904\u4e8e`SYN_SENT`\u72b6\u6001.<br/>\\n\\n```bash\\nsudo iptables -A OUTPUT -p tcp -d 10.0.3.16 --dport 389 -j REJECT --reject-with tcp-reset\\n```\\n\\n- \u67e5\u770b\u89c4\u5219\u5217\u8868\\n\\n```bash\\nsudo iptables -L OUTPUT -v -n\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```log\\nChain OUTPUT (policy ACCEPT 301 packets, 95101 bytes)\\npkts bytes target     prot opt in     out     source               destination         \\n0     0 REJECT     tcp  --  *      *       0.0.0.0/0            10.0.3.16            tcp dpt:389 reject-with tcp-reset\\n```\\n\\n\u53ef\u4ee5\u770b\u5230, \u65b0\u589e\u4e86\u4e00\u6761`REJECT`\u89c4\u5219<br/>\\n\\n- \u6d4b\u8bd5\u89c4\u5219\u662f\u5426\u751f\u6548\\n\\n```bash\\ntelnet 10.0.3.16 389\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```log\\nTrying 10.0.3.16...\\ntelnet: Unable to connect to remote host: Connection refused\\n```\\n\\n\u53ef\u4ee5\u770b\u5230\u8fde\u63a5\u88ab\u62d2\u7edd\u4e86, \u8bf4\u660e\u89c4\u5219\u751f\u6548\u4e86<br/>\\n\\n### \u5220\u9664\u89c4\u5219\\n\\n\u5f53\u4fee\u590d\u4ee3\u7801\u540e, \u9700\u8981\u5220\u9664\u89c4\u5219, \u4ee5\u4fbf\u6d4b\u8bd5\u7ee7\u7eed\u8fdb\u884c<br/>\\n\\n- \u5220\u9664\u89c4\u5219\\n\\n```bash\\nsudo iptables -D OUTPUT -p tcp -d 10.0.3.16 --dport 389 -j REJECT --reject-with tcp-reset\\n```\\n\\n- \u67e5\u770b\u89c4\u5219\u5217\u8868\\n\\n```bash\\nsudo iptables -L OUTPUT -v -n\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```log\\nChain OUTPUT (policy ACCEPT 1922 packets, 947K bytes)\\n pkts bytes target     prot opt in     out     source               destination    \\n```\\n\\n- \u786e\u8ba4\u8fde\u63a5\u72b6\u6001\u6062\u590d\u5982\u521d\\n\\n```bash\\ntelnet 10.0.3.16 389\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```log\\nTrying 10.0.3.16...\\n^C\\n```\\n\\n\u53ef\u4ee5\u770b\u5230\u8fde\u63a5\u72b6\u6001\u6062\u590d\u5982\u521d, \u5ba2\u6237\u7aef\u4e00\u76f4\u5904\u4e8e`SYN_SENT`\u72b6\u6001<br/>\\n\\n## \u95ee\u9898\u539f\u56e0\\n\\n\u6839\u636e\u4e0a\u9762\u7684\u5206\u6790, \u95ee\u9898\u7684\u539f\u56e0`TCP`\u8fde\u63a5\u72b6\u6001\u4e00\u76f4\u5904\u4e8e`SYN_SENT`\u72b6\u6001\u5bfc\u81f4`ldap`\u7684`failover`\u672a\u751f\u6548<br/>\\n\\n### \u504f\u79bb\u8bbe\u8ba1\u9884\u671f\\n\\n\u8fd9\u91cc\u8ddf\u6211\u4e00\u5f00\u59cb\u8bbe\u8ba1\u6709\u504f\u5dee, \u56e0\u4e3a\u6211\u4e00\u5f00\u59cb\u7684\u8bbe\u60f3\u7684\u9884\u671f\u5e94\u8be5\u662f\u76f4\u63a5`Connection refused`, \u7c7b\u4f3c\u5982\u4e0b\u884c\u4e3a\\n\\n#### \u975e\u5835\u585e\\n\\n```bash\\ntelnet localhost 389\\n```\\n\\n\u5f53\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u65f6, \u4f1a\u76f4\u63a5\u62a5\u9519\\n\\n```log\\nTrying 127.0.0.1...\\ntelnet: Unable to connect to remote host: Connection refused\\n```\\n\\n\u670d\u52a1\u7aef\u4f1a\u76f4\u63a5\u62d2\u7edd\u8fde\u63a5, \u4f46\u662f\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u8fd9\u6837\u7684\u884c\u4e3a, \u670d\u52a1\u7aef\u4e00\u76f4\u5904\u4e8e`SYN_SENT`\u72b6\u6001, \u4e5f\u5c31\u662f\u8bf4\u670d\u52a1\u7aef\u4e00\u76f4\u5728\u5c1d\u8bd5\u8fde\u63a5<br/>\\n\\n#### \u5835\u585e\\n\\n\u7c7b\u4f3c\u5982\u4e0b\u884c\u4e3a\\n\\n```bash\\ntelnet 10.0.3.16 389\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b\\n\\n```log\\nTrying 10.0.3.16...\\n^C\\n```\\n\\n\u53ef\u4ee5\u770b\u5230\u4e00\u76f4\u5728\u5c1d\u8bd5\u8fde\u63a5, \u4f46\u662f\u5e76\u6ca1\u6709\u8d85\u65f6, \u4e5f\u5c31\u662f\u8bf4\u4e00\u76f4\u5728\u5c1d\u8bd5\u8fde\u63a5<br/>\\n\\n### `ldap-client`\u7684`timeout-control`\u672a\u751f\u6548\\n\\n\u53e6\u5916\u4e00\u4e2a\u95ee\u9898\u662f`tpc`\u4e00\u76f4\u5904\u4e8e`SYN_SENT`\u72b6\u6001\u7406\u8bba\u6765\u8bf4\u5e94\u8be5\u89e6\u53d1`timeout-control`, \u4f46\u662f\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u89e6\u53d1<br/>\\n\\n\u63a5\u4e0b\u6765\u6211\u4eec\u9700\u8981\u770b\u4e00\u4e0b`java-ldap`\u4e2d\u662f\u5982\u4f55\u5b9e\u73b0`timeout-control`\u7684<br/>\\n\\n#### \u9ed8\u8ba4\u8d85\u65f6\u65f6\u95f4\\n\\n\u5728`java`\u4e2d`ldap`\u7684\u8fde\u63a5\u662f\u7531`com.sun.jndi.ldap.LdapCtx.connectTimeout`\u63a7\u5236\u7684.<br/>\\n\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\\n\\n```java\\npublic final class LdapCtx extends ComponentDirContext\\n\\timplements EventDirContext, LdapContext {\\n\\n\\tprivate int connectTimeout = -1;         // no timeout value\\n\\n}\\n```\\n\\n\u53ef\u4ee5\u770b\u5230`connectTimeout`\u9ed8\u8ba4\u503c\u4e3a`-1`, \u4e5f\u5c31\u662f\u8bf4\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u6ca1\u6709\u8d85\u65f6\u7684. \u8fd9\u5176\u5b9e\u4e0d\u5408\u7406, \u56e0\u4e3a\u7f51\u7edc\u8fde\u63a5\u662f\u6709\u8d85\u65f6\u7684,\\n\u5426\u5219\u4f1a\u5bfc\u81f4\u4ee3\u7801\u4e00\u76f4\u5835\u585e<br/>\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u7ee7\u627f`LdapContextSource`\u5e76\u589e\u52a0`timeout-control`\u914d\u7f6e\\n\\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b`ldap`\u662f\u6ca1\u6709`timeout-control`\u7684, \u4e0d\u8fc7\u5176\u63d0\u4f9b\u4e86\u914d\u7f6e`connectTimeout`\u7684\u65b9\u6cd5, \u662f\u901a\u8fc7`environment`\u6765\u914d\u7f6e\u7684.<br/>\\n\u5bf9\u4e8e\u4e0a\u5c42\u5e94\u7528\u6765\u8bf4\u6211\u4eec\u7528\u7684\u662f\u901a\u8fc7`spring`\u5c01\u88c5\u8fc7\u7684`ldap`, \u6240\u4ee5\u6211\u4eec\u9700\u8981\u5bf9\u4e8e`spring`\u8fdb\u884c\u6269\u5c55,\\n\u4e3b\u8981\u662f\u901a\u8fc7\u7ee7\u627f`LdapContextSource`\u6765\u5b9e\u73b0<br/>\\n\\n```java title=\\"WithMoreEnvironmentContextSource.java\\"\\n/**\\n * The extension of {@link LdapContextSource} to support more environment.\\n * Sometimes we need to set more environment to environment.\\n * For example, we need to set the connectTimeout to avoid thread blocking and makesure the failover works.\\n * For more details about the connectTimeout, see {@link com.sun.jndi.ldap.LdapCtx.connectTimeout}\\n * For more details about the readTimeout, see {@link com.sun.jndi.ldap.LdapCtx.readTimeout}\\n * For more details about the ldap failover, see {@link com.sun.jndi.ldap.LdapCtxFactory#getUsingURLs}\\n *\\n * @author Xiangcheng.Kuo\\n */\\npublic class WithMoreEnvironmentContextSource extends LdapContextSource {\\n\\n\\tprivate Integer connectTimeout = -1;\\n\\n\\tprivate Integer readTimeout = -1;\\n\\n\\tpublic void setConnectTimeout(Integer connectTimeout) {\\n\\t\\tthis.connectTimeout = connectTimeout;\\n\\t}\\n\\n\\tpublic void setReadTimeout(Integer readTimeout) {\\n\\t\\tthis.readTimeout = readTimeout;\\n\\t}\\n\\n\\t@Override\\n\\tprotected DirContext getDirContextInstance(Hashtable<String, Object> environment) throws NamingException {\\n\\t\\t// The module named \\"com.sun.jndi.ldap.LdapCtx\\" is not exported.\\n\\t\\t// So we can\'t use the following code\\n\\t\\t// LdapCtx.CONNECT_TIMEOUT\\n\\t\\t// For more information about CONNECT_TIMEOUT\\n\\t\\t// see 1. LdapCtx.initEnv 2. Connection.createSocket\\n\\t\\tenvironment.put(\\"com.sun.jndi.ldap.connect.timeout\\", connectTimeout.toString());\\n\\t\\tenvironment.put(\\"com.sun.jndi.ldap.read.timeout\\", readTimeout.toString());\\n\\t\\treturn super.getDirContextInstance(environment);\\n\\t}\\n\\n}\\n```\\n\\n### \u5c06`WithMoreEnvironmentContextSource`\u6dfb\u52a0\u5230\u5bb9\u5668\u4e2d\\n\\n\u63a5\u4e0b\u6765\u9700\u8981\u5c06`WithMoreEnvironmentContextSource`\u6dfb\u52a0\u5230\u5bb9\u5668\u4e2d, \u786e\u4fdd\u4e0a\u5c42\u7684\u4f9d\u8d56\u5982`LdapTemplate`\u4ee5\u53ca\u81ea\u5b9a\u4e49\u7684`Reposity`\\n\u4f7f\u7528\u5230\u6211\u4eec\u6269\u5c55\u7684`LdapContextSource`<br/>\\n\\n```java title=\\"LdapConfiguration.java\\"\\n\\n@Configuration\\npublic class LdapConfiguration {\\n\\n\\t@Bean\\n\\tpublic LdapContextSource ldapContextSource(\\n\\t\\tLdapProperties properties,\\n\\t\\tEnvironment environment,\\n\\t\\tObjectProvider<DirContextAuthenticationStrategy> dirContextAuthenticationStrategy\\n\\t) {\\n\\t\\t// copy from org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration#ldapContextSource\\n\\t\\tWithMoreEnvironmentContextSource source = new WithMoreEnvironmentContextSource();\\n\\t\\tdirContextAuthenticationStrategy.ifUnique(source::setAuthenticationStrategy);\\n\\t\\tPropertyMapper propertyMapper = PropertyMapper.get().alwaysApplyingWhenNonNull();\\n\\t\\tpropertyMapper.from(properties.getUsername()).to(source::setUserDn);\\n\\t\\tpropertyMapper.from(properties.getPassword()).to(source::setPassword);\\n\\t\\tpropertyMapper.from(properties.getAnonymousReadOnly()).to(source::setAnonymousReadOnly);\\n\\t\\tpropertyMapper.from(properties.getBase()).to(source::setBase);\\n\\t\\tpropertyMapper.from(properties.determineUrls(environment)).to(source::setUrls);\\n\\t\\tpropertyMapper.from(properties.getBaseEnvironment()).to(\\n\\t\\t\\t(baseEnvironment) -> source.setBaseEnvironmentProperties(Collections.unmodifiableMap(baseEnvironment)));\\n\\n\\t\\t// We need to make sure the failover works fast when using multiple ldap backend\\n\\t\\tif (properties.getUrls().length > 1) {\\n\\t\\t\\tsource.setConnectTimeout(2000);\\n\\t\\t\\tsource.setReadTimeout(2000);\\n\\t\\t}\\n\\n\\t\\treturn source;\\n\\t}\\n\\n}\\n```\\n\\n\u4e3b\u8981\u4ee3\u7801\u590d\u5236\u81ea`org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration#ldapContextSource`,\\n\u5177\u4f53\u7ec6\u8282\u53ef\u4ee5\u53c2\u8003\u5176\u6e90\u7801<br/>\\n\\n## \u5907\u6ce8\\n\\n### \u5f53`iptables`\u89c4\u5219\u8f83\u591a\u81ea\u5b9a\u4e49\u7684\u53d7\u5f71\u54cd, \u5982\u4e0b\u6240\u793a\\n\\n```bash\\nsudo iptables -L OUTPUT -v -n\\n```\\n\\n```log\\nChain OUTPUT (policy ACCEPT 186K packets, 95M bytes)\\n pkts bytes target     prot opt in     out     source               destination         \\n    0     0 DROP       tcp  --  *      *       10.0.3.16            0.0.0.0/0            tcp dpt:3306\\n    0     0 DROP       tcp  --  *      *       10.0.3.16            0.0.0.0/0            tcp dpt:389\\n    0     0 DROP       tcp  --  *      *       10.0.3.16            0.0.0.0/0            tcp spt:389\\n    0     0 DROP       tcp  --  *      *       10.0.3.16            0.0.0.0/0            tcp spt:389\\n   63  3276 DROP       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            state NEW tcp dpt:389\\n    0     0 REJECT     tcp  --  *      *       0.0.0.0/0            10.0.3.16            tcp dpt:389 reject-with tcp-reset\\n```\\n\\n\u9700\u8981\u6e05\u7a7a\u6240\u6709OUTPUT\u89c4\u5219\\n\\n```bash\\nsudo iptables -F OUTPUT\\n```\\n\\n\u91cd\u65b0\u67e5\u770bOUTPUT\u89c4\u5219\\n\\n```bash\\nsudo iptables -L OUTPUT -v -n\\n```\\n\\n```log\\nChain OUTPUT (policy ACCEPT 1883 packets, 1126K bytes)\\n pkts bytes target     prot opt in     out     source               destination      \\n```\\n\\n## \u53c2\u8003\\n\\n- [What means SYN_SENT status in a socket?](https://medium.com/devsys/what-means-syn-sent-status-in-a-socket-5ea03eaf6ca9)\\n- [Viewing NETSTAT Information](https://www.cisco.com/assets/sol/sb/CVR100W_GUI_EN/help/EN_help/status13.html)\\n- [What is SYN_SENT socket status?](http://karunsubramanian.com/network/what-is-syn_sent-socket-status/)"},{"id":"/2023/03/14/intellij-idea-language-injection","metadata":{"permalink":"/markdowns/blog/2023/03/14/intellij-idea-language-injection","source":"@site/blog/2023-03-14/intellij-idea-language-injection.md","title":"IntelliJ IDEA\u4e2d\u5b9e\u73b0\u81ea\u5b9a\u4e49\u6ce8\u89e3\u4e2d\u7684\u8bed\u6cd5\u9ad8\u4eae","description":"\u8fd9\u7bc7\u6587\u7ae0\u662f\u57fa\u4e8eclojure\u8868\u8fbe\u5f0f\u5b9e\u73b0\u66f4\u52a0\u7075\u6d3b\u7684\u6570\u636e\u9a8c\u8bc1\u7684\u540e\u7eed\u4f18\u5316\u7684\u6587\u7ae0.","date":"2023-03-14T00:00:00.000Z","formattedDate":"March 14, 2023","tags":[{"label":"intellij-idea","permalink":"/markdowns/blog/tags/intellij-idea"}],"readingTime":1.325,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["intellij-idea"]},"prevItem":{"title":"\u901a\u8fc7\u589e\u52a0timeout-control\u4ee5\u89e3\u51b3\u5f53tcp\u8fde\u63a5\u4e00\u76f4\u5904\u4e8eSYN_SENT\u72b6\u6001\u5bfc\u81f4java\u4e2d\u7684ldap-client\u7684failover\u4e0d\u5de5\u4f5c\u7684\u95ee\u9898","permalink":"/markdowns/blog/2023/03/15/2023-03-15/ldap-client-failover"},"nextItem":{"title":"\u4f7f\u7528IntelliJ IDEA\u4e2d\u7684java-decompiler\u63d2\u4ef6\u5c06jar\u5305\u53cd\u7f16\u8bd1\u4e3ajava\u6e90\u7801","permalink":"/markdowns/blog/2023/03/13/2023-03-13/"}},"content":"\u8fd9\u7bc7\u6587\u7ae0\u662f[\u57fa\u4e8e`clojure`\u8868\u8fbe\u5f0f\u5b9e\u73b0\u66f4\u52a0\u7075\u6d3b\u7684\u6570\u636e\u9a8c\u8bc1](../2023-03-02-clojure-validation.md)\u7684\u540e\u7eed\u4f18\u5316\u7684\u6587\u7ae0.<br/>\\n\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u5b9e\u73b0\u5728`IntelliJ IDEA`\u4e2d\u5b9e\u73b0\u81ea\u5b9a\u4e49\u6ce8\u89e3\u4e2d`clojure`\u8868\u8fbe\u5f0f\u7684\u8bed\u6cd5\u9ad8\u4eae\u95ee\u9898.<br/>\\n\u901a\u8fc7\u8bed\u6cd5\u9ad8\u4eae, \u53ef\u4ee5\u66f4\u52a0\u76f4\u89c2\u7684\u770b\u5230\u8868\u8fbe\u5f0f\u7684\u7ed3\u6784, \u4ee5\u53ca\u8868\u8fbe\u5f0f\u4e2d\u7684\u9519\u8bef. \u4ece\u800c\u66f4\u52a0\u4fbf\u6377\u5730\u5b9e\u73b0\u8868\u8fbe\u5f0f\u7684\u7f16\u5199.<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u8981\u6c42\\n\\n`IntelliJ IDEA`\u4e2d\u9700\u8981\u5b89\u88c5\u4ee5\u4e0b\u63d2\u4ef6\\n\\n- `cursive`(\u6b64\u63d2\u4ef6\u662f`clojure`\u8bed\u8a00\u7684\u652f\u6301\u63d2\u4ef6, \u5e76\u4e14\u652f\u6301`clojure`\u8868\u8fbe\u5f0f\u7684\u8bed\u6cd5\u9ad8\u4eae.)\\n- `IntelliLang`(`Make sure that the IntelliLang plugin is enabled before you start working with language injections.`)\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n\u4ee3\u7801\u4e2d\u589e\u52a0`@Language`\u6ce8\u89e3, \u5982\u4e0b\u6240\u793a\\n\\n```kotlin title=\\"ClojureExpressionConstraint.kt\\"\\nannotation class ClojureExpressionConstraint(\\n\\tval message: String,\\n\\tval groups: Array<KClass<*>> = [],\\n\\tval payload: Array<KClass<out Payload>> = [],\\n\\t@Language(\\"clojure\\") // to enable syntax highlighting\\n\\tval value: String,\\n)\\n```\\n\\n## \u6548\u679c\u5c55\u793a\\n\\n\u5b9e\u73b0\u540e\u7684\u6548\u679c\u5982\u4e0b\u56fe\u6240\u793a\\n\\n![idea-clojure-syntax-highlighting](./intellij-idea-language-injection.jpeg)\\n\\n\u53ef\u4ee5\u770b\u5230, \u5f53\u9f20\u6807\u60ac\u6d6e\u5230\u8868\u8fbe\u5f0f\u5f15\u7528\u7684\u5730\u65b9\u65f6, \u4f1a\u6709\u76f8\u5e94\u7684\u63d0\u793a\u4fe1\u606f.<br/>\\n\\n## \u53c2\u8003\\n\\n- [Language injections](https://www.jetbrains.com/help/idea/using-language-injections.html)"},{"id":"/2023/03/13/2023-03-13/","metadata":{"permalink":"/markdowns/blog/2023/03/13/2023-03-13/","source":"@site/blog/2023-03-13/2023-03-13.md","title":"\u4f7f\u7528IntelliJ IDEA\u4e2d\u7684java-decompiler\u63d2\u4ef6\u5c06jar\u5305\u53cd\u7f16\u8bd1\u4e3ajava\u6e90\u7801","description":"\u6709\u7684\u65f6\u5019\u9700\u8981\u5c06jar\u5305\u4e2d\u7684class\u6587\u4ef6\u53cd\u7f16\u8bd1\u4e3ajava\u6e90\u7801\u6587\u4ef6\u5e76\u5bf9\u5176\u884c\u4e3a\u8fdb\u884c\u5206\u6790.","date":"2023-03-13T00:00:00.000Z","formattedDate":"March 13, 2023","tags":[{"label":"java","permalink":"/markdowns/blog/tags/java"},{"label":"decompiler","permalink":"/markdowns/blog/tags/decompiler"},{"label":"intellij-idea","permalink":"/markdowns/blog/tags/intellij-idea"}],"readingTime":1.425,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["java","decompiler","intellij-idea"]},"prevItem":{"title":"IntelliJ IDEA\u4e2d\u5b9e\u73b0\u81ea\u5b9a\u4e49\u6ce8\u89e3\u4e2d\u7684\u8bed\u6cd5\u9ad8\u4eae","permalink":"/markdowns/blog/2023/03/14/intellij-idea-language-injection"},"nextItem":{"title":"SSH\u547d\u4ee4\u65e0\u6cd5\u521b\u5efa\u8fdc\u7a0b\u8fde\u63a5","permalink":"/markdowns/blog/2023/03/09/"}},"content":"\u6709\u7684\u65f6\u5019\u9700\u8981\u5c06`jar`\u5305\u4e2d\u7684`class`\u6587\u4ef6\u53cd\u7f16\u8bd1\u4e3a`java`\u6e90\u7801\u6587\u4ef6\u5e76\u5bf9\u5176\u884c\u4e3a\u8fdb\u884c\u5206\u6790.<br/>\\n`IntelliJ IDEA`\u4e2d\u7684`java-decompiler`\u63d2\u4ef6\u53ef\u4ee5\u5c06`jar`\u5305\u4e2d\u7684`class`\u6587\u4ef6\u53cd\u7f16\u8bd1\u4e3a`java`\u6e90\u7801\u6587\u4ef6.<br/>\\n\u4e0b\u9762\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528`IntelliJ IDEA`\u4e2d\u7684`java-decompiler`\u63d2\u4ef6\u5c06`jar`\u5305\u53cd\u7f16\u8bd1\u4e3a`java`\u6e90\u7801.<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u83b7\u53d6`java-decompiler`\u63d2\u4ef6\\n\\n\u4ece`IDEA`\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684`plugins/java-decompiler/lib`\u76ee\u5f55\u4e0b\u83b7\u53d6`java-decompiler.jar`.<br/>\\n\u5982\u679c\u6ca1\u6709\u5b89\u88c5`java-decompiler`\u63d2\u4ef6,\u53ef\u4ee5\u4ece[\u70b9\u51fb\u8fd9\u91cc](java-decompiler.jar)\u4e0b\u8f7d\\n\\n### \u53cd\u7f16\u8bd1`jar`\u5305\\n\\n\u76ee\u524d`java-decompiler`\u53cd\u7f16\u8bd1\u540e\u7684\u7684\u6e90\u7801\u6587\u4ef6\u662f\u6253\u5305\u5728`jar`\u5305\u4e2d\u7684,\u9700\u8981\u5c06\u5176\u89e3\u538b\u51fa\u6765. <br/>\\n\u8fd9\u6837\u6bd4\u8f83\u4e0d\u65b9\u4fbf, \u4e0b\u9762\u6211\u63d0\u4f9b\u4e00\u4e2a\u811a\u672c\u6765\u53cd\u7f16\u8bd1\u4ee5\u53ca\u89e3\u538b`jar`\u5305\u4e2d\u7684\u6e90\u7801\u6587\u4ef6.<br/>\\n\\n```bash title=\\"decompile.sh\\"\\n#!/bin/bash\\n\\nset -ex\\n\\nJAR_FILE_PATH=$(realpath $1)\\nDEST_DIRECTORY=$(realpath $2)\\n\\nrm -rf $DEST_DIRECTORY\\nmkdir $DEST_DIRECTORY\\njava -cp java-decompiler.jar org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -hdc=0 -dgs=1 -rsy=1 -rbr=1 -lit=1 -nls=1 -mpm=60 $JAR_FILE_PATH $DEST_DIRECTORY\\nunzip $DEST_DIRECTORY/$(basename $JAR_FILE_PATH) -d $DEST_DIRECTORY\\n```\\n\\n\u4f7f\u7528\u65b9\u5f0f\u5982\u4e0b\\n\\n```bash\\n./decompile.sh drm-control.jar ./decompiled\\n```\\n\\n\u8fd9\u4e2a\u811a\u672c\u4f1a\u5c06`drm-control.jar`\u53cd\u7f16\u8bd1\u4e3a`java`\u6e90\u7801\u6587\u4ef6\u5e76\u89e3\u538b\u5230`./decompiled`\u76ee\u5f55\u4e0b.<br/>\\n\\n## \u53c2\u8003\\n\\n- [How to decompile to java files intellij idea](https://stackoverflow.com/questions/28389006/how-to-decompile-to-java-files-intellij-idea)\\n- [java-decompiler](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine)\\n- [java-decompiler](java-decompiler.jar)\\n- [decompile.sh](decompile.sh)"},{"id":"/2023/03/09/","metadata":{"permalink":"/markdowns/blog/2023/03/09/","source":"@site/blog/2023-03-09.md","title":"SSH\u547d\u4ee4\u65e0\u6cd5\u521b\u5efa\u8fdc\u7a0b\u8fde\u63a5","description":"\u4eca\u5929\u7ebf\u4e0a\u51fa\u73b0\u4e86\u4e00\u4e2a\u95ee\u9898, \u6b64\u95ee\u9898\u7684\u73b0\u8c61\u662f\u7528\u6237\u5728\u9875\u9762\u4e0a\u70b9\u51fb\u521b\u5efaVNC\u8fdc\u7a0b\u94fe\u63a5\u4f1a\u7b49\u5f85\u5f88\u4e45\u4e14\u54cd\u5e94\u5931\u8d25","date":"2023-03-09T00:00:00.000Z","formattedDate":"March 9, 2023","tags":[{"label":"problem-solving","permalink":"/markdowns/blog/tags/problem-solving"},{"label":"ssh","permalink":"/markdowns/blog/tags/ssh"},{"label":"ldap","permalink":"/markdowns/blog/tags/ldap"}],"readingTime":5.965,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["problem-solving","ssh","ldap"]},"prevItem":{"title":"\u4f7f\u7528IntelliJ IDEA\u4e2d\u7684java-decompiler\u63d2\u4ef6\u5c06jar\u5305\u53cd\u7f16\u8bd1\u4e3ajava\u6e90\u7801","permalink":"/markdowns/blog/2023/03/13/2023-03-13/"},"nextItem":{"title":"\u4f7f\u7528spring\u6784\u5efanative\u9047\u5230\u7684\u95ee\u9898","permalink":"/markdowns/blog/2023/03/06/"}},"content":"\u4eca\u5929\u7ebf\u4e0a\u51fa\u73b0\u4e86\u4e00\u4e2a\u95ee\u9898, \u6b64\u95ee\u9898\u7684\u73b0\u8c61\u662f\u7528\u6237\u5728\u9875\u9762\u4e0a\u70b9\u51fb\u521b\u5efa`VNC`\u8fdc\u7a0b\u94fe\u63a5\u4f1a\u7b49\u5f85\u5f88\u4e45\u4e14\u54cd\u5e94\u5931\u8d25<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u539f\u56e0\\n\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f\u56e0\u4e3a`ssh`\u547d\u4ee4\u6267\u884c\u8d85\u65f6, `ssh`\u547d\u4ee4\u8d85\u65f6\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u6bcf\u6b21`ssh`\u6267\u884c\u547d\u4ee4\u65f6\u9700\u8981\u8fdb\u884c\u7528\u6237\u8ba4\u8bc1,\\n\u7cfb\u7edf\u4e2d\u63a5\u5165\u4e86\u5916\u7f6e\u8ba4\u8bc1\u7cfb\u7edf`ldap`\u8fdb\u884c\u8ba4\u8bc1, \u4f46\u7531\u4e8e\u8bbf\u95ee\u5916\u90e8\u8ba4\u8bc1\u670d\u52a1\u5f88\u6162\u5bfc\u81f4\u89e6\u53d1\u4e86\u8d85\u65f6.<br/>\\n\u8ba4\u8bc1\u670d\u52a1\u5bf9\u5e94`lb`\u4f1a\u8f6c\u53d1\u5230\u51fa\u95ee\u9898\u7684`ldap`\u670d\u52a1\u5668, \u4ece\u800c\u5bfc\u81f4\u8ba4\u8bc1\u670d\u52a1\u8bbf\u95ee\u5f88\u6162.<br/>\\n\\n## \u6392\u67e5\u8fc7\u7a0b\\n\\n### 1. \u67e5\u770b\u540e\u7aef\u670d\u52a1\u65e5\u5fd7\\n\\n\u540e\u7aef\u65e5\u5fd7\u5982\u4e0b<br/>\\n\\n```bash\\n2023-03-09 10:34:37\\t2023-03-09T02:34:36.844168954Z stdout F 2023-03-09 02:34:36.844  INFO 1 --- [nio-2000-exec-6] c.f.c.s.c.LocalAuthenticationProvider    : into local DB authenticate, user is::foo\\n2023-03-09 10:34:40\\t2023-03-09T02:34:40.258742954Z stdout F 2023-03-09 02:34:40.258  INFO 1 --- [io-2000-exec-11] com.jcabi.ssh.Execution$Default          : $ getent passwd foo | awk -F: \'{print $6}\'\\n2023-03-09 10:34:44\\t2023-03-09T02:34:44.382676144Z stdout F 2023-03-09 02:34:44.382  INFO 1 --- [io-2000-exec-11] com.jcabi.ssh.Execution$Default          : $ sudo -i -u foo mkdir -p /fastone/users/foo/.foo\\n2023-03-09 10:34:49\\t2023-03-09T02:34:49.36267293Z stdout F 2023-03-09 02:34:49.362  INFO 1 --- [io-2000-exec-11] com.jcabi.ssh.Execution$Default          : $ echo -e \\"foo\\\\foo\\\\nn\\\\n\\" | sudo -i -u foo sh -c \\"VNC_HOME=/fastone/users/foo/.foo vncserver -nolisten unix -listen tcp -maxclients 512 2>&1\\"\\n2023-03-09 10:35:04\\t2023-03-09T02:35:04.409356857Z stdout F 2023-03-09 02:35:04.409  WARN 1 --- [io-2000-exec-11] com.jcabi.ssh.Ssh                        : an exception during authentication\\n2023-03-09 10:35:04\\t2023-03-09T02:35:04.409378051Z stdout F java.net.SocketTimeoutException: Read timed out\\n2023-03-09 10:35:04\\t2023-03-09T02:35:04.410988161Z stdout F 2023-03-09 02:35:04.410 ERROR 1 --- [io-2000-exec-11] c.f.common.ssh.client.SshClient          : \u547d\u4ee4\u6267\u884c\u5931\u8d25!\\n2023-03-09 10:35:04\\t2023-03-09T02:35:04.411003386Z stdout F\\n2023-03-09 10:35:04\\t2023-03-09T02:35:04.411007586Z stdout F java.io.IOException: com.jcraft.jsch.JSchException: Auth fail\\n2023-03-09 10:35:04\\t2023-03-09T02:35:04.411011213Z stdout F \\tat com.jcabi.ssh.Ssh.session(Ssh.java:281) ~[jcabi-ssh-1.6.1.jar:na]\\n2023-03-09 10:35:04\\t2023-03-09T02:35:04.411014796Z stdout F \\tat com.jcabi.ssh.AbstractSshShell.exec(AbstractSshShell.java:95) ~[jcabi-ssh-1.6.1.jar:na]\\n2023-03-09 10:35:04\\t2023-03-09T02:35:04.41101828Z stdout F \\tat com.jcabi.ssh.Ssh.exec(Ssh.java:77) ~[jcabi-ssh-1.6.1.jar:na]\\n```\\n\\n\u5728\u4ee3\u7801\u4e2d, \u6211\u4eec\u4f7f\u7528\u4e86`jcabi-ssh`\u6765\u6267\u884c`ssh`\u547d\u4ee4.<br/>\\n\u6574\u4e2a\u521b\u5efa`VNC`\u8fdc\u7a0b\u8fde\u63a5\u7684\u4e8b\u52a1\u9700\u8981\u6267\u884c\u56db\u6761`ssh`\u547d\u4ee4, \u524d\u4e09\u6761\u547d\u4ee4\u90fd\u6267\u884c\u6210\u529f\u4e86, \u4f46\u662f\u6700\u540e\u4e00\u6761\u547d\u4ee4\u6267\u884c\u5931\u8d25\u4e86<br/>\\n\u62a5\u9519\u4fe1\u606f\u5982\u4e0b<br/>\\n\\n```log\\njava.net.SocketTimeoutException: Read timed out\\njava.io.IOException: com.jcraft.jsch.JSchException: Auth fail\\n```\\n\\n### 2. \u767b\u5f55\u670d\u52a1\u5668\u5e76\u67e5\u770b`sshd`\u65e5\u5fd7\\n\\n\u9996\u5148\u9700\u8981\u770b\u4e0b`sshd`\u7684\u65e5\u5fd7, \u901a\u8fc7`journalctl`\u547d\u4ee4\u67e5\u770b<br/>\\n\\n```bash\\nsudo journalctl -t sshd\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b<br/>\\n\\n```log\\nMar 09 02:34:38 desktop-1 sshd[11758]: Accepted publickey for fastone from 10.0.109.90 port 49590 ssh2: RSA SHA256:\\nsqOIF4lpjrA0+1At5dDQRZgcwWEK+oO1Lwv9fad\\nMar 09 02:34:38 desktop-1 sshd[11758]: pam_unix(sshd:session): session opened for user fastone by (uid=0)\\nMar 09 02:34:41 desktop-1 sshd[11758]: pam_unix(sshd:session): session closed for user fastone\\nMar 09 02:34:42 desktop-1 sshd[11766]: Accepted publickey for fastone from 10.0.109.90 port 57700 ssh2: RSA SHA256:\\nsqOIF4lpjrA0+1At5dDQRZgcwWEK+oO1Lwv9fad\\nMar 09 02:34:42 desktop-1 sshd[11766]: pam_unix(sshd:session): session opened for user fastone by (uid=0)\\nMar 09 02:34:46 desktop-1 sshd[11766]: pam_unix(sshd:session): session closed for user fastone\\nMar 09 02:34:47 desktop-1 sshd[11778]: Accepted publickey for fastone from 10.0.109.90 port 57710 ssh2: RSA SHA256:\\nsqOIF4lpjrA0+1At5dDQRZgcwWEK+oO1Lwv9fad\\nMar 09 02:34:47 desktop-1 sshd[11778]: pam_unix(sshd:session): session opened for user fastone by (uid=0)\\nMar 09 02:34:54 desktop-1 sshd[11778]: pam_unix(sshd:session): session closed for user fastone\\nMar 09 02:35:04 desktop-1 sshd[11875]: error: Received disconnect from 10.0.109.90 port 41620:3:\\ncom.jcraft.jsch.JSchException: Auth fail [preauth]\\nMar 09 02:35:04 desktop-1 sshd[11875]: Disconnected from authenticating user fastone 10.0.109.90 port 41620 [preauth]\\n```\\n\\nssh\u65e5\u5fd7\u4e2d\u524d\u4e09\u6b21\u662f\u6b63\u5e38\u7684, \u4f46\u662f\u7b2c\u56db\u6b21\u5c31\u62a5\u9519\u4e86, \u4ece\u62a5\u9519\u4fe1\u606f\u6765\u770b, \u662f`Auth fail`\u7684\u95ee\u9898.<br/>\\n\u4ece\u65e5\u5fd7\u4e0a\u770b\u53d1\u73b0\u6bcf\u6b21\u6267\u884c\u547d\u4ee4\u7684\u65f6\u95f4\u90fd\u5f88\u957f, \u6709\u65f6\u5019\u4f1a\u8d85\u8fc7`10s`, \u6240\u4ee5\u6211\u731c\u6d4b\u662f`ssh`\u8fde\u63a5\u8d85\u65f6\u4e86.<br/>\\n\\n### 3. \u67e5\u770b`nslcd`\u65e5\u5fd7\\n\\n\u6839\u636e\u4e0a\u8ff0\u7684\u65e5\u5fd7\u5f97\u51fa\u662f`auth fail`\u7684\u95ee\u9898, \u90a3\u4e48\u5927\u6982\u7387\u8ddf\u7528\u6237\u8ba4\u8bc1\u6709\u5173<br/>\\n\u76ee\u524d\u7cfb\u7edf\u4e2d\u4f7f\u7528\u7684\u8ba4\u8bc1\u670d\u52a1\u662f`ldap`, \u5e76\u901a\u8fc7`nslcd`\u670d\u52a1\u6765\u8fde\u63a5`ldap`\u5e76\u63d0\u4f9b\u8ba4\u8bc1\u670d\u52a1\u7684.<br/>\\n\u6839\u636e\u7ecf\u9a8c\u5224\u65ad\u53ef\u80fd\u662f\u7cfb\u7edf\u4e2d\u7684`nslcd`\u670d\u52a1\u95ee\u9898. \u63a5\u4e0b\u6765\u9700\u8981\u67e5\u770b\u5176\u65e5\u5fd7<br/>\\n\\n```bash\\nsudo service nslcd status\\n```\\n\\n\u8f93\u51fa\u5982\u4e0b<br/>\\n\\n```log\\n\u25cf nslcd.service - LSB: LDAP connection daemon\\nLoaded: loaded (/etc/init.d/nslcd; generated)\\nActive: active (running) since Thu 2023-03-09 02:00:08 UTC; 58min ago\\nDocs: man:systemd-sysv-generator(8)\\nProcess: 1360 ExecStart=/etc/init.d/nslcd start (code=exited, status=0/SUCCESS)\\nTasks: 6 (limit: 4915)\\nCGroup: /system.slice/nslcd.service\\n\u2514\u25001497 /usr/sbin/nslcd\\n\\n\\n\\n\\nMar 09 02:53:36 desktop-1 nslcd[1497]: [de9570] <group/member=\\"root\\"> ldap_result() failed: Can\'t contact LDAP server\\nMar 09 02:53:51 desktop-1 nslcd[1497]: [39d9ef] <group/member=\\"root\\"> ldap_result() failed: Can\'t contact LDAP server\\nMar 09 02:53:51 desktop-1 nslcd[1497]: [2e5952] <passwd=9159> ldap_result() failed: Can\'t contact LDAP server\\nMar 09 02:54:01 desktop-1 nslcd[1497]: [0d1fd6] <passwd=9159> ldap_result() failed: Can\'t contact LDAP server\\nMar 09 02:54:57 desktop-1 nslcd[1497]: [bec5a1] <passwd=9159> ldap_result() failed: Can\'t contact LDAP server\\nMar 09 02:54:57 desktop-1 nslcd[1497]: [44bbc8] <passwd=9159> ldap_result() failed: Can\'t contact LDAP server\\nMar 09 02:55:34 desktop-1 nslcd[1497]: [f50bda] <passwd=9159> ldap_result() failed: Can\'t contact LDAP server\\nMar 09 02:56:25 desktop-1 nslcd[1497]: [c5f72e] <group/member=\\"fastone\\"> ldap_result() timed out\\nMar 09 02:56:25 desktop-1 nslcd[1497]: [f644f7] <group/member=\\"u18846424945\\"> ldap_result() timed out\\nMar 09 02:56:25 desktop-1 nslcd[1497]: [4db6bf] <group/member=\\"u18846424945\\"> ldap_result() timed out\\n```\\n\\n\u4ece\u65e5\u5fd7\u4e2d\u53ef\u4ee5\u770b\u5230, `nslcd`\u670d\u52a1\u8bbf\u95ee`ldap`\u8d85\u65f6\u4e86\\n\\n### 4. \u542f\u7528`nscd`\u670d\u52a1\u4ece\u800c`workaround`\u6b64\u95ee\u9898\\n\\n\u542f\u7528`nscd`\u670d\u52a1, \u4ece\u800c`workaround`\u6b64\u95ee\u9898, `nscd`\u670d\u52a1\u4f1a\u7f13\u5b58`nslcd`\u670d\u52a1\u7684\u7ed3\u679c, \u4ece\u800c\u63d0\u5347\u901f\u5ea6.<br/>\\n\u4f46\u662f\u8fd9\u4e2a\u65b9\u6848\u53ea\u662f`workaround`\u800c\u5df2, \u540e\u7eed\u9700\u8981\u8fd0\u7ef4\u540c\u5b66\u6765\u89e3\u51b3`ldap`\u7684\u8fde\u63a5\u95ee\u9898<br/>\\n\\n```bash\\nsudo service nscd start\\n```\\n\\n\u542f\u7528`nscd`\u670d\u52a1\u540e, \u786e\u8ba4\u4e0b\u901f\u5ea6\u662f\u5426\u6709\u63d0\u5347\\n\\n```bash\\ntime sudo getent passwd -s ldap\\n```\\n\\n```log\\nreal0m1.326s\\nuser0m0.023s\\nsys0m0.023s\\n```\\n\\n## \u5907\u6ce8\\n\\n### \u5982\u4f55\u907f\u514d\u7c7b\u4f3c\u95ee\u9898\\n\\n#### \u670d\u52a1\u4fa7\\n\\n\u5bf9\u4e8e\u8ba4\u8bc1\u670d\u52a1\u4fa7\u9700\u8981\u786e\u4fdd\u670d\u52a1\u7684\u7a33\u5b9a\u6027\\n\\n#### \u5ba2\u6237\u7aef\u4fa7\\n\\n\u5bf9\u4e8e\u8ba4\u8bc1\u7cfb\u7edf\u7684\u5ba2\u6237\u7aef\u4fa7, \u9700\u8981\u786e\u4fdd\u5ba2\u6237\u7aef\u7684\u7a33\u5b9a, \u4f8b\u5982\u589e\u52a0\u7f13\u5b58\u673a\u5236, \u4ece\u800c\u63d0\u5347\u901f\u5ea6\\n\\n## \u53c2\u8003\\n\\n- [Multiple SSH connections to the same system - is it possible?](https://superuser.com/questions/1032251/multiple-ssh-connections-to-the-same-system-is-it-possible)\\n- [How to check sshd log?](https://serverfault.com/questions/130482/how-to-check-sshd-log)"},{"id":"/2023/03/06/","metadata":{"permalink":"/markdowns/blog/2023/03/06/","source":"@site/blog/2023-03-06.md","title":"\u4f7f\u7528spring\u6784\u5efanative\u9047\u5230\u7684\u95ee\u9898","description":"\u672c\u6587\u4e3b\u8981\u6574\u7406\u4e86\u5728\u6784\u5efaspring-boot\u5e94\u7528\u4e3anative\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898.","date":"2023-03-06T00:00:00.000Z","formattedDate":"March 6, 2023","tags":[{"label":"problem-solving","permalink":"/markdowns/blog/tags/problem-solving"},{"label":"spring-boot","permalink":"/markdowns/blog/tags/spring-boot"},{"label":"spring","permalink":"/markdowns/blog/tags/spring"}],"readingTime":7.535,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["problem-solving","spring-boot","spring"]},"prevItem":{"title":"SSH\u547d\u4ee4\u65e0\u6cd5\u521b\u5efa\u8fdc\u7a0b\u8fde\u63a5","permalink":"/markdowns/blog/2023/03/09/"},"nextItem":{"title":"\u5347\u7ea7springboot3\u9047\u5230\u7684\u95ee\u9898","permalink":"/markdowns/blog/2023/03/05/"}},"content":"\u672c\u6587\u4e3b\u8981\u6574\u7406\u4e86\u5728\u6784\u5efa`spring-boot`\u5e94\u7528\u4e3a`native`\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u79fb\u9664`spring-native`\u4f9d\u8d56, \u56e0\u4e3a\u5df2\u88ab`spring-core`\u63d0\u4f9b\u7684`aot`\u529f\u80fd\u53d6\u4ee3\\n\\n`spring-native`\u5df2\u88ab`spring-core`\u63d0\u4f9b\u7684`aot`\u529f\u80fd\u53d6\u4ee3, \u6240\u4ee5\u4e0d\u9700\u8981\u5f15\u5165\u8001\u7684`spring-native`\u4f9d\u8d56.<br/>\\n\u5728github[spring-native](https://github.com/spring-attic/spring-native)\u7684\u4e3b\u9875\u4e0a\u6709\u5982\u4e0b\u8bf4\u660e\\n> This project is now superseded by Spring Boot 3+ official native support, see the related reference documentation for\\n> more details.\\n\\n\u65b0\u7684`aot`\\n\u529f\u80fd\u7684\u6587\u6863\u53ef\u4ee5\u53c2\u9605[GraalVM Native Image Support](https://docs.spring.io/spring-boot/docs/current/reference/html/native-image.html)<br/>\\n\\n\u5176\u5185\u90e8\u5de5\u4f5c\u539f\u7406\u4e3b\u8981\u901a\u8fc7`ReflectiveProcessor`\u548c`RuntimeHintsRegistrar`\u7528\u6765\u5e2e\u52a9\u751f\u6210\u53cd\u5c04\u63d0\u793a, \u5e76\u5728`graalvm`\\n\u7f16\u8bd1\u671f\u95f4\u4f7f\u7528.<br/>\\n\\n## `@RegisterReflectionForBinding`\u65e0\u6cd5\u96c6\u6210`querysdl`\u751f\u6210\u7684`Q`\u7c7b\\n\\n\u7531\u4e8e`querydsl`\u751f\u6210\u7684Q\u7c7b\u4e0d\u80fd\u653e\u5728`@RegisterReflectionForBinding`\u4e0a(\u56e0\u4e3a\u7f16\u8bd1\u4f18\u5148\u7ea7\u539f\u56e0),\\n\u5219\u9700\u8981\u91cd\u65b0\u5b9e\u73b0`@RegisterReflectionForBinding`\u7684\u5177\u4f53\u5b9e\u73b0\u903b\u8f91.<br/>\\n\u4e3b\u8981\u662f\u7ee7\u627f`ReflectiveProcessor`\u5e76\u914d\u5408`BindingReflectionHintsRegistrar`.<br/>\\n\u53c2\u8003\u4ee3\u7801:<br/>\\n\\n```kotlin\\nclass ReflectiveProcessorImpl : ReflectiveProcessor {\\n\\n\\toverride fun registerReflectionHints(hints: ReflectionHints, element: AnnotatedElement) {\\n\\t\\tval function = BindingReflectionHintsRegistrar()::registerReflectionHints.partially1(hints)\\n\\t\\tfunction(\\n\\t\\t\\tarrayOf(\\n\\t\\t\\t\\tPage::class.java,\\n\\t\\t\\t\\tResponseResult::class.java,\\n\\t\\t\\t\\tSignInRequest::class.java,\\n\\t\\t\\t\\tSignInResponse::class.java\\n\\t\\t\\t)\\n\\t\\t)\\n\\t}\\n\\n}\\n```\\n\\n## \u5347\u7ea7`graalvm`\u7248\u672c\\n\\n\u5982\u679c\u4f7f\u7528\u7684`graalvm`\u7248\u672c\u8fc7\u4e8e\u8001, \u5219\u4f1a\u51fa\u73b0\u5982\u4e0b\u7c7b\u4f3c\u7684\u9519\u8bef\\n\\n```\\nGraalVM version 22.3 is required but 22.0 has been detected, please upgrade.\\n```\\n\\n\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u9700\u8981\u5c06`graalvm`\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\\n\\n## `paketo`\u4f9d\u8d56\u4e0b\u8f7d\u5931\u8d25\\n\\n\u901a\u8fc7`./gradlew bootBuildImage`\u6784\u5efa\u955c\u50cf\u65f6, \u8f93\u51fa\u4ee5\u4e0b\u9519\u8bef\\n\\n```log\\nunable to copy from https://github.com/bell-sw/Liberica/releases/download/17.0.5+8/bellsoft-jre17.0.5+8-linux-amd64.tar.gz to /tmp/ee56d911dd187d4965fe2d5280e17b76253eb40eb4e5c8582a17cd46ea0168b1/bellsoft-jre17.0.5+8-linux-amd64.tar.gz\\n[creator]     stream error: stream ID 1; PROTOCOL_ERROR; received from peer\\n```\\n\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f\u56e0\u4e3a`paketo`\u7684\u8fdb\u884c\u6784\u5efa\u8fc7\u7a0b\u4e2d\u4f1a\u4e0b\u8f7d\u4e00\u4e9b\u4f9d\u8d56, \u4f46\u662f\u8fd9\u4e9b\u4f9d\u8d56\u5728\u56fd\u5916, \u4e0b\u8f7d\u901f\u5ea6\u4f1a\u53d8\u6162, \u751a\u81f3\u4f1a\u4e0b\u8f7d\u5931\u8d25.<br/>\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u4f7f\u7528`binding-tool`\u5de5\u5177\u751f\u6210`dependency-mapping`\u5230`bindings`\u5e76\u6620\u5c04\u5230`builder`\u5bb9\u5668\u4e2d\\n\\n### \u53c2\u8003\\n\\n- [Override paketo-buildpacks download URIs](https://github.com/paketo-buildpacks/bellsoft-liberica/issues/7).<br/>\\n- [binding-tool](https://github.com/dmikusa/binding-tool)\\n\\n### \u5907\u6ce8\\n\\n#### `gradle`\u4e2d`native`\u76f8\u5173\u547d\u4ee4\\n\\n```bash\\n./gradlew nativeCompile\\n./gradlew bootBuildImage\\n./build/native/nativeCompile/fastone-auditing\\n```\\n\\n#### `gradle`\u4e2d\u7684`BootBuildImage`\u914d\u7f6e\u53c2\u8003\\n\\n```kotlin title=\\"build.kts\\"\\ntasks.withType<BootBuildImage> {\\n\\t// https://docs.spring.io/spring-boot/docs/3.0.0/gradle-plugin/reference/htmlsingle/#build-image.examples.caches\\n\\tbuildCache {\\n\\t\\tvolume {\\n\\t\\t\\tname.set(\\"cache-${rootProject.name}.build\\")\\n\\t\\t}\\n\\t}\\n\\tlaunchCache {\\n\\t\\tvolume {\\n\\t\\t\\tname.set(\\"cache-${rootProject.name}.launch\\")\\n\\t\\t}\\n\\t}\\n\\tpublish.set(true)\\n\\tdocker {\\n\\t\\tpublishRegistry {\\n\\t\\t\\tusername.set(System.getenv(\\"HARBOR_USERNAME\\"))\\n\\t\\t\\tpassword.set(System.getenv(\\"HARBOR_PASSWORD\\"))\\n\\t\\t}\\n\\t}\\n\\n\\tval labels = System.getenv(\\"LABELS\\")?.replace(\\",\\", \\" \\")\\n\\n\\t// https://github.com/paketo-buildpacks/image-labels\\n\\tmapOf(\\"SERVICE_BINDING_ROOT\\" to \\"/bindings\\").plus(\\n\\t\\twhen (labels) {\\n\\t\\t\\tnull -> emptyMap()\\n\\t\\t\\telse -> mapOf(\\"BP_IMAGE_LABELS\\" to labels)\\n\\t\\t}\\n\\t).let { environment.set(it) }\\n\\tbindings.set(listOf(\\"${project.projectDir}/bindings:/bindings\\"))\\n\\tval formatter = DateTimeFormatter.ofPattern(\\"yyyyMMdd-HHmmss\\")\\n\\timageName.set(\\"hub.fastonetech.com/infra/${project.name}:${formatter.format(ZonedDateTime.now(ZoneId.of(\\"UTC\\")))}\\")\\n}\\n```\\n\\n- [native-image.developing-your-first-application](https://docs.spring.io/spring-boot/docs/current/reference/html/native-image.html#native-image.developing-your-first-application.native-build-tools.gradle)\\n- [build-image.examples](https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/htmlsingle/#build-image.examples)\\n\\n#### `binding-tool`\u4f7f\u7528\u65b9\u5f0f\u53c2\u8003\\n\\n```bash\\n./bt dm -t buildpack.toml\\n./bt dm -b paketo-buildpacks/bellsoft-liberica\\n./bt dm -b paketo-buildpacks/syft\\n```\\n\\n- [buildpack.toml](https://raw.githubusercontent.com/paketo-buildpacks/bellsoft-liberica/main/buildpack.toml)\\n\\n## \u56fa\u5b9a`builder`\u548c`run`\u955c\u50cf\u7248\u672c\u4ee5\u907f\u514d\u7ecf\u5e38\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684`builder`\u548c`run`\u955c\u50cf\\n\\n\u5728\u4f7f\u7528`packeto-builder`\u6784\u5efa\u955c\u50cf\u65f6, \u4f1a\u7ecf\u5e38\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684`paketo`\u4f9d\u8d56, \u8fd9\u6837\u4f1a\u5bfc\u81f4\u81ea\u5b9a\u4e49`dependency-mapping`\u5931\u6548,\\n\u4ece\u800c\u5bfc\u81f4\u6784\u5efa\u5931\u8d25.<br/>\\n\\n### \u539f\u56e0\\n\\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u5c1d\u8bd5\u4e0b\u8f7d\u6700\u65b0\u7684`builder`\u548c`run`\u955c\u50cf, \u4f46\u662f\u8fd9\u4e9b\u955c\u50cf\u4e2d\u5305\u542b\u4e86`paketo`\u7684\u4f9d\u8d56, \u4ece\u800c\u5bfc\u81f4\u4e0b\u8f7d\u6700\u65b0\u7684\u4f9d\u8d56.<br/>\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u4e3a\u4e86\u907f\u514d\u8fd9\u4e2a\u95ee\u9898, \u6211\u4eec\u9700\u8981\u56fa\u5b9a`builder`\u548c`run`\u955c\u50cf\u7684\u7248\u672c, \u4ece\u800c\u907f\u514d\u4e0b\u8f7d\u6700\u65b0\u7684\u4f9d\u8d56.<br/>\\n\\n\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\\n\\n```kotlin title=\\"build.kts\\"\\ntasks.withType<BootBuildImage> {\\n\\t// TO FIX THE VERSION OF BUILDER AND RUN IMAGE to avoid updating it\'s buildpack version which name is bellsoft\\n\\tbuilder.set(\\"paketobuildpacks/builder@sha256:317066766dcb7f47535fe5d97b860be6aabab57da5ef056a11f9db855a73f9e8\\")\\n\\trunImage.set(\\"paketobuildpacks/run@sha256:e9bae15ccc7e230da6ae6c6cd6eef519b10b5ec2187729f60e70c08415a330a0\\")\\n}\\n```\\n\\n### \u53c2\u8003\\n- [Custom Image Builder and Run Image](https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/htmlsingle/#build-image.examples.custom-image-builder)\\n\\n\u4e0a\u9762\u7684\u4ee3\u7801\u662f\u56fa\u5b9a\u4e86`builder`\u548c`run`\u955c\u50cf\u7684\u7248\u672c, \u4ece\u800c\u907f\u514d\u4e0b\u8f7d\u6700\u65b0\u7684\u4f9d\u8d56.<br/>\\n\\n## kotlinx-coroutines\u9700\u8981\u914d\u7f6e\u53cd\u5c04\u63d0\u793a\\n\\n\u5c06\u542b\u6709`kotlinx-coroutines`\u7684`kotlin`\u4ee3\u7801\u7f16\u8bd1\u4e3a`native`\u65f6, \u8fd0\u884c\u540e\u51fa\u73b0\u4ee5\u4e0b\u9519\u8bef\\n\\n```log\\njava.lang.NoSuchMethodException: kotlin.internal.jdk8.JDK8PlatformImplementations.<init>()\\n```\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u5728`classpath`\u4e0b\u7684`META-INF/native-image/reflect-config.json`\u6587\u4ef6\u4e2d\u589e\u52a0\u5982\u4e0b\u5185\u5bb9\u7528\u4e8e\u914d\u7f6e\u53cd\u5c04\u63d0\u793a\\n\\n```json\\n[\\n\\t{\\n\\t\\t\\"name\\": \\"kotlin.reflect.jvm.internal.ReflectionFactoryImpl\\",\\n\\t\\t\\"allDeclaredConstructors\\": true\\n\\t},\\n\\t{\\n\\t\\t\\"name\\": \\"kotlin.KotlinVersion\\",\\n\\t\\t\\"allPublicMethods\\": true,\\n\\t\\t\\"allDeclaredFields\\": true,\\n\\t\\t\\"allDeclaredMethods\\": true,\\n\\t\\t\\"allDeclaredConstructors\\": true\\n\\t},\\n\\t{\\n\\t\\t\\"name\\": \\"kotlin.KotlinVersion[]\\"\\n\\t},\\n\\t{\\n\\t\\t\\"name\\": \\"kotlin.KotlinVersion$Companion\\"\\n\\t},\\n\\t{\\n\\t\\t\\"name\\": \\"kotlin.KotlinVersion$Companion[]\\"\\n\\t},\\n\\t{\\n\\t\\t\\"name\\": \\"kotlin.internal.jdk8.JDK8PlatformImplementations\\",\\n\\t\\t\\"allPublicMethods\\": true,\\n\\t\\t\\"allDeclaredFields\\": true,\\n\\t\\t\\"allDeclaredMethods\\": true,\\n\\t\\t\\"allDeclaredConstructors\\": true\\n\\t}\\n]\\n```\\n\\n### \u53c2\u8003\\n\\n- [How to provide RuntimeHints for Internal Classes in SpringBoot3](https://stackoverflow.com/questions/74612654/how-to-provide-runtimehints-for-internal-classes-in-springboot3)\\n- [Kotlin: Native reflection config missing kotlin.internal.jdk8.JDK8PlatformImplementations #1646](https://github.com/spring-projects-experimental/spring-native/issues/1646)\\n- [PlatformImplementations loading is not compatible with graalvm native-image --no-fallback](https://youtrack.jetbrains.com/issue/KT-51579)\\n\\n## `ktor`\u5e93\u9700\u8981\u914d\u7f6e\u53cd\u5c04\u63d0\u793a\\n\\n\u5c06\u542b\u6709`ktor`\u7684`kotlin`\u4ee3\u7801\u7f16\u8bd1\u4e3a`native`\u540e\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4ee5\u4e0b\u9519\u8bef\\n\\n```log\\nCaused by: java.lang.RuntimeException: java.lang.NoSuchFieldException: top\\n\\tat java.util.concurrent.atomic.AtomicLongFieldUpdater$CASUpdater.<init>(AtomicLongFieldUpdater.java:205)\\n\\tat java.util.concurrent.atomic.AtomicLongFieldUpdater.newUpdater(AtomicLongFieldUpdater.java:95)\\n\\tat io.ktor.utils.io.pool.DefaultPool.<clinit>(DefaultPool.kt:97)\\n\\tat com.oracle.svm.core.hub.ClassInitializationInfo.invokeClassInitializer(ClassInitializationInfo.java:350)\\n\\tat com.oracle.svm.core.hub.ClassInitializationInfo.initialize(ClassInitializationInfo.java:270)\\n\\t... 39 more\\nCaused by: java.lang.NoSuchFieldException: top\\n\\tat java.lang.Class.getDeclaredField(DynamicHub.java:2411)\\n\\tat java.util.concurrent.atomic.AtomicLongFieldUpdater$CASUpdater.<init>(AtomicLongFieldUpdater.java:202)\\n\\t... 43 more\\n```\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\nclasspath\u4e0b\u7684`META-INF/native-image/reflect-config.json`\u6587\u4ef6\u589e\u52a0\u5982\u4e0b\u5185\u5bb9\u7528\u4e8e\u914d\u7f6e\u53cd\u5c04\u63d0\u793a\\n\\n```json\\n[\\n\\t{\\n\\t\\t\\"name\\": \\"io.ktor.utils.io.pool.DefaultPool\\",\\n\\t\\t\\"fields\\": [\\n\\t\\t\\t{\\n\\t\\t\\t\\t\\"name\\": \\"top\\",\\n\\t\\t\\t\\t\\"allowUnsafeAccess\\": true\\n\\t\\t\\t}\\n\\t\\t]\\n\\t}\\n]\\n```\\n\\n### \u53c2\u8003\\n\\n- [GraalVM native-image support broken due to Payload #77](https://github.com/rsocket/rsocket-kotlin/issues/77)\\n\\n## \u4e3a\u9700\u8981\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\u914d\u7f6e\u53cd\u5c04\u63d0\u793a\\n\\n\u4e3a\u4e86\u80fd\u591f\u8ba9\u53c2\u4e0e\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\u80fd\u591f\u5728`native`\u73af\u5883\u4e0b\u6b63\u5e38\u8fd0\u884c, \u9700\u8981\u914d\u7f6e\u53cd\u5c04\u63d0\u793a.\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u4f7f\u7528`springframework`\u4e2d\u7684\u7c7b\u63d0\u4f9b\u53cd\u5c04\u63d0\u793a, \u53c2\u8003\u4ee3\u7801\u5982\u4e0b\\n\\n```kotlin\\nclass ReflectiveProcessorImpl : ReflectiveProcessor {\\n\\n\\toverride fun registerReflectionHints(hints: ReflectionHints, element: AnnotatedElement) {\\n\\t\\tval function = BindingReflectionHintsRegistrar()::registerReflectionHints.partially1(hints)\\n\\t\\tfunction(\\n\\t\\t\\tarrayOf(\\n\\t\\t\\t\\tPage::class.java,\\n\\t\\t\\t\\tResponseResult::class.java,\\n\\t\\t\\t\\tSignInRequest::class.java,\\n\\t\\t\\t\\tSignInResponse::class.java\\n\\t\\t\\t)\\n\\t\\t)\\n\\t}\\n\\n}\\n\\nclass RuntimeHintsImpl : RuntimeHintsRegistrar {\\n\\n\\toverride fun registerHints(hints: RuntimeHints, classLoader: ClassLoader?) {\\n\\t\\t// Caused by: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Cannot construct instance of `java.util.HashSet` (no Creators, like default constructor, exist): no default no-arguments constructor found\\n\\t\\t// at [Source: (InputStreamReader); line: 1, column: 20] (through reference chain: com.fastonetech.lib.web.ResponseResult[\\"data\\"]->com.fastonetech.billing.sync.infra.client.Page[\\"content\\"])\\n\\t\\thints.reflection().registerConstructor(\\n\\t\\t\\tReflectionUtils.accessibleConstructor(java.util.HashSet::class.java),\\n\\t\\t\\tExecutableMode.INVOKE\\n\\t\\t)\\n\\t}\\n\\n}\\n\\n@Reflective(ReflectiveProcessorImpl::class)\\n@ImportRuntimeHints(RuntimeHintsImpl::class)\\nclass BillingSyncApplication\\n```\\n\\n### \u53c2\u8003\\n\\n- [Annotation Interface Reflective](https://docs.spring.io/spring-framework/docs/current/javadoc-api//org/springframework/aot/hint/annotation/Reflective.html)\\n- [Annotation Interface ImportRuntimeHints](https://docs.spring.io/spring-framework/docs/current/javadoc-api//org/springframework/context/annotation/ImportRuntimeHints.html)\\n\\n## \u6784\u5efa\u51fa\u7684\u955c\u50cf\u4e0d\u662f`native`\\n\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f\u914d\u7f6e\u4e86`bootBuildImage`\u8fd9\u4e2a`task`\u4e2d\u8986\u76d6\u4e86\u73af\u5883\u53d8\u91cf, \u5bfc\u81f4`BP_NATIVE_IMAGE`\u4e3a\u7a7a\\n\\n### \u539f\u59cb\u914d\u7f6e\\n\\n```kotlin\\nmapOf(\\"SERVICE_BINDING_ROOT\\" to \\"/bindings\\").plus(\\n\\twhen (labels) {\\n\\t\\tnull -> emptyMap()\\n\\t\\telse -> mapOf(\\"BP_IMAGE_LABELS\\" to labels)\\n\\t}\\n).let {\\n\\tenvironment.set(it) // ensure BP_NATIVE_IMAGE exists, and it\'s value is true\\n}\\n```\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u7531\u4e8eenvironment.set\u4f1a\u8986\u76d6\u539f\u6709\u7684\u73af\u5883\u53d8\u91cf, \u6240\u4ee5\u9700\u8981\u663e\u5f0f\u58f0\u660e`BP_NATIVE_IMAGE`\\n\\n```kotlin\\nmapOf(\\"SERVICE_BINDING_ROOT\\" to \\"/bindings\\", \\"BP_NATIVE_IMAGE\\" to \\"true\\").plus(\\n\\twhen (labels) {\\n\\t\\tnull -> emptyMap()\\n\\t\\telse -> mapOf(\\"BP_IMAGE_LABELS\\" to labels)\\n\\t}\\n).let {\\n\\tenvironment.set(it) // ensure BP_NATIVE_IMAGE exists, and it\'s value is true\\n}\\n```\\n\\n### \u53c2\u8003\\n\\n- [5.3. Image Customizations\u4e0b\u7684environment\u9ed8\u8ba4\u503c\u4ecb\u7ecd](https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/htmlsingle/)\\n\\n## `aot`\u5e94\u7528\u8fd0\u884c\u65f6\u8c03\u7528\u7531`@ConfigurationProperty`\u6ce8\u89e3\u6ce8\u91ca\u7684\u5bf9\u8c61\u7684\u5c5e\u6027\u65f6\u62a5\u9519\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u5bf9\u4e8e`ConfigurationProperties`\u4e2d\u5d4c\u5957\u7684\u5bf9\u8c61\u52a0\u5165`@NestedConfigurationProperty`\u6ce8\u89e3\u8fdb\u884c\u6807\u8bc6\\n\\n### \u53c2\u8003\\n\\n- [Nested Configuration Properties](https://docs.spring.io/spring-boot/docs/current/reference/html/native-image.html#native-image.advanced.nested-configuration-properties)\\n\\n> Reflection hints are automatically created for configuration properties by the Spring ahead-of-time engine.\\n> Nested configuration properties which are not inner classes, however, must be annotated with\\n> @NestedConfigurationProperty, otherwise they won\u2019t be detected and will not be bindable.\\n\\n## `aot`\u5e94\u7528\u8fd0\u884c\u65f6\u83b7\u53d6`classpath`\u4e0b\u7684\u8d44\u6e90\u65f6\u62a5\u9519\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u5728`RuntimeHintsRegistrar`\u7684`registerHints`\u65b9\u6cd5\u4e2d\u6ce8\u518c\u9759\u6001\u8d44\u6e90\\n\\n```kotlin\\nhints.resources().registerResource(ClassPathResource(\\"ca.crt\\"))\\nhints.resources().registerResource(ClassPathResource(\\"client.crt\\"))\\nhints.resources().registerResource(ClassPathResource(\\"client.key\\"))\\n```\\n\\n## `aot`\u5e94\u7528\u8fd0\u884c\u65f6`@Conditional`\u6ce8\u89e3\u4e0d\u751f\u6548\\n\\nspring-boot-native not supported @ConditionalOnProperty yet\\n\\n### \u53c2\u8003\\n\\n- [Possibility of @ConditionalOnProperty support on spring-native](https://github.com/spring-projects-experimental/spring-native/issues/1613)\\n\\n### \u53c2\u8003\\n\\n- [server.error.include-message](https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#application-properties.server.server.error.include-message)\\n- [Error Handling for REST with Spring](https://www.baeldung.com/exception-handling-for-rest-with-spring)"},{"id":"/2023/03/05/","metadata":{"permalink":"/markdowns/blog/2023/03/05/","source":"@site/blog/2023-03-05.md","title":"\u5347\u7ea7springboot3\u9047\u5230\u7684\u95ee\u9898","description":"\u672c\u6587\u4e3b\u8981\u6574\u7406\u4e86\u5728\u5347\u7ea7springboot3\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898.","date":"2023-03-05T00:00:00.000Z","formattedDate":"March 5, 2023","tags":[{"label":"problem-solving","permalink":"/markdowns/blog/tags/problem-solving"},{"label":"spring-boot","permalink":"/markdowns/blog/tags/spring-boot"},{"label":"spring","permalink":"/markdowns/blog/tags/spring"}],"readingTime":10.995,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["problem-solving","spring-boot","spring"]},"prevItem":{"title":"\u4f7f\u7528spring\u6784\u5efanative\u9047\u5230\u7684\u95ee\u9898","permalink":"/markdowns/blog/2023/03/06/"},"nextItem":{"title":"\u6574\u7406\u7684\u4e00\u4e9bjava\u4e2d\u7684\u7b2c\u4e09\u65b9\u5e93","permalink":"/markdowns/blog/2023/03/04/"}},"content":"\u672c\u6587\u4e3b\u8981\u6574\u7406\u4e86\u5728\u5347\u7ea7`springboot3`\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u5347\u7ea7`spring-boot3`\u540e\u4ee3\u7801\u4e2d\u7684`javax`\u5305\u9700\u8981\u5207\u6362\u4e3a`jakarta`\\n\\n\u9879\u76ee\u4e2d\u4f7f\u7528\u5230\u4e86`apache-guacamole-common`\u4f9d\u8d56, \u8be5\u4f9d\u8d56\u4e2d\u4f7f\u7528\u4e86`javax`\u5305\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u7531\u4e8e\u8be5\u4f9d\u8d56\u76ee\u524d\u6700\u65b0\u7684\u7248\u672c\u8fd8\u6ca1\u6709\u5347\u7ea7\u5230`jakarta`, \u6240\u4ee5\u9700\u8981\u76f8\u5173\u4f9d\u8d56\u4ee3\u7801\u590d\u5236\u5230\u9879\u76ee\u4e2d, \u5e76\u5c06`javax`\u5305\u5207\u6362\u4e3a`jakarta`.<br/>\\n\\n```java title=\\"GuacamoleWebSocketTunnelEndpoint.java\\"\\npackage com.fastonetech.remote.access.websocket;\\n/*\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\"License\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\"AS IS\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n\\nimport java.io.IOException;\\nimport java.util.List;\\nimport jakarta.websocket.CloseReason;\\nimport jakarta.websocket.CloseReason.CloseCode;\\nimport jakarta.websocket.Endpoint;\\nimport jakarta.websocket.EndpointConfig;\\nimport jakarta.websocket.MessageHandler;\\nimport jakarta.websocket.OnClose;\\nimport jakarta.websocket.OnMessage;\\nimport jakarta.websocket.OnOpen;\\nimport jakarta.websocket.RemoteEndpoint;\\nimport jakarta.websocket.Session;\\nimport org.apache.guacamole.GuacamoleException;\\nimport org.apache.guacamole.io.GuacamoleReader;\\nimport org.apache.guacamole.io.GuacamoleWriter;\\nimport org.apache.guacamole.net.GuacamoleTunnel;\\nimport org.apache.guacamole.GuacamoleClientException;\\nimport org.apache.guacamole.GuacamoleConnectionClosedException;\\nimport org.apache.guacamole.protocol.FilteredGuacamoleWriter;\\nimport org.apache.guacamole.protocol.GuacamoleFilter;\\nimport org.apache.guacamole.protocol.GuacamoleInstruction;\\nimport org.apache.guacamole.protocol.GuacamoleStatus;\\nimport org.slf4j.Logger;\\nimport org.slf4j.LoggerFactory;\\n\\n/**\\n * A WebSocket implementation of GuacamoleTunnel functionality, compatible with\\n * the Guacamole.WebSocketTunnel object included with the JavaScript API.\\n * Messages sent/received are simply chunks of the Guacamole protocol\\n * instruction stream.\\n */\\npublic abstract class GuacamoleWebSocketTunnelEndpoint extends Endpoint {\\n\\n\\t/**\\n\\t * The default, minimum buffer size for instructions.\\n\\t */\\n\\tprivate static final int BUFFER_SIZE = 8192;\\n\\n\\t/**\\n\\t * The opcode of the instruction used to indicate a connection stability\\n\\t * test ping request or response. Note that this instruction is\\n\\t * encapsulated within an internal tunnel instruction (with the opcode\\n\\t * being the empty string), thus this will actually be the value of the\\n\\t * first element of the received instruction.\\n\\t */\\n\\tprivate static final String PING_OPCODE = \\"ping\\";\\n\\n\\t/**\\n\\t * Logger for this class.\\n\\t */\\n\\tprivate final Logger logger = LoggerFactory.getLogger(GuacamoleWebSocketTunnelEndpoint.class);\\n\\n\\t/**\\n\\t * The underlying GuacamoleTunnel. WebSocket reads/writes will be handled\\n\\t * as reads/writes to this tunnel. This value may be null if no connection\\n\\t * has been established.\\n\\t */\\n\\tprivate GuacamoleTunnel tunnel;\\n\\n\\t/**\\n\\t * Remote (client) side of this connection. This value will always be\\n\\t * non-null if tunnel is non-null.\\n\\t */\\n\\tprivate RemoteEndpoint.Basic remote;\\n\\n\\t/**\\n\\t * Sends the numeric Guacaomle Status Code and Web Socket\\n\\t * code and closes the connection.\\n\\t *\\n\\t * @param session\\n\\t *     The outbound WebSocket connection to close.\\n\\t *\\n\\t * @param guacamoleStatusCode\\n\\t *     The numeric Guacamole status to send.\\n\\t *\\n\\t * @param webSocketCode\\n\\t *     The numeric WebSocket status to send.\\n\\t */\\n\\tprivate void closeConnection(Session session, int guacamoleStatusCode,\\n\\t\\t\\t\\t\\t\\t\\t\\t int webSocketCode) {\\n\\n\\t\\ttry {\\n\\t\\t\\tCloseCode code = CloseReason.CloseCodes.getCloseCode(webSocketCode);\\n\\t\\t\\tString message = Integer.toString(guacamoleStatusCode);\\n\\t\\t\\tsession.close(new CloseReason(code, message));\\n\\t\\t} catch (IOException e) {\\n\\t\\t\\tlogger.debug(\\"Unable to close WebSocket connection.\\", e);\\n\\t\\t}\\n\\n\\t}\\n\\n\\t/**\\n\\t * Sends the given Guacaomle Status and closes the given\\n\\t * connection.\\n\\t *\\n\\t * @param session\\n\\t *     The outbound WebSocket connection to close.\\n\\t *\\n\\t * @param guacStatus\\n\\t *     The status to use for the connection.\\n\\t */\\n\\tprivate void closeConnection(Session session, GuacamoleStatus guacStatus) {\\n\\t\\tcloseConnection(session, guacStatus.getGuacamoleStatusCode(),\\n\\t\\t\\tguacStatus.getWebSocketCode());\\n\\t}\\n\\n\\t/**\\n\\t * Sends a Guacamole instruction along the outbound WebSocket connection to\\n\\t * the connected Guacamole client. If an instruction is already in the\\n\\t * process of being sent by another thread, this function will block until\\n\\t * in-progress instructions are complete.\\n\\t *\\n\\t * @param instruction\\n\\t *     The instruction to send.\\n\\t *\\n\\t * @throws IOException\\n\\t *     If an I/O error occurs preventing the given instruction from being\\n\\t *     sent.\\n\\t */\\n\\tprivate void sendInstruction(String instruction)\\n\\t\\tthrows IOException {\\n\\n\\t\\t// NOTE: Synchronization on the non-final remote field here is\\n\\t\\t// intentional. The remote (the outbound websocket connection) is only\\n\\t\\t// sensitive to simultaneous attempts to send messages with respect to\\n\\t\\t// itself. If the remote changes, then the outbound websocket\\n\\t\\t// connection has changed, and synchronization need only be performed\\n\\t\\t// in context of the new remote.\\n\\t\\tsynchronized (remote) {\\n\\t\\t\\tremote.sendText(instruction);\\n\\t\\t}\\n\\n\\t}\\n\\n\\t/**\\n\\t * Sends a Guacamole instruction along the outbound WebSocket connection to\\n\\t * the connected Guacamole client. If an instruction is already in the\\n\\t * process of being sent by another thread, this function will block until\\n\\t * in-progress instructions are complete.\\n\\t *\\n\\t * @param instruction\\n\\t *     The instruction to send.\\n\\t *\\n\\t * @throws IOException\\n\\t *     If an I/O error occurs preventing the given instruction from being\\n\\t *     sent.\\n\\t */\\n\\tprivate void sendInstruction(GuacamoleInstruction instruction)\\n\\t\\tthrows IOException {\\n\\t\\tsendInstruction(instruction.toString());\\n\\t}\\n\\n\\t/**\\n\\t * Returns a new tunnel for the given session. How this tunnel is created\\n\\t * or retrieved is implementation-dependent.\\n\\t *\\n\\t * @param session The session associated with the active WebSocket\\n\\t *                connection.\\n\\t * @param config Configuration information associated with the instance of\\n\\t *               the endpoint created for handling this single connection.\\n\\t * @return A connected tunnel, or null if no such tunnel exists.\\n\\t * @throws GuacamoleException If an error occurs while retrieving the\\n\\t *                            tunnel, or if access to the tunnel is denied.\\n\\t */\\n\\tprotected abstract GuacamoleTunnel createTunnel(Session session, EndpointConfig config)\\n\\t\\tthrows GuacamoleException;\\n\\n\\t@Override\\n\\t@OnOpen\\n\\tpublic void onOpen(final Session session, EndpointConfig config) {\\n\\n\\t\\t// Store underlying remote for future use via sendInstruction()\\n\\t\\tremote = session.getBasicRemote();\\n\\n\\t\\ttry {\\n\\n\\t\\t\\t// Get tunnel\\n\\t\\t\\ttunnel = createTunnel(session, config);\\n\\t\\t\\tif (tunnel == null) {\\n\\t\\t\\t\\tcloseConnection(session, GuacamoleStatus.RESOURCE_NOT_FOUND);\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t} catch (GuacamoleException e) {\\n\\t\\t\\tlogger.error(\\"Creation of WebSocket tunnel to guacd failed: {}\\", e.getMessage());\\n\\t\\t\\tlogger.debug(\\"Error connecting WebSocket tunnel.\\", e);\\n\\t\\t\\tcloseConnection(session, e.getStatus().getGuacamoleStatusCode(),\\n\\t\\t\\t\\te.getWebSocketCode());\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\t// Manually register message handler\\n\\t\\tsession.addMessageHandler(new MessageHandler.Whole<String>() {\\n\\n\\t\\t\\t@Override\\n\\t\\t\\tpublic void onMessage(String message) {\\n\\t\\t\\t\\tGuacamoleWebSocketTunnelEndpoint.this.onMessage(message);\\n\\t\\t\\t}\\n\\n\\t\\t});\\n\\n\\t\\t// Prepare read transfer thread\\n\\t\\tThread readThread = new Thread() {\\n\\n\\t\\t\\t@Override\\n\\t\\t\\tpublic void run() {\\n\\n\\t\\t\\t\\tStringBuilder buffer = new StringBuilder(BUFFER_SIZE);\\n\\t\\t\\t\\tGuacamoleReader reader = tunnel.acquireReader();\\n\\t\\t\\t\\tchar[] readMessage;\\n\\n\\t\\t\\t\\ttry {\\n\\n\\t\\t\\t\\t\\t// Send tunnel UUID\\n\\t\\t\\t\\t\\tsendInstruction(new GuacamoleInstruction(\\n\\t\\t\\t\\t\\t\\tGuacamoleTunnel.INTERNAL_DATA_OPCODE,\\n\\t\\t\\t\\t\\t\\ttunnel.getUUID().toString()\\n\\t\\t\\t\\t\\t));\\n\\n\\t\\t\\t\\t\\ttry {\\n\\n\\t\\t\\t\\t\\t\\t// Attempt to read\\n\\t\\t\\t\\t\\t\\twhile ((readMessage = reader.read()) != null) {\\n\\n\\t\\t\\t\\t\\t\\t\\t// Buffer message\\n\\t\\t\\t\\t\\t\\t\\tbuffer.append(readMessage);\\n\\n\\t\\t\\t\\t\\t\\t\\t// Flush if we expect to wait or buffer is getting full\\n\\t\\t\\t\\t\\t\\t\\tif (!reader.available() || buffer.length() >= BUFFER_SIZE) {\\n\\t\\t\\t\\t\\t\\t\\t\\tsendInstruction(buffer.toString());\\n\\t\\t\\t\\t\\t\\t\\t\\tbuffer.setLength(0);\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t\\t// No more data\\n\\t\\t\\t\\t\\t\\tcloseConnection(session, GuacamoleStatus.SUCCESS);\\n\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t// Catch any thrown guacamole exception and attempt\\n\\t\\t\\t\\t\\t// to pass within the WebSocket connection, logging\\n\\t\\t\\t\\t\\t// each error appropriately.\\n\\t\\t\\t\\t\\tcatch (GuacamoleClientException e) {\\n\\t\\t\\t\\t\\t\\tlogger.info(\\"WebSocket connection terminated: {}\\", e.getMessage());\\n\\t\\t\\t\\t\\t\\tlogger.debug(\\"WebSocket connection terminated due to client error.\\", e);\\n\\t\\t\\t\\t\\t\\tcloseConnection(session, e.getStatus().getGuacamoleStatusCode(),\\n\\t\\t\\t\\t\\t\\t\\te.getWebSocketCode());\\n\\t\\t\\t\\t\\t} catch (GuacamoleConnectionClosedException e) {\\n\\t\\t\\t\\t\\t\\tlogger.debug(\\"Connection to guacd closed.\\", e);\\n\\t\\t\\t\\t\\t\\tcloseConnection(session, GuacamoleStatus.SUCCESS);\\n\\t\\t\\t\\t\\t} catch (GuacamoleException e) {\\n\\t\\t\\t\\t\\t\\tlogger.error(\\"Connection to guacd terminated abnormally: {}\\", e.getMessage());\\n\\t\\t\\t\\t\\t\\tlogger.debug(\\"Internal error during connection to guacd.\\", e);\\n\\t\\t\\t\\t\\t\\tcloseConnection(session, e.getStatus().getGuacamoleStatusCode(),\\n\\t\\t\\t\\t\\t\\t\\te.getWebSocketCode());\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t} catch (IOException e) {\\n\\t\\t\\t\\t\\tlogger.debug(\\"I/O error prevents further reads.\\", e);\\n\\t\\t\\t\\t\\tcloseConnection(session, GuacamoleStatus.SERVER_ERROR);\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t}\\n\\n\\t\\t};\\n\\n\\t\\treadThread.start();\\n\\n\\t}\\n\\n\\t@OnMessage\\n\\tpublic void onMessage(String message) {\\n\\n\\t\\t// Ignore inbound messages if there is no associated tunnel\\n\\t\\tif (tunnel == null)\\n\\t\\t\\treturn;\\n\\n\\t\\t// Filter received instructions, handling tunnel-internal instructions\\n\\t\\t// without passing through to guacd\\n\\t\\tGuacamoleWriter writer = new FilteredGuacamoleWriter(tunnel.acquireWriter(), new GuacamoleFilter() {\\n\\n\\t\\t\\t@Override\\n\\t\\t\\tpublic GuacamoleInstruction filter(GuacamoleInstruction instruction)\\n\\t\\t\\t\\tthrows GuacamoleException {\\n\\n\\t\\t\\t\\t// Filter out all tunnel-internal instructions\\n\\t\\t\\t\\tif (instruction.getOpcode().equals(GuacamoleTunnel.INTERNAL_DATA_OPCODE)) {\\n\\n\\t\\t\\t\\t\\t// Respond to ping requests\\n\\t\\t\\t\\t\\tList<String> args = instruction.getArgs();\\n\\t\\t\\t\\t\\tif (args.size() >= 2 && args.get(0).equals(PING_OPCODE)) {\\n\\n\\t\\t\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\t\\t\\tsendInstruction(new GuacamoleInstruction(\\n\\t\\t\\t\\t\\t\\t\\t\\tGuacamoleTunnel.INTERNAL_DATA_OPCODE,\\n\\t\\t\\t\\t\\t\\t\\t\\tPING_OPCODE, args.get(1)\\n\\t\\t\\t\\t\\t\\t\\t));\\n\\t\\t\\t\\t\\t\\t} catch (IOException e) {\\n\\t\\t\\t\\t\\t\\t\\tlogger.debug(\\"Unable to send \\\\\\"ping\\\\\\" response for WebSocket tunnel.\\", e);\\n\\t\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\treturn null;\\n\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t// Pass through all non-internal instructions untouched\\n\\t\\t\\t\\treturn instruction;\\n\\n\\t\\t\\t}\\n\\n\\t\\t});\\n\\n\\t\\ttry {\\n\\t\\t\\t// Write received message\\n\\t\\t\\twriter.write(message.toCharArray());\\n\\t\\t} catch (GuacamoleConnectionClosedException e) {\\n\\t\\t\\tlogger.debug(\\"Connection to guacd closed.\\", e);\\n\\t\\t} catch (GuacamoleException e) {\\n\\t\\t\\tlogger.debug(\\"WebSocket tunnel write failed.\\", e);\\n\\t\\t}\\n\\n\\t\\ttunnel.releaseWriter();\\n\\n\\t}\\n\\n\\t@Override\\n\\t@OnClose\\n\\tpublic void onClose(Session session, CloseReason closeReason) {\\n\\n\\t\\ttry {\\n\\t\\t\\tif (tunnel != null)\\n\\t\\t\\t\\ttunnel.close();\\n\\t\\t} catch (GuacamoleException e) {\\n\\t\\t\\tlogger.debug(\\"Unable to close WebSocket tunnel.\\", e);\\n\\t\\t}\\n\\n\\t}\\n\\n}\\n\\n```\\n\\n### \u53c2\u8003\\n\\n- [Apache Tomcat 10.0 Servlet API incompatibility](https://issues.apache.org/jira/browse/GUACAMOLE-1325)\\n\\n## querydsl\u4f9d\u8d56\u53d8\u66f4\\n\\n\u7531\u4e8e`springboot3`\u4e2d\u7684`javax`\u4f9d\u8d56\u53d8\u4e3a\u4e86`jakarta`, \u6240\u4ee5`querydsl`\u7684\u4f9d\u8d56\u4e5f\u9700\u8981\u53d8\u66f4\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u5c06`querydsl`\u76f8\u5173\u4f9d\u8d56\u7684`classfiier`\u8bbe\u7f6e\u4e3a`jakarta`.\\n\\n```kotlin title=\\"build.kts\\"\\nimplementation(\\"com.querydsl:querydsl-jpa:5.0.0:jakarta\\")\\nkapt(\\"com.querydsl:querydsl-apt:5.0.0:jakarta\\")\\n```\\n\\n### \u53c2\u8003\\n\\n- [Are there plans to support SpringBoot3.0(Java17)?](https://github.com/querydsl/querydsl/issues/3296)\\n\\n`springboot3`\u7684`javax`\u4f9d\u8d56\u53d8\u4e3a\u4e86`jakarta`, \u4ee3\u7801\u4e2d\u9700\u8981\u5c06\u5305\u5bfc\u5165\u4ece`javax`\u5207\u6362\u5230`jakarta`.\\n\\n## \u5347\u7ea7`spring-boot3`\u540e\u8bbf\u95ee\u7531`@PreAuthorize`\u6ce8\u89e3\u4fdd\u62a4\u7684\u63a5\u53e3\u62a5\u9519\\n\\n\u5347\u7ea7`spring-boot3`\u540e\u8bbf\u95ee\u7531`@PreAuthorize`\u6ce8\u89e3\u4fdd\u62a4\u7684\u63a5\u53e3\u62a5\u9519, \u62a5\u9519\u4e3a401\\n\\n### \u539f\u56e0\\n\\n`RoleHierarchy`\u5931\u6548, \u5bfc\u81f4`MGMT_SUPER_ADMIN`\u65e0\u6cd5\u8bbf\u95ee`@PreAuthorize(\\"hasRole(\\"MGMT_ADMIN\\")\\")`\u6ce8\u89e3\u4fdd\u62a4\u7684\u63a5\u53e3\u3002<br/>\\n\u56e0\u4e3a`MGMT_SUPER_ADMIN`\u7ee7\u627f\u81ea`MGMT_ADMIN`\u3002<br/>\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531`@EnableGlobalMethodSecurity`\u5230`@EnableMethodSecurity`\u7684\u8fc1\u79fb\u5bfc\u81f4\u3002<br/>\\n\u8fd9\u4e24\u8005\u5185\u90e8\u5bf9\u4e8e`defaultMethodExpressionHandler`\u7684\u521d\u59cb\u5316\u884c\u4e3a\u4e0d\u4e00\u81f4\u5bfc\u81f4`RoleHierarchy`\u5931\u6548\u3002<br/>\\n\u533a\u522b\u5982\u4e0b\\n\\n- `@EnableGlobalMethodSecurity`\\n  <br/>\u5b9e\u73b0\u7c7b`GlobalMethodSecurityConfiguration`\u521b\u5efa`defaultMethodExpressionHandler`\u65f6\u4f1a\u5c1d\u8bd5\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6`RoleHierarchy`\u3002\\n- `@EnableMethodSecurity`\\n  <br/>\u5b9e\u73b0\u7c7b`PrePostMethodSecurityConfiguration`\u521b\u5efa`defaultMethodExpressionHandler`\u65f6\u4e0d\u4f1a\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6`RoleHierarchy`\u3002\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n- \u4e3a`spring-security`\u521b\u5efa`pull request`\u786e\u4fdd\u521d\u59cb\u5316`defaultMethodExpressionHandler`\u884c\u4e3a\u4fdd\u6301\u4e00\u81f4\\n- \u5bf9\u4e8e\u81ea\u8eab\u9879\u76ee\u5f53\u524d\u7684\u89e3\u51b3\u529e\u6cd5\u662f\u521d\u59cb\u5316`MethodExpressionHandler`\\n\\n### \u5907\u6ce8\\n\\n```java title=\\"GlobalMethodSecurityConfiguration.java\\"\\npublic class GlobalMethodSecurityConfiguration implements ImportAware, SmartInitializingSingleton, BeanFactoryAware {\\n\\n\\t@Override\\n\\tpublic void afterSingletonsInstantiated() {\\n\\t\\ttry {\\n\\t\\t\\tinitializeMethodSecurityInterceptor();\\n\\t\\t} catch (Exception ex) {\\n\\t\\t\\tthrow new RuntimeException(ex);\\n\\t\\t}\\n\\t\\tPermissionEvaluator permissionEvaluator = getSingleBeanOrNull(PermissionEvaluator.class);\\n\\t\\tif (permissionEvaluator != null) {\\n\\t\\t\\tthis.defaultMethodExpressionHandler.setPermissionEvaluator(permissionEvaluator);\\n\\t\\t}\\n\\t\\tRoleHierarchy roleHierarchy = getSingleBeanOrNull(RoleHierarchy.class);\\n\\t\\tif (roleHierarchy != null) {\\n\\t\\t\\tthis.defaultMethodExpressionHandler.setRoleHierarchy(roleHierarchy);\\n\\t\\t}\\n\\t\\tAuthenticationTrustResolver trustResolver = getSingleBeanOrNull(AuthenticationTrustResolver.class);\\n\\t\\tif (trustResolver != null) {\\n\\t\\t\\tthis.defaultMethodExpressionHandler.setTrustResolver(trustResolver);\\n\\t\\t}\\n\\t\\tGrantedAuthorityDefaults grantedAuthorityDefaults = getSingleBeanOrNull(GrantedAuthorityDefaults.class);\\n\\t\\tif (grantedAuthorityDefaults != null) {\\n\\t\\t\\tthis.defaultMethodExpressionHandler.setDefaultRolePrefix(grantedAuthorityDefaults.getRolePrefix());\\n\\t\\t}\\n\\n\\t\\tthis.defaultMethodExpressionHandler = this.objectPostProcessor.postProcess(this.defaultMethodExpressionHandler);\\n\\t}\\n\\n}\\n```\\n\\n```java title=\\"PrePostMethodSecurityConfiguration.java\\"\\nfinal class PrePostMethodSecurityConfiguration {\\n\\n\\tprivate static MethodSecurityExpressionHandler defaultExpressionHandler(\\n\\t\\tObjectProvider<GrantedAuthorityDefaults> defaultsProvider, ApplicationContext context) {\\n\\t\\tDefaultMethodSecurityExpressionHandler handler = new DefaultMethodSecurityExpressionHandler();\\n\\t\\tdefaultsProvider.ifAvailable((d) -> handler.setDefaultRolePrefix(d.getRolePrefix()));\\n\\t\\thandler.setApplicationContext(context);\\n\\t\\treturn handler;\\n\\t}\\n\\n}\\n```\\n\\n### \u53c2\u8003\\n\\n- [issue](https://github.com/spring-projects/spring-security/issues/12662)\\n- [pull request](https://github.com/spring-projects/spring-security/pull/12673)\\n- [GlobalMethodSecurityConfiguration.java ](https://github.com/spring-projects/spring-security/blob/6.0.x/config/src/main/java/org/springframework/security/config/annotation/method/configuration/GlobalMethodSecurityConfiguration.java)\\n- [PrePostMethodSecurityConfiguration.java](https://github.com/spring-projects/spring-security/blob/6.0.x/config/src/main/java/org/springframework/security/config/annotation/method/configuration/PrePostMethodSecurityConfiguration.java)\\n\\n## \u5347\u7ea7`spring-boot3`\u540e\u4f7f\u7528Token\u8bf7\u6c42\u4fdd\u62a4\u8d44\u6e90\u62a5\u9519\\n\\n\u4f7f\u7528Token\u8bf7\u6c42\u4fdd\u62a4\u8d44\u6e90\u62a5\u9519401\\n\\n### \u539f\u56e0\\n\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f`spring-security`\u4e2d\u8fdb\u884c\u4e86\u91cd\u6784\u9700\u8981\u5bf9`securityContext`\u8fdb\u884c\u914d\u7f6e\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n1. `http.securityContext().requireExplicitSave(false).and()`\\n2. `http.securityContext().securityContextRepository(new HttpSessionSecurityContextRepository()).and()`\\n\\n### \u5907\u6ce8\\n\\n> spring6\u4e4b\u540eSecurityContextHolderFilter\u66ff\u6362\u4e86SecurityContextPersistenceFilter<br/>\\n> SecurityContextRepository\u9ed8\u8ba4\u5b9e\u73b0\u4e5f\u53d8\u4e86<br/>\\n> (HttpSessionSecurityContextRepository) -> (RequestAttributeSecurityContextRepository)<br/>\\n\\n### \u53c2\u8003\\n\\n- [Spring Security 6 CustomAuthenticationFilter(intend to replace the UsernamePasswordAuthenticationFilter) does not work](https://stackoverflow.com/questions/74629234/spring-security-6-customauthenticationfilterintend-to-replace-the-usernamepassw)\\n- [Default to SecurityContextHolderFilter instead of SecurityContextPersistenceFilter #11110](https://github.com/spring-projects/spring-security/issues/11110)\\n\\n## \u5347\u7ea7`spring-boot3`\u540e\u8bf7\u6c42`/swagger-ui/index.html`\u62a5\u9519\\n\\n\u63a5\u53e3\u62a5\u9519, \u5185\u5bb9\u5982\u4e0b\\n\\n```log title=\\"chrome\\"\\nThis page isn\u2019t working\\nIf the problem continues, contact the site owner.\\nHTTP ERROR 401\\n```\\n\\n### \u539f\u56e0\\n\\nspringdoc\u7248\u672c\u8fc7\u8001, \u9700\u8981\u5347\u7ea7\u5230v2\u7248\u672c\u3002<br/>\\n[springdoc.org](https://springdoc.org/)\\n\u4e0a\u7684\u6709\u76f8\u5173\u8bf4\u660e`For spring-boot v3 support, make sure you use springdoc-openapi v2`\\n\\n\u672c\u9879\u76ee\u7684\u539f\u59cb\u914d\u7f6e\u5982\u4e0b\\n\\n```xml title=\\"pom.xml\\"\\n\\n<dependency>\\n\\t<groupId>org.springdoc</groupId>\\n\\t<artifactId>springdoc-openapi-ui</artifactId>\\n\\t<version>1.6.14</version>\\n</dependency>\\n```\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u5347\u7ea7springdoc\u7248\u672c\u5230v2, \u5347\u7ea7\u540e\u7684\u914d\u7f6e\u5982\u4e0b, v2\u7684artifactId\u53d1\u751f\u4e86\u53d8\u5316\\n\\n```xml title=\\"pom.xml\\"\\n\\n<dependency>\\n\\t<groupId>org.springdoc</groupId>\\n\\t<artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>\\n\\t<version>2.0.2</version>\\n</dependency>\\n```\\n\\n### \u53c2\u8003\\n\\n- [springdoc.org](https://springdoc.org/)\\n- [springdocv2](https://springdoc.org/v2/)\\n- [How to run Swagger 3 on Spring Boot 3](https://stackoverflow.com/questions/74614369/how-to-run-swagger-3-on-spring-boot-3)\\n\\n### \u4ee3\u7801\u8c03\u7528\u6d41\u7a0b\\n\\n```log title=\\"AuthorizationFilter.doFilter\\"\\nthis.authorizationManager.check(this::getAuthentication, request);\\n```\\n\\n```log title=\\"ObservationAuthorizationManager.check\\"\\nAuthorizationDecision decision = this.delegate.check(wrapped, object);\\n```\\n\\n```log title=\\"RequestMatcherDelegatingAuthorizationManager.check\\"\\nmatcher.matcher(request);\\n```\\n\\n```log title=\\"MvcRequestMatcher.matcher\\"\\n// \u8fd4\u56de\u4e86`path`\u4e3a`/error`\u7684`handlerMapping`(\u8bf4\u660e\u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u7684`handlerMapping`)\\nMatchableHandlerMapping mapping = getMapping(request);\\n```\\n\\n```log title=\\"RequestMatcherDelegatingAuthorizationManager.check\\"\\nRequestMatcher matcher = mapping.getRequestMatcher();\\nMatchResult matchResult = matcher.matcher(request);\\n// \u7531\u4e8eswagger\u5bf9\u5e94\u7684handler\u627e\u4e0d\u5230, \u6240\u4ee5\u6ca1\u6709Match\\nif (matchResult.isMatch()) {\\n\\tAuthorizationManager<RequestAuthorizationContext> manager = mapping.getEntry();\\n\\tif (this.logger.isTraceEnabled()) {\\n\\t\\tthis.logger.trace(LogMessage.format(\\"Checking authorization on %s using %s\\", request, manager));\\n\\t}\\n\\t// \u540e\u7eed\u547d\u4e2d\u4e86Mvc [pattern=\'/*/*.html\']\u5bf9\u5e94\u7684Matcher, \u800c\u8be5Matcher\u5bf9\u5e94\u7684\u5339\u914d\u89c4\u5219\u8981\u6c42\u9700\u8981`authentication`\u4e0d\u4e3a\u7a7a, \u5bfc\u81f4\u62a5\u9519\\n\\treturn manager.check(authentication, new RequestAuthorizationContext(request, matchResult.getVariables()));\\n}\\n```\\n\\n## api\u63a5\u53e3\u62a5\u9519\u540e\u6ca1\u6709\u8fd4\u56de\u5f02\u5e38\u4fe1\u606f\\n\\n### \u89e3\u51b3\u65b9\u6848\\n\\n\u65b0\u7248\u672c\u7684`spring-boot`\u9ed8\u8ba4\u4e0d\u8fd4\u56de\u5f02\u5e38\u4fe1\u606f, \u9700\u8981\u5728`application.yml`\u4e2d\u589e\u52a0\u4ee5\u4e0b\u914d\u7f6e\\n\\n```yaml\\nserver:\\n  error:\\n    include-message: always\\n```"},{"id":"/2023/03/04/","metadata":{"permalink":"/markdowns/blog/2023/03/04/","source":"@site/blog/2023-03-04.md","title":"\u6574\u7406\u7684\u4e00\u4e9bjava\u4e2d\u7684\u7b2c\u4e09\u65b9\u5e93","description":"Testing","date":"2023-03-04T00:00:00.000Z","formattedDate":"March 4, 2023","tags":[{"label":"java","permalink":"/markdowns/blog/tags/java"},{"label":"curated-list","permalink":"/markdowns/blog/tags/curated-list"}],"readingTime":2.91,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["java","curated-list"]},"prevItem":{"title":"\u5347\u7ea7springboot3\u9047\u5230\u7684\u95ee\u9898","permalink":"/markdowns/blog/2023/03/05/"},"nextItem":{"title":"\u811a\u672c\u4e2d\u5b9e\u73b0\u4fee\u6539\u7528\u6237\u5bc6\u7801","permalink":"/markdowns/blog/2023/03/03/"}},"content":"\x3c!--truncate--\x3e\\n\\n## Testing\\n\\n- [approval-tests](https://approvaltests.com/)\\n  <br/>Unit testing asserts can be difficult to use. Approval tests simplify this by taking a snapshot of the results,\\n  and confirming that they have not changed.\\n- [Testcontainers](https://www.testcontainers.org/)\\n  <br/>Testcontainers is a Java library that supports JUnit tests, providing lightweight, throwaway instances of common\\n  databases, Selenium web browsers, or anything else that can run in a Docker container.\\n\\n## Workflow\\n\\n- [conductor](https://conductor.netflix.com/)\\n  <br/>Conductor is a platform created by Netflix to orchestrate workflows that span across microservices.\\n- [flowable](https://www.flowable.com/)\\n  <br/>A compact and highly efficient workflow and Business Process Management (BPM) platform for developers, system\\n  admins and business users.\\n- [camunda](https://github.com/camunda/camunda-bpm-platform)\\n  <br/>Flexible framework for workflow and decision automation with BPMN and DMN. Integration with Spring, Spring Boot,\\n  CDI.\\n- [Activiti](https://github.com/Activiti/Activiti)\\n  <br/>Activiti is a light-weight workflow and Business Process Management (BPM) Platform targeted at business people,\\n  developers and system admins. Its core is a super-fast and rock-solid BPMN 2 process engine for Java. It\'s open-source\\n  and distributed under the Apache license. Activiti runs in any Java application, on a server, on a cluster or in the\u2026\\n- [Airflow](https://airflow.apache.org/)\\n  <br/>Airflow is a platform created by the community to programmatically author, schedule and monitor workflows.\\n\\n## Language Extension\\n\\n- [Project Lombok](https://projectlombok.org/)\\n  <br/>Project Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java.\\n  <br/>Never write another getter or equals method again, with one annotation your class has a fully featured builder,\\n  Automate your logging variables, and much more.\\n- [Manifold](http://manifold.systems/)\\n  <br/>Manifold is a Java compiler plugin, its features include Metaprogramming, Properties, Extension Methods, Operator\\n  Overloading, Templates, a Preprocessor, and more.\\n\\n## Framework\\n\\n- [spring-boot](https://spring.io/projects/spring-boot)\\n  <br/>Spring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can \\"just\\n  run\\".\\n  <br/>We take an opinionated view of the Spring platform and third-party libraries so you can get started with minimum\\n  fuss. Most Spring Boot applications need minimal Spring configuration.\\n  <br/>If you\u2019re looking for information about a specific version, or instructions about how to upgrade from an earlier\\n  release, check out the project release notes section on our wiki.\\n- [helidon](https://helidon.io/)\\n  <br/>Helidon is a cloud-native, open\u2011source set of Java libraries for writing microservices that run on a fast web\\n  core powered by Netty.\\n- [micronaut](https://micronaut.io/)\\n  <br/>A MODERN, JVM-BASED, FULL-STACK FRAMEWORK FOR BUILDING MODULAR, EASILY TESTABLE MICROSERVICE AND SERVERLESS\\n  APPLICATIONS\\n- [vert.x](https://vertx.io/)\\n  <br/>Eclipse Vert.x\u2122 Reactive applications on the JVM.\\n- [quarkus](https://quarkus.io/)\\n  <br/>A Kubernetes Native Java stack tailored for OpenJDK HotSpot and GraalVM, crafted from the best of breed Java\\n  libraries and standards.\\n- [spring-modulith](https://spring.io/projects/spring-modulith)\\n  <br/>Spring Modulith allows developers to build well-structured Spring Boot applications and guides developers in\\n  finding and working with application modules driven by the domain. It supports the verification of such modular\\n  arrangements, integration testing individual modules, observing the application\u2019s behavior on the module level and\\n  creating documentation snippets based on the arrangement created.\\n- [javalin](https://javalin.io/)\\n  <br/>A simple web framework for Java and Kotlin\\n\\n## Console\\n\\n- [jline](https://github.com/jline/jline3)\\n  <br/>JLine is a Java library for handling console input.\\n\\n## Command Execution\\n\\n- [commons-exec](https://github.com/apache/commons-exec)\\n  <br/>Apache Commons Exec.\\n- [zt-exec](https://github.com/zeroturnaround/zt-exec)\\n  <br/>ZeroTurnaround Process Executor.\\n- [mina-sshd](https://github.com/apache/mina-sshd)\\n  <br/>Apache MINA sshd is a comprehensive Java library for client- and server-side SSH.\\n- [sshj](https://github.com/hierynomus/sshj)\\n  <br/>ssh, scp and sftp for java.\\n\\n\\n## AOT\\n\\n- [graalvm](https://www.graalvm.org/)\\n  <br/>GraalVM is a high-performance, polyglot virtual machine for running applications written in JavaScript, Python,\\n  Ruby, R, JVM-based languages like Java, Scala, Kotlin, and LLVM-based languages such as C and C++.\\n\\n## \u53c2\u8003\\n- [awesome-java](https://github.com/akullpp/awesome-java)\\n  <br/>A curated list of awesome frameworks, libraries and software for the Java programming language."},{"id":"/2023/03/03/","metadata":{"permalink":"/markdowns/blog/2023/03/03/","source":"@site/blog/2023-03-03.md","title":"\u811a\u672c\u4e2d\u5b9e\u73b0\u4fee\u6539\u7528\u6237\u5bc6\u7801","description":"\u5e73\u65f6\u5728\u5199\u811a\u672c\u7684\u65f6\u5019, \u6709\u65f6\u5019\u4f1a\u9700\u8981\u4f7f\u7528passwd\u547d\u4ee4\u6765\u4fee\u6539\u7528\u6237\u7684\u5bc6\u7801.","date":"2023-03-03T00:00:00.000Z","formattedDate":"March 3, 2023","tags":[{"label":"linux","permalink":"/markdowns/blog/tags/linux"}],"readingTime":2.885,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["linux"]},"prevItem":{"title":"\u6574\u7406\u7684\u4e00\u4e9bjava\u4e2d\u7684\u7b2c\u4e09\u65b9\u5e93","permalink":"/markdowns/blog/2023/03/04/"},"nextItem":{"title":"\u57fa\u4e8eclojure\u8868\u8fbe\u5f0f\u5b9e\u73b0\u66f4\u52a0\u7075\u6d3b\u7684\u6570\u636e\u9a8c\u8bc1","permalink":"/markdowns/blog/2023/03/02/clojure-validation"}},"content":"\u5e73\u65f6\u5728\u5199\u811a\u672c\u7684\u65f6\u5019, \u6709\u65f6\u5019\u4f1a\u9700\u8981\u4f7f\u7528`passwd`\u547d\u4ee4\u6765\u4fee\u6539\u7528\u6237\u7684\u5bc6\u7801.<br/>\\n\u4f8b\u5982\u4e3a`NIS`\u7684\u6d4b\u8bd5\u670d\u52a1\u5668\u65b0\u589e\u4e00\u4e9b\u6d4b\u8bd5\u7528\u6237, \u5e76\u4e14\u4e3a\u8fd9\u4e9b\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801.<br/>\\n\u7531\u4e8e`passwd`\u9700\u8981\u4ea4\u4e92\u5f0f\u7684\u8f93\u5165, \u6240\u4ee5\u5728\u811a\u672c\u4e2d\u4f7f\u7528`passwd`\u547d\u4ee4\u4f1a\u62a5\u9519.<br/>\\n\u4e00\u4e2a\u6f5c\u5728\u7684\u89e3\u51b3\u65b9\u6848\u662f\u52a0\u5165`--stdin`\u53c2\u6570\u4f46\u662f\u6709\u7684`linux`\u53d1\u884c\u7248\u4e2d`passwd`\u547d\u4ee4\u4e2d\u7684`--stdin`\u4e0d\u5b58\u5728.<br/>\\n\u5982\u679c\u4f60\u8fd8\u8fd9\u6837\u6267\u884c\u7684\u8bdd\u5c06\u4f1a\u663e\u793a\u4ee5\u4e0b\u9519\u8bef.<br/>\\n\\n```log\\npasswd: unrecognized option \'--stdin\'\\nUsage: passwd [options] [LOGIN]\\n\\nOptions:\\n  -a, --all                     report password status on all accounts\\n  -d, --delete                  delete the password for the named account\\n  -e, --expire                  force expire the password for the named account\\n  -h, --help                    display this help message and exit\\n  -k, --keep-tokens             change password only if expired\\n  -i, --inactive INACTIVE       set password inactive after expiration\\n                                to INACTIVE\\n  -l, --lock                    lock the password of the named account\\n  -n, --mindays MIN_DAYS        set minimum number of days before password\\n                                change to MIN_DAYS\\n  -q, --quiet                   quiet mode\\n  -r, --repository REPOSITORY   change password in REPOSITORY repository\\n  -R, --root CHROOT_DIR         directory to chroot into\\n  -S, --status                  report password status on the named account\\n  -u, --unlock                  unlock the password of the named account\\n  -w, --warndays WARN_DAYS      set expiration warning days to WARN_DAYS\\n  -x, --maxdays MAX_DAYS        set maximum number of days before password\\n                                change to MAX_DAYS\\n```\\n\\n\u7531\u4e8e`passwd`\u547d\u4ee4\u4e2d\u6ca1\u6709`--stdin`\u9009\u9879, \u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f7f\u7528\u5176\u4ed6\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898.<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u4f7f\u7528`chpasswd`\\n\\n`chpasswd`\u547d\u4ee4\u53ef\u4ee5\u7528\u4e8e\u6279\u91cf\u4fee\u6539\u7528\u6237\u7684\u5bc6\u7801, \u8be5\u547d\u4ee4\u7684\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b.\\n\\n```bash\\necho \\"user1:password1\\" | chpasswd\\n```\\n\\n## \u5907\u6ce8\\n\\n\u4e0d\u5efa\u8bae\u5728\u811a\u672c\u4e2d\u4fee\u6539\u5bc6\u7801, \u56e0\u4e3a\u8fd9\u6837\u4f1a\u6cc4\u6f0f\u5bc6\u7801.<br/>\\n\u4f8b\u5982\u5f53\u811a\u672c\u589e\u52a0`set -x`\u9009\u9879\u65f6, \u4f1a\u5c06\u5bc6\u7801\u6253\u5370\u51fa\u6765.<br/>\\n\u8fd9\u79cd\u65b9\u5f0f\u6700\u597d\u5728\u6d4b\u8bd5\u73af\u5883\u4e2d\u4f7f\u7528.<br/>\\n\\n> Nothing you can do in bash can possibly work. \\n> passwd(1) does not read from standard input. \\n> This is intentional. It is for your protection. \\n> Passwords were never intended to be put into programs, or generated by programs. \\n> They were intended to be entered only by the fingers of an actual human being, with a functional brain, and never, ever written down anywhere. \\n> Nonetheless, we get hordes of users asking how they can circumvent 35 years of Unix security.\\n\\nfrom\\n- [I want to set a user\'s password using the Unix passwd command, but how do I script that? It doesn\'t read standard input!](http://mywiki.wooledge.org/BashFAQ/078)\\n\\n## \u53c2\u8003\\n\\n- [Using the passwd Command from Within a Shell Script](https://www.baeldung.com/linux/passwd-shell-script#1-using-stdin-option)\\n- [Alternative to passwd --stdin in Ubuntu](https://askubuntu.com/questions/1115795/alternative-to-passwd-stdin-in-ubuntu)\\n- [Using the passwd command from within a shell script](https://stackoverflow.com/questions/714915/using-the-passwd-command-from-within-a-shell-script)\\n- [I want to set a user\'s password using the Unix passwd command, but how do I script that? It doesn\'t read standard input!](http://mywiki.wooledge.org/BashFAQ/078)"},{"id":"/2023/03/02/clojure-validation","metadata":{"permalink":"/markdowns/blog/2023/03/02/clojure-validation","source":"@site/blog/2023-03-02-clojure-validation.md","title":"\u57fa\u4e8eclojure\u8868\u8fbe\u5f0f\u5b9e\u73b0\u66f4\u52a0\u7075\u6d3b\u7684\u6570\u636e\u9a8c\u8bc1","description":"\u6570\u636e\u9a8c\u8bc1\u662f\u4e00\u4e2a\u975e\u5e38\u5e38\u89c1\u7684\u9700\u6c42, \u5bf9\u4e8ejava\u9879\u76ee\u6765\u8bf4, \u76ee\u524djakarta\u7684bean validation\u5df2\u7ecf\u6210\u4e3a\u4e86java\u4e2d\u7684\u6807\u51c6.","date":"2023-03-02T00:00:00.000Z","formattedDate":"March 2, 2023","tags":[{"label":"clojure","permalink":"/markdowns/blog/tags/clojure"},{"label":"kotlin","permalink":"/markdowns/blog/tags/kotlin"},{"label":"java","permalink":"/markdowns/blog/tags/java"},{"label":"spring","permalink":"/markdowns/blog/tags/spring"},{"label":"validation","permalink":"/markdowns/blog/tags/validation"}],"readingTime":15.07,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["clojure","kotlin","java","spring","validation"]},"prevItem":{"title":"\u811a\u672c\u4e2d\u5b9e\u73b0\u4fee\u6539\u7528\u6237\u5bc6\u7801","permalink":"/markdowns/blog/2023/03/03/"},"nextItem":{"title":"ubuntu\u4e2d\u5e38\u7528\u7684apt\u6e90","permalink":"/markdowns/blog/2023/02/26/"}},"content":"\u6570\u636e\u9a8c\u8bc1\u662f\u4e00\u4e2a\u975e\u5e38\u5e38\u89c1\u7684\u9700\u6c42, \u5bf9\u4e8e`java`\u9879\u76ee\u6765\u8bf4, \u76ee\u524d`jakarta`\u7684`bean validation`\u5df2\u7ecf\u6210\u4e3a\u4e86java\u4e2d\u7684\u6807\u51c6. <br/>\\n\u5176\u81ea\u5e26\u4e86\u4e00\u4e9b\u5e38\u89c1\u7684\u6570\u636e\u9a8c\u8bc1\u6ce8\u89e3, \u4f8b\u5982`@NotNull`, `@NotEmpty`, `@Size`\u7b49.<br/>\\n\u8fd9\u4e9b\u6ce8\u89e3\u5982\u679c\u9047\u5230\u590d\u6742\u7684\u6570\u636e\u9a8c\u8bc1\u9700\u6c42\u65f6, \u5c31\u4f1a\u663e\u5f97\u529b\u4e0d\u4ece\u5fc3. \u6240\u4ee5\u9700\u8981\u4e00\u79cd\u66f4\u52a0\u7075\u6d3b\u7684\u6570\u636e\u9a8c\u8bc1\u65b9\u5f0f.<br/>\\n\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u79cd\u9700\u6c42, \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7`clojure`\u8868\u8fbe\u5f0f\u6765\u5b9e\u73b0\u6570\u636e\u9a8c\u8bc1.<br/>\\n\u540c\u65f6\u6211\u4eec\u9700\u8981\u548c\u73b0\u6709\u7684`bean validation`\u4e00\u8d77\u4f7f\u7528, \u4ee5\u4fbf\u4e8e\u6ee1\u8db3\u73b0\u6709\u7684\u4e1a\u52a1\u9700\u6c42.<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## Why clojure\\n\\n### \u57fa\u4e8e\u8868\u8fbe\u5f0f\\n\\n`clojure`\u662f\u4e00\u4e2a\u57fa\u4e8e\u8868\u8fbe\u5f0f\u7684\u8bed\u8a00, \u6240\u4ee5\u5b83\u7684\u6570\u636e\u9a8c\u8bc1\u529f\u80fd\u4e5f\u662f\u57fa\u4e8e\u8868\u8fbe\u5f0f\u7684.<br/>\\n\u8868\u8fbe\u5f0f\u7684\u597d\u5904\u662f, \u5b83\u7684\u8868\u8fbe\u80fd\u529b\u975e\u5e38\u5f3a\u5927, \u901a\u8fc7\u8868\u8fbe\u5f0f, \u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u975e\u5e38\u590d\u6742\u7684\u6570\u636e\u9a8c\u8bc1.<br/>\\n\u540c\u65f6\u8868\u8fbe\u5f0f\u7684\u53ef\u8bfb\u6027\u4e5f\u975e\u5e38\u5f3a, \u901a\u8fc7\u8868\u8fbe\u5f0f, \u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u7406\u89e3\u6570\u636e\u9a8c\u8bc1\u7684\u903b\u8f91.<br/>\\n\\n### \u6570\u636e\u5904\u7406\\n\\n`clojure`\u662f\u4e00\u4e2a\u51fd\u6570\u5f0f\u8bed\u8a00(`functional programming`).<br/>\\n\u51fd\u6570\u5f0f\u8bed\u8a00\u7684\u4e00\u4e2a\u7279\u70b9\u5c31\u662f\u6570\u636e\u5904\u7406\u80fd\u529b\u975e\u5e38\u5f3a\u5927.<br/>\\n\u5b83\u62bd\u8c61\u4e86\u6570\u636e\u7684\u64cd\u4f5c, \u901a\u8fc7\u51fd\u6570\u5f0f\u7684\u65b9\u5f0f\u6765\u5904\u7406\u6570\u636e.<br/>\\n\u5bf9\u4e8e`clojure`\u6765\u8bf4, \u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u975e\u5e38\u65b9\u4fbf\u7684\u6570\u636e\u64cd\u4f5c\u51fd\u6570, \u4f8b\u5982\\n\\n- `map`\\n- `filter`\\n- `reduce`\\n- `zipmap`\\n- `group-by`\\n- `partition`\\n- `sort-by`\\n- `sort-with`\\n- `take`\\n- `take-while`\\n- `drop`\\n- ...\\n\\n### \u57fa\u4e8e`jvm`\\n\\n`clojure`\u662f\u57fa\u4e8e`jvm`\u7684, \u6240\u4ee5\u5b83\u53ef\u4ee5\u548c`java`\u65e0\u7f1d\u96c6\u6210.<br/>\\n\\n## \u5b9e\u73b0\\n\\n\u5b9e\u73b0\u4e3b\u8981\u5206\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\\n\\n- `jakarta`\u6269\u5c55\u5b9e\u73b0\\n- `clojure`\u8868\u8fbe\u5f0f\u5904\u7406\\n- `springboot`\u96c6\u6210\\n\\n### `jakarta`\u6269\u5c55\u5b9e\u73b0\\n\\n#### \u65b0\u589e\u81ea\u5b9a\u4e49\u6ce8\u89e3`@ClojureExpressionConstraint`\\n\\n\u56e0\u4e3a`jakarta`\u7684`bean validation`\u662f\u57fa\u4e8e\u6ce8\u89e3\u7684, \u6700\u7ec8\u7528\u6237\u5728\u4f7f\u7528\u65f6, \u9700\u8981\u901a\u8fc7\u6ce8\u89e3\u7684\u65b9\u5f0f\u6765\u4f7f\u7528\u8be5\u529f\u80fd.<br/>\\n\u6240\u4ee5\u6211\u4eec\u4e5f\u9700\u8981\u8bbe\u8ba1\u4e00\u4e2a\u6ce8\u89e3, \u901a\u8fc7\u8be5\u6ce8\u89e3\u6765\u4f7f\u7528\u6211\u4eec\u7684\u6570\u636e\u9a8c\u8bc1\u529f\u80fd.<br/>\\n\\n\u4ee3\u7801\u5982\u4e0b:\\n\\n```kotlin\\n/**\\n * This is a validation annotation based on clojure expression to validate your data.\\n *\\n * Note:\\n * 1. The expression only has one parameter, which is the value that will be validated.\\n * The parameter is bound to the symbol \\"it\\". You can use \\"it\\" to refer to the value.\\n * 2. The expression must return a boolean value.\\n * Example:\\n * Right expression: (> (count it) 5)\\n * Bad expression: (count it)\\n * 3. The size of the outer form must be 1.\\n * If you want to use multiple expressions, you can use \\"and\\" or \\"or\\" to combine them.\\n * Example:\\n * The expression \\"(and (> (count it) 5) (= it (clojure.string/lower-case it)))\\" is right.\\n * The expression \\"(> (count it) 5) (= it (clojure.string/lower-case it))\\" is wrong.\\n *\\n * Examples:\\n * 1. The type of value is string. We validate the length of the string must be greater than 5.\\n * (> (count it) 5)\\n * 2. The type of value is collection. We validate the size of the collection must be greater than 5.\\n * (> (count it) 5)\\n * 3. The type of value is string. We validate the string must be a lower case string.\\n * (= it (clojure.string/lower-case it))\\n * 4. The type is javaBean, and it has a property named age. We validate the age must be greater than 0 and less than 100.\\n * (let [age (:age it)] (and (> age 0) (< age 100)))\\n *\\n * @author Xiangcheng.Kuo\\n * @see ClojureExpressionConstraintValidator\\n */\\n@Repeatable\\n@Target(AnnotationTarget.PROPERTY, AnnotationTarget.FIELD)\\n@Retention(AnnotationRetention.RUNTIME)\\n@Constraint(validatedBy = [ClojureExpressionConstraintValidator::class])\\nannotation class ClojureExpressionConstraint(\\n\\tval message: String,\\n\\tval groups: Array<KClass<*>> = [],\\n\\tval payload: Array<KClass<out Payload>> = [],\\n\\tval value: String,\\n)\\n```\\n\\n#### \u65b0\u589e`ClojureExpressionConstraintValidator`\u4ee5\u5b9e\u73b0\u6ce8\u89e3\u7684\u9a8c\u8bc1\\n\\n\u5bf9\u4e8e\u81ea\u5b9a\u4e49\u7684\u6ce8\u89e3\u7684\u5904\u7406, \u6211\u4eec\u9700\u8981\u5b9e\u73b0`ConstraintValidator`\u6765\u8fdb\u884c\u9a8c\u8bc1.<br/>\\n\\n\u4ee3\u7801\u5982\u4e0b:\\n\\n```kotlin\\n/**\\n * This is a validator for [ClojureExpressionConstraint] annotation.\\n * It will evaluate the expression with the given value and return the boolean result as the validation result.\\n *\\n * @author Xiangcheng.Kuo\\n * @see ClojureExpressionConstraint\\n */\\nclass ClojureExpressionConstraintValidator(\\n\\tprivate val evaluator: ClojureExpressionEvaluator\\n) : ConstraintValidator<ClojureExpressionConstraint, Any> {\\n\\n\\tprivate lateinit var annotation: ClojureExpressionConstraint\\n\\n\\toverride fun initialize(constraintAnnotation: ClojureExpressionConstraint) {\\n\\t\\tthis.annotation = constraintAnnotation\\n\\t}\\n\\n\\toverride fun isValid(value: Any?, context: ConstraintValidatorContext): Boolean {\\n\\t\\treturn evaluator.evaluate(annotation.value, value) as Boolean\\n\\t}\\n\\n}\\n```\\n\\n### `clojure`\u8868\u8fbe\u5f0f\u5904\u7406\\n\\n#### \u65b0\u589e`ClojureExpressionEvaluator`\u4ee5\u5b9e\u73b0`clojure`\u8868\u8fbe\u5f0f\u7684\u5904\u7406\\n\\n`ClojureExpressionEvaluator`\u62bd\u8c61\u4e86`clojure`\u8868\u8fbe\u5f0f\u7684\u5904\u7406. \u5bf9\u4e8e\u4e0a\u5c42\u8c03\u7528\u65b9\u6765\u8bf4\u4e0d\u9700\u8981\u5173\u5fc3`clojure`\u8868\u8fbe\u5f0f\u7684\u5904\u7406\u7ec6\u8282,\\n\u53ea\u9700\u8981\u8c03\u7528`evaluate`\u65b9\u6cd5\u5373\u53ef.<br/>\\n\u5b83\u7684\u4e3b\u8981\u529f\u80fd\u662f\u6839\u636e\u7ed9\u5b9a\u7684`clojure`\u8868\u8fbe\u5f0f\u53ca\u8f93\u5165\u8fdb\u884c\u5904\u7406\u5e76\u5f97\u51fa\u8fd4\u56de\u7ed3\u679c.<br/>\\n\u901a\u8fc7\u4e0e`clojure`\u7684\u4e92\u64cd\u4f5c, \u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5b9e\u73b0`clojure`\u8868\u8fbe\u5f0f\u7684\u89e3\u6790.<br/>\\n\u4ee5\u4e0b\u662f\u76f8\u5173\u4ee3\u7801:\\n\\n```kotlin\\n/**\\n * An interface used to evaluate the clojure expression with the given param and return the result.\\n *\\n * @author Xiangcheng.Kuo\\n */\\ninterface ClojureExpressionEvaluator {\\n\\n\\tfun evaluate(expression: String, param: Any?): Any?\\n\\n}\\n\\n/**\\n * The default implementation of [ClojureExpressionEvaluator].\\n *\\n * @author Xiangcheng.Kuo\\n * @see Class to refer to\\n */\\nobject DefaultClojureExpressionEvaluator : ClojureExpressionEvaluator {\\n\\n\\tprivate val evalFun: IFn\\n\\n\\tinit {\\n\\t\\tcom.fastonetech.lib.clojure.require(\\"com.fastonetech.lib.clojure.support.evaluation\\".toCljSymbol())\\n\\t\\tevalFun = Clojure.`var`(\\"com.fastonetech.lib.clojure.support.evaluation/evaluate-expression\\")\\n\\t}\\n\\n\\toverride fun evaluate(expression: String, param: Any?): Any? =\\n\\t\\tevalFun(expression, param.toCljValue())\\n\\n}\\n```\\n\\n#### \u65b0\u589eevaluation.clj\u6765\u5b9e\u73b0\u6700\u7ec8\u7684`clojure`\u8868\u8fbe\u5f0f\u7684\u89e3\u6790\u5904\u7406\\n\\n`evaluation.clj`\u662f\u4e00\u4e2a`clojure`\u7684\u6587\u4ef6, \u7528\u4e8e\u5b9e\u73b0`clojure`\u8868\u8fbe\u5f0f\u7684\u89e3\u6790.<br/>\\n\u4ee5\u4e0b\u662f\u76f8\u5173\u4ee3\u7801:\\n\\n```clojure\\n(ns com.fastonetech.lib.clojure.support.evaluation\\n  (:require [clojure.java.data :as data]))\\n\\n; We need to convert the list to vector to avoid the evaluator think the list is a function call.\\n; For example, if we have a list like (1 2 3), the evaluator will think it is a function call.\\n; So we need to convert it to [1 2 3] to avoid this problem.\\n(defn as-available-form [form]\\n  (if (seq? form) (into [] form) form))\\n\\n(defn object-to-map [object]\\n  (data/from-java-deep object {:add-class false}))\\n\\n(defn object-to-form [^Object object]\\n  (clojure.walk/postwalk as-available-form (object-to-map object)))\\n\\n(defn build-form [value-form expression-form]\\n  (list `let [\'it value-form] expression-form))\\n\\n(defn expression-as-form [^String expression]\\n  (read-string expression))\\n\\n(defn evaluate-expression [^String expression ^Object param]\\n  (let [value-form (object-to-form param)\\n        expression-form (expression-as-form expression)\\n        form (build-form value-form expression-form)]\\n    (println \\"Expression form: \\" form)\\n    (let [result (eval form)]\\n      (println \\"Result: \\" result)\\n      result)))\\n```\\n\\n### `springboot`\u96c6\u6210\\n\\n\u8be5\u90e8\u5206\u4e3b\u8981\u662f\u5c06\u4e0a\u9762\u7684\u4ee3\u7801\u96c6\u6210\u5230`springboot`\u4e2d.<br/>\\n\u4e3b\u8981\u662f\u5c06`ClojureExpressionConstraintValidator`\u6dfb\u52a0\u5230\u5bb9\u5668\u4e2d\u8fd9\u6837`springboot`\u5c31\u53ef\u4ee5\u81ea\u52a8\u7684\u5bf9\u6ce8\u89e3\u8fdb\u884c\u9a8c\u8bc1\u4e86.<br/>\\n\\n#### ClojureExpressionValidationAutoConfiguration\\n\\n```kotlin\\n@AutoConfiguration\\nclass ClojureExpressionValidationAutoConfiguration {\\n\\n\\t@Bean\\n\\t@ConditionalOnMissingBean\\n\\tfun clojureExpressionConstraintValidator(evaluator: ClojureExpressionEvaluator): ClojureExpressionConstraintValidator =\\n\\t\\tClojureExpressionConstraintValidator(\\n\\t\\t\\tevaluator = evaluator\\n\\t\\t)\\n\\n\\t@Bean\\n\\t@ConditionalOnMissingBean\\n\\tfun clojureExpressionEvaluator(): ClojureExpressionEvaluator =\\n\\t\\tDefaultClojureExpressionEvaluator\\n\\n}\\n```\\n\\n#### \u914d\u7f6e`META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports`\\n\\n\u5728springboot3\u4e2d, \u6211\u4eec\u9700\u8981\u5728`META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports`\\n\u4e2d\u6dfb\u52a0\u9700\u8981\u81ea\u52a8\u914d\u7f6e\u7684\u7c7b.<br/>\\n\u65e7\u7684\u7248\u672c\u662f`spring.factories`, \u4f46\u662f\u5728springboot3\u4e2d\u5df2\u7ecf\u4e0d\u80fd\u7ee7\u7eed\u4f7f\u7528\u4e86.<br/>\\n\\n```kotlin\\ncom.fastonetech.lib.validation.spring.autoconfigure.ClojureExpressionValidationAutoConfiguration\\n```\\n\\n## \u603b\u7ed3\\n\\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230, \u901a\u8fc7`clojure`\u7684\u4e92\u64cd\u4f5c, \u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5b9e\u73b0`clojure`\u8868\u8fbe\u5f0f\u7684\u89e3\u6790.<br/>\\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728`springboot`\u4e2d\u4f7f\u7528`clojure`\u8868\u8fbe\u5f0f\u6765\u8fdb\u884c\u9a8c\u8bc1\u4e86.<br/>\\n\u4f46\u662f\u76ee\u524d\u7684\u5b9e\u73b0\u8fd8\u6709\u5f88\u591a\u4e0d\u8db3, \u4e3b\u8981\u5982\u4e0b\\n\\n- \u6ca1\u6709\u5bf9`clojure`\u8868\u8fbe\u5f0f\u8fdb\u884c\u7f13\u5b58, \u5bf9\u4e8e\u540c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u591a\u6b21\u9a8c\u8bc1\u4f1a\u91cd\u590d\u89e3\u6790<br/>\\n- `clojure`\u8868\u8fbe\u5f0f\u5185\u53ea\u80fd\u8bbf\u95ee`clojure.core`\u547d\u540d\u7a7a\u95f4\u7684\u5185\u5bb9, \u4e0d\u80fd\u8bbf\u95ee\u5176\u4ed6\u547d\u540d\u7a7a\u95f4\u7684\u5185\u5bb9<br/>\\n\\n\u8fd9\u4e9b\u90fd\u662f\u53ef\u4ee5\u4f18\u5316\u7684\u5730\u65b9, \u4f46\u662f\u76ee\u524d\u8fd8\u6ca1\u6709\u65f6\u95f4\u53bb\u505a.<br/>\\n\\n## \u9047\u5230\u7684\u95ee\u9898\\n\\n### \u81ea\u5b9a\u4e49\u6ce8\u89e3\u6ca1\u6709\u88ab\u8bc6\u522b\\n\\n#### \u539f\u56e0\\n\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u4e3b\u8981\u539f\u56e0\u5728\u5b9a\u4e49\u6ce8\u89e3\u662f\u6307\u5b9a\u4e86`@Target`\u6ce8\u89e3\u4e2d\u7684`AnnotationTarget.PROPERTY`\u9020\u6210\u7684\\n\\n\u53cd\u7f16\u8bd1\u540e\u7684`java`\u4ee3\u7801\u5982\u4e0b\\n\\n```java\\n\\n@Metadata(\\n\\t\\tmv = {1, 8, 0},\\n\\t\\tk = 1,\\n\\t\\td1 = {\\"\\\\u0000\\\\\\"\\\\n\\\\u0002\\\\u0018\\\\u0002\\\\n\\\\u0002\\\\u0010\\\\u0000\\\\n\\\\u0000\\\\n\\\\u0002\\\\u0010\\\\u000e\\\\n\\\\u0002\\\\b\\\\b\\\\n\\\\u0002\\\\u0010\\\\u000b\\\\n\\\\u0002\\\\b\\\\u0002\\\\n\\\\u0002\\\\u0010\\\\b\\\\n\\\\u0002\\\\b\\\\u0002\\\\b\\\\u0086\\\\b\\\\u0018\\\\u00002\\\\u00020\\\\u0001B\\\\r\\\\u0012\\\\u0006\\\\u0010\\\\u0002\\\\u001a\\\\u00020\\\\u0003\xa2\\\\u0006\\\\u0002\\\\u0010\\\\u0004J\\\\t\\\\u0010\\\\t\\\\u001a\\\\u00020\\\\u0003H\xc6\\\\u0003J\\\\u0013\\\\u0010\\\\n\\\\u001a\\\\u00020\\\\u00002\\\\b\\\\b\\\\u0002\\\\u0010\\\\u0002\\\\u001a\\\\u00020\\\\u0003H\xc6\\\\u0001J\\\\u0013\\\\u0010\\\\u000b\\\\u001a\\\\u00020\\\\f2\\\\b\\\\u0010\\\\r\\\\u001a\\\\u0004\\\\u0018\\\\u00010\\\\u0001H\xd6\\\\u0003J\\\\t\\\\u0010\\\\u000e\\\\u001a\\\\u00020\\\\u000fH\xd6\\\\u0001J\\\\t\\\\u0010\\\\u0010\\\\u001a\\\\u00020\\\\u0003H\xd6\\\\u0001R\\\\u001c\\\\u0010\\\\u0002\\\\u001a\\\\u00020\\\\u00038\\\\u0006X\\\\u0087\\\\u0004\xa2\\\\u0006\\\\u000e\\\\n\\\\u0000\\\\u0012\\\\u0004\\\\b\\\\u0005\\\\u0010\\\\u0006\\\\u001a\\\\u0004\\\\b\\\\u0007\\\\u0010\\\\b\xa8\\\\u0006\\\\u0011\\"},\\n\\t\\td2 = {\\"Lcom/fastonetech/lib/validation/clojure/PatchUser;\\", \\"\\", \\"username\\", \\"\\", \\"(Ljava/lang/String;)V\\", \\"getUsername$annotations\\", \\"()V\\", \\"getUsername\\", \\"()Ljava/lang/String;\\", \\"component1\\", \\"copy\\", \\"equals\\", \\"\\", \\"other\\", \\"hashCode\\", \\"\\", \\"toString\\", \\"fastone-web-spring-boot-starter\\"}\\n)\\npublic final class PatchUser {\\n\\n\\t@NotNull\\n\\tprivate final String username;\\n\\n\\t/** @deprecated */\\n\\t// $FF: synthetic method\\n\\t@ClojureExpressionConstraint(\\n\\t\\t\\tmessage = \\"the username must be a string and the length must be greater than 5\\",\\n\\t\\t\\tvalue = \\"(and (string? it) (> (count it) 5))\\"\\n\\t)\\n\\tpublic static void getUsername$annotations() {\\n\\t}\\n\\n\\t@NotNull\\n\\tpublic final String getUsername() {\\n\\t\\treturn this.username;\\n\\t}\\n\\n\\tpublic PatchUser(@NotNull String username) {\\n\\t\\tIntrinsics.checkNotNullParameter(username, \\"username\\");\\n\\t\\tsuper();\\n\\t\\tthis.username = username;\\n\\t}\\n\\n\\t@NotNull\\n\\tpublic final String component1() {\\n\\t\\treturn this.username;\\n\\t}\\n\\n\\t@NotNull\\n\\tpublic final PatchUser copy(@NotNull String username) {\\n\\t\\tIntrinsics.checkNotNullParameter(username, \\"username\\");\\n\\t\\treturn new PatchUser(username);\\n\\t}\\n\\n\\t// $FF: synthetic method\\n\\tpublic static PatchUser copy$default(PatchUser var0, String var1, int var2, Object var3) {\\n\\t\\tif ((var2 & 1) != 0) {\\n\\t\\t\\tvar1 = var0.username;\\n\\t\\t}\\n\\n\\t\\treturn var0.copy(var1);\\n\\t}\\n\\n\\t@NotNull\\n\\tpublic String toString() {\\n\\t\\treturn \\"PatchUser(username=\\" + this.username + \\")\\";\\n\\t}\\n\\n\\tpublic int hashCode() {\\n\\t\\tString var10000 = this.username;\\n\\t\\treturn var10000 != null ? var10000.hashCode() : 0;\\n\\t}\\n\\n\\tpublic boolean equals(@Nullable Object var1) {\\n\\t\\tif (this != var1) {\\n\\t\\t\\tif (var1 instanceof PatchUser) {\\n\\t\\t\\t\\tPatchUser var2 = (PatchUser) var1;\\n\\t\\t\\t\\tif (Intrinsics.areEqual(this.username, var2.username)) {\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn false;\\n\\t\\t} else {\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\t}\\n\\n}\\n```\\n\\n\u53ef\u4ee5\u770b\u5230\u6ce8\u89e3\u6700\u7ec8\u5e76\u6ca1\u6709\u5728`getUsername`\u65b9\u6cd5\u4e0a, \u800c\u662f\u5728`getUsername$annotations`\u65b9\u6cd5\u4e0a.<br/>\\n\u6211\u4e4b\u524d\u4ee5\u4e3a`AnnotationTarget.PROPERTY`\u662f\u4f1a\u5c06\u6ce8\u89e3\u5e94\u7528\u5230`get`\u548c`set`\u65b9\u6cd5\u4e0a, \u4f46\u662f\u5b9e\u9645\u4e0a\u5e76\u4e0d\u662f\u8fd9\u6837.<br/>\\n\\n#### \u89e3\u51b3\u65b9\u6848\\n\\n\u662f\u5c06`@Target`\u6ce8\u89e3\u4e2d\u7684`AnnotationTarget.PROPERTY`\u53bb\u6389.<br/>\\n\\n\u89e3\u51b3\u540e\u53cd\u7f16\u8bd1\u7684`java`\u4ee3\u7801\u5982\u4e0b\\n\\n```java\\npackage com.fastonetech.lib.validation.clojure;\\n\\nimport kotlin.Metadata;\\nimport kotlin.jvm.internal.Intrinsics;\\nimport org.jetbrains.annotations.NotNull;\\nimport org.jetbrains.annotations.Nullable;\\n\\n@Metadata(\\n\\t\\tmv = {1, 8, 0},\\n\\t\\tk = 1,\\n\\t\\td1 = {\\"\\\\u0000\\\\\\"\\\\n\\\\u0002\\\\u0018\\\\u0002\\\\n\\\\u0002\\\\u0010\\\\u0000\\\\n\\\\u0000\\\\n\\\\u0002\\\\u0010\\\\u000e\\\\n\\\\u0002\\\\b\\\\u0006\\\\n\\\\u0002\\\\u0010\\\\u000b\\\\n\\\\u0002\\\\b\\\\u0002\\\\n\\\\u0002\\\\u0010\\\\b\\\\n\\\\u0002\\\\b\\\\u0002\\\\b\\\\u0086\\\\b\\\\u0018\\\\u00002\\\\u00020\\\\u0001B\\\\r\\\\u0012\\\\u0006\\\\u0010\\\\u0002\\\\u001a\\\\u00020\\\\u0003\xa2\\\\u0006\\\\u0002\\\\u0010\\\\u0004J\\\\t\\\\u0010\\\\u0007\\\\u001a\\\\u00020\\\\u0003H\xc6\\\\u0003J\\\\u0013\\\\u0010\\\\b\\\\u001a\\\\u00020\\\\u00002\\\\b\\\\b\\\\u0002\\\\u0010\\\\u0002\\\\u001a\\\\u00020\\\\u0003H\xc6\\\\u0001J\\\\u0013\\\\u0010\\\\t\\\\u001a\\\\u00020\\\\n2\\\\b\\\\u0010\\\\u000b\\\\u001a\\\\u0004\\\\u0018\\\\u00010\\\\u0001H\xd6\\\\u0003J\\\\t\\\\u0010\\\\f\\\\u001a\\\\u00020\\\\rH\xd6\\\\u0001J\\\\t\\\\u0010\\\\u000e\\\\u001a\\\\u00020\\\\u0003H\xd6\\\\u0001R\\\\u0016\\\\u0010\\\\u0002\\\\u001a\\\\u00020\\\\u00038\\\\u0006X\\\\u0087\\\\u0004\xa2\\\\u0006\\\\b\\\\n\\\\u0000\\\\u001a\\\\u0004\\\\b\\\\u0005\\\\u0010\\\\u0006\xa8\\\\u0006\\\\u000f\\"},\\n\\t\\td2 = {\\"Lcom/fastonetech/lib/validation/clojure/PatchUser;\\", \\"\\", \\"username\\", \\"\\", \\"(Ljava/lang/String;)V\\", \\"getUsername\\", \\"()Ljava/lang/String;\\", \\"component1\\", \\"copy\\", \\"equals\\", \\"\\", \\"other\\", \\"hashCode\\", \\"\\", \\"toString\\", \\"fastone-web-spring-boot-starter\\"}\\n)\\npublic final class PatchUser {\\n\\n\\t@ClojureExpressionConstraint(\\n\\t\\t\\tmessage = \\"the username must be a string and the length must be greater than 5\\",\\n\\t\\t\\tvalue = \\"(and (string? it) (> (count it) 5))\\"\\n\\t)\\n\\t@NotNull\\n\\tprivate final String username;\\n\\n\\t@NotNull\\n\\tpublic final String getUsername() {\\n\\t\\treturn this.username;\\n\\t}\\n\\n\\tpublic PatchUser(@NotNull String username) {\\n\\t\\tIntrinsics.checkNotNullParameter(username, \\"username\\");\\n\\t\\tsuper();\\n\\t\\tthis.username = username;\\n\\t}\\n\\n\\t@NotNull\\n\\tpublic final String component1() {\\n\\t\\treturn this.username;\\n\\t}\\n\\n\\t@NotNull\\n\\tpublic final PatchUser copy(@NotNull String username) {\\n\\t\\tIntrinsics.checkNotNullParameter(username, \\"username\\");\\n\\t\\treturn new PatchUser(username);\\n\\t}\\n\\n\\t// $FF: synthetic method\\n\\tpublic static PatchUser copy$default(PatchUser var0, String var1, int var2, Object var3) {\\n\\t\\tif ((var2 & 1) != 0) {\\n\\t\\t\\tvar1 = var0.username;\\n\\t\\t}\\n\\n\\t\\treturn var0.copy(var1);\\n\\t}\\n\\n\\t@NotNull\\n\\tpublic String toString() {\\n\\t\\treturn \\"PatchUser(username=\\" + this.username + \\")\\";\\n\\t}\\n\\n\\tpublic int hashCode() {\\n\\t\\tString var10000 = this.username;\\n\\t\\treturn var10000 != null ? var10000.hashCode() : 0;\\n\\t}\\n\\n\\tpublic boolean equals(@Nullable Object var1) {\\n\\t\\tif (this != var1) {\\n\\t\\t\\tif (var1 instanceof PatchUser) {\\n\\t\\t\\t\\tPatchUser var2 = (PatchUser) var1;\\n\\t\\t\\t\\tif (Intrinsics.areEqual(this.username, var2.username)) {\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn false;\\n\\t\\t} else {\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\t}\\n\\n}\\n\\n```\\n\\n\u8fd9\u6b21\u6ce8\u89e3\u5728`username`\u5b57\u6bb5\u4e0a\u4e86.<br/>\\n\\n### `clojure`\u4e2d\u7684`eval`\u51fd\u6570\u6240\u9700\u7684`form`\u4e2d\u4e0d\u80fd\u4f9d\u8d56\u5916\u90e8\u7684\u53d8\u91cf\\n\\n\u5f53\u6267\u884c\u5982\u4e0b\u4ee3\u7801\u65f6\\n\\n```clojure\\n(defn eval-example []\\n  (let [x 10]\\n    (eval `(+ x 20))))\\n(eval-example)\\n```\\n\\n\u4f1a\u62a5\u9519\u4ee5\u4e0b\u4fe1\u606f\\n\\n```log\\nSyntax error compiling at (/tmp/form-init13157191612884728008.clj:1:1).\\nNo such var: user/x\\n```\\n\\n#### \u539f\u56e0\\n\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f`eval`\u51fd\u6570\u6240\u9700\u7684`form`\u4e2d\u4e0d\u80fd\u4f9d\u8d56\u5916\u90e8\u7684\u53d8\u91cf, \u8981\u4e48\u88ab\u4f9d\u8d56\u7684\u53d8\u91cf\u662f\u5168\u5c40\\n\u4ece\u62a5\u9519\u53ef\u4ee5\u770b\u5230\u5b83\u5c1d\u8bd5\u4ece`user`\u8fd9\u4e2a\u547d\u540d\u7a7a\u95f4\u4e2d\u627e`x`\u8fd9\u4e2a\u53d8\u91cf, \u4f46\u662f\u5e76\u6ca1\u6709\u627e\u5230.<br/>\\n\u800c\u6211\u4eec\u7684\u547d\u540d\u7a7a\u95f4\u4e0d\u662f`user`\u6240\u4ee5\u4f1a\u62a5\u9519.<br/>\\n\u8fd9\u4e2a\u95ee\u9898\u7684\u672c\u8d28\u539f\u56e0\u662f\u56e0\u4e3a`eval`\u51fd\u6570\u5185\u90e8\u6267\u884c\u7684\u4ee3\u7801\u548c\u5916\u90e8\u7684\u4ee3\u7801\u662f\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4, \u6240\u4ee5\u4e0d\u80fd\u4f9d\u8d56\u8c03\u7528\u5916\u90e8\u8c03\u7528`eval`\\n\u51fd\u6570\u7684\u51fd\u6570\u7684\u5c40\u90e8\u53d8\u91cf.<br/>\\n\\n\u9700\u8981\u5728`form`\u4e2d\u91cd\u65b0`binding`\u6216\u8005\u53d8\u91cf\\n\\n#### \u89e3\u51b3\u65b9\u6848\\n\\n\u5728\u9700\u8981`eval`\u7684`form`\u4e2d\u91cd\u65b0`binding`\u53d8\u91cf\\n\\n### `clojure`\u4e2d\u7684`eval`\u51fd\u6570\u6240\u9700\u7684`form`\u4e2d`binding`\u4e86\u81ea\u5b9a\u4e49\u5bf9\u8c61\u5f53\u6267\u884c\u65f6\u4f1a\u62a5\u9519\\n\\n\u62a5\u9519\u5982\u4e0b\\n\\n```log\\nembed object in code, maybe print-dup not defined: Person(age=30)\\n```\\n\\n#### \u539f\u56e0\\n\\n\u7531\u4e8e`eval`\u9700\u8981\u5c06\u8868\u8fbe\u5f0f\u8f6c\u6362\u4e3a`clojure`\u6570\u636e\u7ed3\u6784, \u7136\u540e\u5728\u8fd0\u884c\u65f6\u89e3\u91ca\u548c\u6267\u884c\u8fd9\u4e2a\u8868\u8fbe\u5f0f.<br/>\\n\u5728\u5c06\u8868\u8fbe\u5f0f\u8f6c\u6362\u4e3a`clojure`\u6570\u636e\u7ed3\u6784\u7684\u8fc7\u7a0b\u4e2d, `clojure`\u9700\u8981\u4f7f\u7528`print-dup`\u51fd\u6570\u5c06\u8868\u8fbe\u5f0f\u4e2d\u7684\u6240\u6709\u5bf9\u8c61\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32,\\n\u4ee5\u4fbf\u540e\u7eed\u53ef\u4ee5\u901a\u8fc7`read`\u51fd\u6570\u5c06\u8fd9\u4e9b\u5b57\u7b26\u4e32\u8fd8\u539f\u4e3aClojure\u6570\u636e\u7ed3\u6784.<br/>\\n\u56e0\u6b64, \u5f53\u4f7f\u7528`eval`\u51fd\u6570\u6267\u884c\u8868\u8fbe\u5f0f\u65f6\uff0c\u5982\u679c\u8868\u8fbe\u5f0f\u4e2d\u5305\u542b\u65e0\u6cd5\u5e8f\u5217\u5316\u4e3a\u5b57\u7b26\u4e32\u7684\u5bf9\u8c61\uff0c\u5c31\u4f1a\u51fa\u73b0\u4e0a\u8ff0\u9519\u8bef.<br/>\\n\u800c\u5f53\u4e0d\u4f7f\u7528`eval`\u51fd\u6570\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e2a\u5bf9\u8c61\u65f6\uff0c\u7531\u4e8e`clojure`\u4e0d\u9700\u8981\u5c06\u5b83\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u5c31\u4e0d\u4f1a\u51fa\u73b0\u4e0a\u8ff0\u9519\u8bef.<br/>\\n\u7efc\u4e0a\u6240\u8ff0, `eval`\u51fd\u6570\u6240\u9700\u7684`form`\u4e2d`binding`\u4e86\u81ea\u5b9a\u4e49\u5bf9\u8c61\u5f53\u6267\u884c\u65f6\u4f1a\u62a5\u9519.<br/>\\n\\n#### \u89e3\u51b3\u65b9\u6848\\n\\n\u5c06\u81ea\u5b9a\u4e49\u5bf9\u8c61\u8f6c\u6362\u4e3a`clojure`\u7684\u5185\u7f6e\u6570\u636e\u7ed3\u6784\u4ece\u800c\u907f\u514d\u8fd9\u4e2a\u95ee\u9898.<br/>\\n\u901a\u8fc7`clojure.java.data`\u4e2d\u7684\u51fd\u6570`from-java-deep`\u8fdb\u884c\u8f6c\u6362<br/>\\n\u8f6c\u6362\u540e\u7684\u6570\u636e\u7ed3\u6784\u5982\u679c\u662f`list`\u8fd8\u9700\u8981\u8f6c\u4e3a`vec`, \u8fd9\u662f\u56e0\u4e3a`clojure`\u4e2d\u7684`list`\u4ee3\u8868\u4e86\u51fd\u6570\u8c03\u7528, \u800c`vec`\u4ee3\u8868\u4e86\u6570\u636e\u7ed3\u6784,\\n\u6240\u4ee5\u9700\u8981\u8f6c\u6362\u4e3a`vec`.<br/>\\n\u53ef\u4ee5\u901a\u8fc7`clojure.walk/postwalk`\u51fd\u6570\u8fdb\u884c\u9012\u5f52\u8f6c\u6362.<br/>\\n\\n## \u5907\u6ce8\\n\\n### `clojure`\u4e2d\u7684`eval`\u51fd\u6570\\n\\n`eval`\u51fd\u6570\u662f\u5c06\u7ed9\u5b9a\u7684`form`\u7f16\u8bd1\u6267\u884c, \u8fd4\u56de\u6267\u884c\u7ed3\u679c.<br/>\\n\\n### `clojure`\u4e2d\u7684`form`\\n\\n`form`\u662f`clojure`\u4e2d\u7684\u8868\u8fbe\u5f0f, \u4e5f\u5c31\u662f`clojure`\u4e2d\u7684\u4ee3\u7801.<br/>\\n\u4f8b\u5982:\\n\\n```clojure\\n(+ 1 2)\\n```\\n\\n### `clojure`\u4e2d\u7684`binding`\\n\\n`binding`\u662f\u5c06\u53d8\u91cf\u7ed1\u5b9a\u5230\u4e00\u4e2a\u503c, \u4f7f\u5f97\u5728`binding`\u7684\u4f5c\u7528\u57df\u5185, \u53d8\u91cf\u7684\u503c\u4e3a\u7ed1\u5b9a\u7684\u503c.<br/>\\n\\n### `clojure`\u4e2d\u7684\u5168\u5c40\u53d8\u91cf\\n\\n`clojure`\u4e2d\u7684\u5168\u5c40\u53d8\u91cf\u662f\u6307\u5728`clojure`\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u53d8\u91cf.<br/>\\n\u4f8b\u5982:\\n\\n```clojure\\n(def x 10)\\n```\\n\\n\u8fd9\u4e2a`x`\u5c31\u662f\u5168\u5c40\u53d8\u91cf.<br/>\\n\\n\u5c40\u90e8\u53d8\u91cf\u662f\u6307\u5728\u51fd\u6570\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf.<br/>\\n\u4f8b\u5982:\\n\\n```clojure\\n(defn test []\\n  (let [x 10] x))\\n```\\n\\n## \u53c2\u8003\\n- [Annotation use-site targets](https://kotlinlang.org/docs/annotations.html#annotation-use-site-targets)\\n- [Spring MVC Custom Validation](https://www.baeldung.com/spring-mvc-custom-validator)\\n- [Evaluation](https://clojure.org/reference/evaluation)\\n- [Variable scope + eval in Clojure](https://stackoverflow.com/questions/6221716/variable-scope-eval-in-clojure)\\n- [Modifying expressions at runtime](https://stackoverflow.com/questions/23039818/modifying-expressions-at-runtime)\\n- [clojure and ^:dynamic](https://stackoverflow.com/questions/11730828/clojure-and-dynamic)\\n- [convert Java objects to Clojure types](https://stackoverflow.com/questions/64075760/convert-java-objects-to-clojure-types)\\n- [Access Java fields dynamically in Clojure?](https://stackoverflow.com/questions/6630432/access-java-fields-dynamically-in-clojure)\\n- [Clojure\u5165\u95e8\u6559\u7a0b](https://wizardforcel.gitbooks.io/clojure-fpftj/content/index.html)"},{"id":"/2023/02/26/","metadata":{"permalink":"/markdowns/blog/2023/02/26/","source":"@site/blog/2023-02-26.md","title":"ubuntu\u4e2d\u5e38\u7528\u7684apt\u6e90","description":"\u672c\u6587\u8bb0\u5f55\u4e86ubuntu\u4e2d\u5e38\u7528\u7684apt\u6e90, \u4ee5\u53ca\u5982\u4f55\u914d\u7f6eapt\u6e90.","date":"2023-02-26T00:00:00.000Z","formattedDate":"February 26, 2023","tags":[{"label":"apt","permalink":"/markdowns/blog/tags/apt"},{"label":"ubuntu","permalink":"/markdowns/blog/tags/ubuntu"},{"label":"linux","permalink":"/markdowns/blog/tags/linux"}],"readingTime":3.98,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["apt","ubuntu","linux"]},"prevItem":{"title":"\u57fa\u4e8eclojure\u8868\u8fbe\u5f0f\u5b9e\u73b0\u66f4\u52a0\u7075\u6d3b\u7684\u6570\u636e\u9a8c\u8bc1","permalink":"/markdowns/blog/2023/03/02/clojure-validation"},"nextItem":{"title":"\u4f7f\u7528nvm\u5b9e\u73b0nodejs\u591a\u7248\u672c\u7ba1\u7406","permalink":"/markdowns/blog/2023/02/25/"}},"content":"\u672c\u6587\u8bb0\u5f55\u4e86`ubuntu`\u4e2d\u5e38\u7528\u7684`apt`\u6e90, \u4ee5\u53ca\u5982\u4f55\u914d\u7f6e`apt`\u6e90.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u786e\u8ba4`codename`\\n\\n\u4e0d\u540c\u7684\u7248\u672c\u7684`ubuntu`, `codename`\u4f1a\u6709\u6240\u4e0d\u540c, \u6bd4\u5982`20.04`\u7684`codename`\u662f`focal`, `22.10`\u7684`codename`\u662f`kinetic`.\\n\\n\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u786e\u8ba4`codename`\\n\\n```bash\\nlsb_release -a\\n```\\n\\n\u8f93\u51fa\u7ed3\u679c\u53c2\u8003\\n\\n```log\\nNo LSB modules are available.\\nDistributor ID: Ubuntu\\nDescription:    Ubuntu 22.10\\nRelease:        22.10\\nCodename:       kinetic\\n```\\n\\n### \u7f16\u8f91`/etc/apt/sources.list`\\n\\n\u5c06\u4e0b\u9762\u7684\u5185\u5bb9\u4e2d\u7684`kinetic`\u66ff\u6362\u4e3a\u4e0a\u4e00\u6b65\u4e2d\u7684`codename`, \u7136\u540e\u4fdd\u5b58\u5230`/etc/apt/sources.list`\u4e2d.\\n\\n```text title=\\"/etc/apt/sources.list\\"\\n# Jiaotong University\\ndeb https://ftp.sjtu.edu.cn/sites/archive.ubuntu.com/ kinetic main restricted universe multiverse\\ndeb https://ftp.sjtu.edu.cn/sites/archive.ubuntu.com/ kinetic-updates main restricted universe multiverse\\ndeb https://ftp.sjtu.edu.cn/sites/archive.ubuntu.com/ kinetic-backports main restricted universe multiverse\\ndeb https://ftp.sjtu.edu.cn/sites/archive.ubuntu.com/ kinetic-security main restricted universe multiverse\\n\\n\\n# Tsinghua\\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic main restricted universe multiverse\\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic main restricted universe multiverse\\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic-updates main restricted universe multiverse\\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic-updates main restricted universe multiverse\\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic-backports main restricted universe multiverse\\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic-backports main restricted universe multiverse\\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic-security main restricted universe multiverse\\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic-security main restricted universe multiverse\\n\\n# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic-proposed main restricted universe multiverse\\n# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ kinetic-proposed main restricted universe multiverse\\n\\n# Ali\\ndeb http://mirrors.aliyun.com/ubuntu/ kinetic main restricted universe multiverse\\ndeb-src http://mirrors.aliyun.com/ubuntu/ kinetic main restricted universe multiverse\\ndeb http://mirrors.aliyun.com/ubuntu/ kinetic-security main restricted universe multiverse\\ndeb-src http://mirrors.aliyun.com/ubuntu/ kinetic-security main restricted universe multiverse\\ndeb http://mirrors.aliyun.com/ubuntu/ kinetic-updates main restricted universe multiverse\\ndeb-src http://mirrors.aliyun.com/ubuntu/ kinetic-updates main restricted universe multiverse\\ndeb http://mirrors.aliyun.com/ubuntu/ kinetic-proposed main restricted universe multiverse\\ndeb-src http://mirrors.aliyun.com/ubuntu/ kinetic-proposed main restricted universe multiverse\\ndeb http://mirrors.aliyun.com/ubuntu/ kinetic-backports main restricted universe multiverse\\ndeb-src http://mirrors.aliyun.com/ubuntu/ kinetic-backports main restricted universe multiverse\\n\\n\\n# Netease\\ndeb http://mirrors.163.com/ubuntu/ kinetic main restricted universe multiverse\\ndeb http://mirrors.163.com/ubuntu/ kinetic-security main restricted universe multiverse\\ndeb http://mirrors.163.com/ubuntu/ kinetic-updates main restricted universe multiverse\\ndeb http://mirrors.163.com/ubuntu/ kinetic-proposed main restricted universe multiverse\\ndeb http://mirrors.163.com/ubuntu/ kinetic-backports main restricted universe multiverse\\ndeb-src http://mirrors.163.com/ubuntu/ kinetic main restricted universe multiverse\\ndeb-src http://mirrors.163.com/ubuntu/ kinetic-security main restricted universe multiverse\\ndeb-src http://mirrors.163.com/ubuntu/ kinetic-updates main restricted universe multiverse\\ndeb-src http://mirrors.163.com/ubuntu/ kinetic-proposed main restricted universe multiverse\\ndeb-src http://mirrors.163.com/ubuntu/ kinetic-backports main restricted universe multiverse\\n\\n\\n# \u4e2d\u79d1\u5927\u955c\u50cf\u6e90\\ndeb https://mirrors.ustc.edu.cn/ubuntu/ kinetic main restricted universe multiverse\\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ kinetic main restricted universe multiverse\\ndeb https://mirrors.ustc.edu.cn/ubuntu/ kinetic-updates main restricted universe multiverse\\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ kinetic-updates main restricted universe multiverse\\ndeb https://mirrors.ustc.edu.cn/ubuntu/ kinetic-backports main restricted universe multiverse\\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ kinetic-backports main restricted universe multiverse\\ndeb https://mirrors.ustc.edu.cn/ubuntu/ kinetic-security main restricted universe multiverse\\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ kinetic-security main restricted universe multiverse\\ndeb https://mirrors.ustc.edu.cn/ubuntu/ kinetic-proposed main restricted universe multiverse\\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ kinetic-proposed main restricted universe multiverse\\n\\n#deb cdrom:[Ubuntu 22.04 LTS _kinetic Jellyfish_ - Release amd64 (20220419)]/ kinetic main restricted\\n\\n# See http://help.ubuntu.com/community/UpgradeNotes for how to upgrade to\\n# newer versions of the distribution.\\ndeb http://cn.archive.ubuntu.com/ubuntu/ kinetic main restricted\\n# deb-src http://cn.archive.ubuntu.com/ubuntu/ kinetic main restricted\\n\\n## Major bug fix updates produced after the final release of the\\n## distribution.\\ndeb http://cn.archive.ubuntu.com/ubuntu/ kinetic-updates main restricted\\n# deb-src http://cn.archive.ubuntu.com/ubuntu/ kinetic-updates main restricted\\n\\n## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu\\n## team. Also, please note that software in universe WILL NOT receive any\\n## review or updates from the Ubuntu security team.\\ndeb http://cn.archive.ubuntu.com/ubuntu/ kinetic universe\\n# deb-src http://cn.archive.ubuntu.com/ubuntu/ kinetic universe\\ndeb http://cn.archive.ubuntu.com/ubuntu/ kinetic-updates universe\\n# deb-src http://cn.archive.ubuntu.com/ubuntu/ kinetic-updates universe\\n\\n## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu \\n## team, and may not be under a free licence. Please satisfy yourself as to \\n## your rights to use the software. Also, please note that software in \\n## multiverse WILL NOT receive any review or updates from the Ubuntu\\n## security team.\\ndeb http://cn.archive.ubuntu.com/ubuntu/ kinetic multiverse\\n# deb-src http://cn.archive.ubuntu.com/ubuntu/ kinetic multiverse\\ndeb http://cn.archive.ubuntu.com/ubuntu/ kinetic-updates multiverse\\n# deb-src http://cn.archive.ubuntu.com/ubuntu/ kinetic-updates multiverse\\n\\n## N.B. software from this repository may not have been tested as\\n## extensively as that contained in the main release, although it includes\\n## newer versions of some applications which may provide useful features.\\n## Also, please note that software in backports WILL NOT receive any review\\n## or updates from the Ubuntu security team.\\ndeb http://cn.archive.ubuntu.com/ubuntu/ kinetic-backports main restricted universe multiverse\\n# deb-src http://cn.archive.ubuntu.com/ubuntu/ kinetic-backports main restricted universe multiverse\\n\\ndeb http://security.ubuntu.com/ubuntu kinetic-security main restricted\\n# deb-src http://security.ubuntu.com/ubuntu kinetic-security main restricted\\ndeb http://security.ubuntu.com/ubuntu kinetic-security universe\\n# deb-src http://security.ubuntu.com/ubuntu kinetic-security universe\\ndeb http://security.ubuntu.com/ubuntu kinetic-security multiverse\\n# deb-src http://security.ubuntu.com/ubuntu kinetic-security multiverse\\n\\n# This system was installed using small removable media\\n# (e.g. netinst, live or single CD). The matching \\"deb cdrom\\"\\n# entries were disabled at the end of the installation process.\\n# For information about how to configure apt package sources,\\n# see the sources.list(5) manual.\\n```\\n\\n## \u53c2\u8003\\n\\n- [Official Archive Mirrors for Ubuntu](https://launchpad.net/ubuntu/+archivemirrors)\\n- [SourcesList](https://wiki.debian.org/SourcesList)"},{"id":"/2023/02/25/","metadata":{"permalink":"/markdowns/blog/2023/02/25/","source":"@site/blog/2023-02-25.md","title":"\u4f7f\u7528nvm\u5b9e\u73b0nodejs\u591a\u7248\u672c\u7ba1\u7406","description":"\u5728\u65e5\u5e38\u5f00\u53d1\u4e2d, \u6709\u65f6\u5019\u9700\u8981\u4f7f\u7528\u4e0d\u540c\u7248\u672c\u7684nodejs\u6765\u5f00\u53d1\u4e0d\u540c\u7684\u9879\u76ee.","date":"2023-02-25T00:00:00.000Z","formattedDate":"February 25, 2023","tags":[{"label":"nvm","permalink":"/markdowns/blog/tags/nvm"},{"label":"nodejs","permalink":"/markdowns/blog/tags/nodejs"}],"readingTime":1.44,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["nvm","nodejs"]},"prevItem":{"title":"ubuntu\u4e2d\u5e38\u7528\u7684apt\u6e90","permalink":"/markdowns/blog/2023/02/26/"},"nextItem":{"title":"\u542f\u7528SSH\u5bc6\u7801\u9a8c\u8bc1","permalink":"/markdowns/blog/2023/02/24/"}},"content":"\u5728\u65e5\u5e38\u5f00\u53d1\u4e2d, \u6709\u65f6\u5019\u9700\u8981\u4f7f\u7528\u4e0d\u540c\u7248\u672c\u7684`nodejs`\u6765\u5f00\u53d1\u4e0d\u540c\u7684\u9879\u76ee.<br/>\\n\u4f8b\u5982, \u6709\u4e00\u4e2a`UI`\u9879\u76ee, \u9700\u8981\u4f7f\u7528`nodejs`\u7684`v12`\u7248\u672c, \u800c\u53e6\u4e00\u4e2a\u9879\u76ee\u9700\u8981\u4f7f\u7528`nodejs`\u7684`v14`\u7248\u672c.<br/>\\n\u8fd9\u65f6\u5019\u5c31\u9700\u8981\u4f7f\u7528`nvm`\u6765\u5b9e\u73b0`nodejs`\u7684\u591a\u7248\u672c\u7ba1\u7406.<br/>\\n\u672c\u6587\u5c06\u4ee5`nodejs-v18`\u4e3a\u4f8b\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528`nvm`\u6765\u5b9e\u73b0`nodejs`\u7684\u591a\u7248\u672c\u7ba1\u7406\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u5b89\u88c5\\n\\n- \u5c06`github`\u4e0a\u7684`nvm`\u9879\u76ee\u514b\u9686\u5230\u672c\u5730\\n\\n```bash\\ngit clone git@github.com:nvm-sh/nvm.git\\n```\\n\\n- \u6267\u884c`nvm`\u7684\u5b89\u88c5\u811a\u672c\\n\\n\u8fdb\u5165`nvm`\u9879\u76ee\u7684\u6839\u76ee\u5f55, \u6267\u884c`install.sh`\u811a\u672c\\n\\n```bash\\n./install.sh\\n```\\n\\n### \u5c06`nvm`\u6dfb\u52a0\u5230`~/.bashrc`\u4e2d\\n\\n- \u914d\u7f6e`~/.bashrc`\\n\\n\u8ffd\u52a0\u4ee5\u4e0b\u5185\u5bb9\u5230`~/.bashrc`\u6587\u4ef6\u4e2d\\n\\n```bash\\nexport NVM_DIR=$DEV_SOFTWARE_HOME/Nvm\\n[ -s \\"$NVM_DIR/nvm.sh\\" ] && \\\\. \\"$NVM_DIR/nvm.sh\\"  # This loads nvm\\n[ -s \\"$NVM_DIR/bash_completion\\" ] && \\\\. \\"$NVM_DIR/bash_completion\\"  # This loads nvm bash_completion\\n```\\n\\n- \u91cd\u65b0\u52a0\u8f7d`~/.bashrc`\\n\\n```bash\\nsource ~/.bashrc\\n```\\n\\n### `node`\u5b89\u88c5\\n\\n- \u5b89\u88c5`nodejs`\u7684`v18`\u7248\u672c\\n\\n```bash\\nnvm install 18\\n```\\n\\n- \u6267\u884c`node -v`\u547d\u4ee4, \u67e5\u770b`nodejs`\u7684\u7248\u672c\\n\\n```bash\\nnode -v\\n```\\n\\n### \u8bbe\u7f6e`nodejs`\u7684\u9ed8\u8ba4\u7248\u672c\\n\\n- \u7f16\u8f91`~/.bashrc`\u6587\u4ef6, \u8ffd\u52a0\u4ee5\u4e0b\u5185\u5bb9\\n\\n```bash\\nnvm alias default 18\\n```\\n\\n- \u91cd\u65b0\u52a0\u8f7d`~/.bashrc`\\n\\n```bash\\nsource ~/.bashrc\\n```\\n\\n## \u53c2\u8003\\n\\n- [nvm](https://github.com/nvm-sh/nvm)"},{"id":"/2023/02/24/","metadata":{"permalink":"/markdowns/blog/2023/02/24/","source":"@site/blog/2023-02-24.md","title":"\u542f\u7528SSH\u5bc6\u7801\u9a8c\u8bc1","description":"\u5728ssh\u4e2d, \u9ed8\u8ba4\u662f\u4e0d\u5141\u8bb8\u4f7f\u7528password\u8ba4\u8bc1\u7684, \u4f46\u662f\u6709\u65f6\u5019, \u6211\u4eec\u9700\u8981\u4f7f\u7528password\u8ba4\u8bc1.","date":"2023-02-24T00:00:00.000Z","formattedDate":"February 24, 2023","tags":[{"label":"ssh","permalink":"/markdowns/blog/tags/ssh"}],"readingTime":0.635,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["ssh"]},"prevItem":{"title":"\u4f7f\u7528nvm\u5b9e\u73b0nodejs\u591a\u7248\u672c\u7ba1\u7406","permalink":"/markdowns/blog/2023/02/25/"},"nextItem":{"title":"\u5e38\u89c1\u7684\u547d\u540d\u524d\u7f00","permalink":"/markdowns/blog/2023/02/23/"}},"content":"\u5728`ssh`\u4e2d, \u9ed8\u8ba4\u662f\u4e0d\u5141\u8bb8\u4f7f\u7528`password`\u8ba4\u8bc1\u7684, \u4f46\u662f\u6709\u65f6\u5019, \u6211\u4eec\u9700\u8981\u4f7f\u7528`password`\u8ba4\u8bc1.<br/>\\n\u4e3a\u4e86\u80fd\u591f\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd, \u6211\u4eec\u9700\u8981\u5bf9`ssh`\u8fdb\u884c\u914d\u7f6e\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u4fee\u6539`sshd`\u914d\u7f6e\u6587\u4ef6\\n\\n\u4fee\u6539`/etc/ssh/sshd_config`\u6587\u4ef6, \u5c06`PasswordAuthentication`\u8bbe\u7f6e\u4e3a`yes`\\n\\n```\\nPasswordAuthentication no\\n```\\n\\n### \u91cd\u542f`ssh`\u670d\u52a1\\n\\n\u4ee5\u4e0b\u6709\u4e24\u79cd\u65b9\u5f0f, \u9009\u62e9\u4e00\u79cd\u5373\u53ef\\n\\n**\u65b9\u5f0f1: systemd**\\n\\n```bash\\nsudo systemctl restart sshd\\n```\\n\\n**\u65b9\u5f0f2: service**\\n\\n```bash\\nsudo service sshd restart\\n```\\n\\n## \u53c2\u8003\\n\\n- [How to Enable SSH Password Authentication](https://serverpilot.io/docs/how-to-enable-ssh-password-authentication/)"},{"id":"/2023/02/23/","metadata":{"permalink":"/markdowns/blog/2023/02/23/","source":"@site/blog/2023-02-23.md","title":"\u5e38\u89c1\u7684\u547d\u540d\u524d\u7f00","description":"\u5728\u7f16\u7a0b\u4e2d, \u547d\u540d\u662f\u4e00\u4ef6\u975e\u5e38\u91cd\u8981\u7684\u4e8b\u60c5, \u597d\u7684\u547d\u540d\u80fd\u591f\u8ba9\u4ee3\u7801\u66f4\u52a0\u6613\u8bfb, \u4e5f\u80fd\u591f\u8ba9\u4ee3\u7801\u66f4\u52a0\u6613\u4e8e\u7ef4\u62a4.","date":"2023-02-23T00:00:00.000Z","formattedDate":"February 23, 2023","tags":[{"label":"naming","permalink":"/markdowns/blog/tags/naming"}],"readingTime":8.93,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["naming"]},"prevItem":{"title":"\u542f\u7528SSH\u5bc6\u7801\u9a8c\u8bc1","permalink":"/markdowns/blog/2023/02/24/"},"nextItem":{"title":"springdoc-v2\u4e2d\u5728\u4e0d\u914d\u7f6e@ParameterObject\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0Pageable\u4ee5\u53caSort\u5bf9\u8c61\u5230API\u53c2\u6570\u7684\u8f6c\u6362","permalink":"/markdowns/blog/2023/02/22/"}},"content":"\u5728\u7f16\u7a0b\u4e2d, \u547d\u540d\u662f\u4e00\u4ef6\u975e\u5e38\u91cd\u8981\u7684\u4e8b\u60c5, \u597d\u7684\u547d\u540d\u80fd\u591f\u8ba9\u4ee3\u7801\u66f4\u52a0\u6613\u8bfb, \u4e5f\u80fd\u591f\u8ba9\u4ee3\u7801\u66f4\u52a0\u6613\u4e8e\u7ef4\u62a4.<br/>\\n\u901a\u5e38\u6211\u4eec\u5728\u9605\u8bfb\u7b2c\u4e09\u65b9\u5e93\u7684\u4ee3\u7801\u65f6, \u4f1a\u53d1\u73b0\u5f88\u591a\u65b9\u6cd5\u7684\u547d\u540d\u90fd\u662f\u4ee5\u4e00\u4e9b\u56fa\u5b9a\u7684\u547d\u540d\u524d\u7f00\u5f00\u5934\u7684.<br/>\\n\u672c\u6587\u4e3b\u8981\u603b\u7ed3\u76ee\u524d\u6211\u6240\u4e86\u89e3\u7684\u4e00\u4e9b\u5e38\u89c1\u7684\u547d\u540d\u524d\u7f00\u7684\u542b\u4e49. \u5e76\u5bf9\u5176\u8fdb\u884c\u5206\u7c7b, \u5927\u81f4\u7684\u5206\u7c7b\u4e3b\u8981\u5982\u4e0b.<br/>\\n\\n- \u5bf9\u8c61\u7684\u521b\u5efa\\n- \u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u72b6\u6001\\n- \u5bf9\u8c61\u7684\u5143\u7d20\u64cd\u4f5c\\n- \u5176\u4ed6\\n\\n\u5bf9\u4e8e\u6bcf\u79cd\u547d\u540d\u89c4\u5219, \u6211\u90fd\u4f1a\u7ed9\u51fa\u81ea\u5b9a\u4e49\u7684\u4f8b\u5b50, \u540c\u65f6\u4e5f\u4f1a\u9644\u5e26\u7b2c\u4e09\u65b9\u5e93\u4e2d\u7684\u73b0\u6709\u6848\u4f8b\u4ee5\u4fbf\u4e8e\u66f4\u597d\u7684\u7406\u89e3.<br/>\\n\u4ee3\u7801\u4ee5`kotlin`\u5b9e\u73b0, \u4f46\u662f\u5927\u90e8\u5206\u7684\u547d\u540d\u89c4\u5219\u90fd\u662f\u901a\u7528\u7684, \u4e5f\u9002\u7528\u4e8e\u5176\u4ed6\u7684\u8bed\u8a00.<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u5bf9\u8c61\u521b\u5efa\\n\\n\u8fd9\u4e9b\u547d\u540d\u524d\u7f00\u7528\u4e8e\u8868\u793a\u5bf9\u8c61\u7684\u521b\u5efa\\n\\n### new\\n\\n\u521b\u5efa\u65b0\u7684\u5bf9\u8c61\u5b9e\u4f8b, \u8be5\u65b9\u6cd5\u901a\u5e38\u662f\u4e00\u4e2a\u9759\u6001\u65b9\u6cd5, \u7528\u4e8e\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61\u5b9e\u4f8b.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u58f0\u660e\u9759\u6001\u65b9\u6cd5`newAccount`\u7528\u4e8e\u521b\u5efa\u4e00\u4e2a\u65b0\u7684`Account`\u5bf9\u8c61\u5b9e\u4f8b\\n\\n```kotlin\\nclass Account(\\n\\tval name: String,\\n\\tval createdAt: ZonedDateTime,\\n) {\\n\\n\\tcompanion object {\\n\\n\\t\\tfun newAccount(name: String, createdAt: ZonedDateTime): Account =\\n\\t\\t\\tTODO(\\"DO SOMETHING\\")\\n\\n\\t}\\n\\n}\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `com.google.common.collect.Lists#newArrayList`\\n\\n### valueOf\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5c06\u57fa\u672c\u7c7b\u578b\u503c\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684\u5305\u88c5\u7c7b\u5bf9\u8c61, \u4e00\u822c\u9002\u7528\u4e8e\u5e95\u5c42\u5e93\u4e2d.<br/>\\n\u8be5\u65b9\u6cd5\u5728\u4e1a\u52a1\u4ee3\u7801\u4e2d\u7684\u4f7f\u7528\u573a\u666f\u5e76\u4e0d\u591a, \u4f46\u662f\u5728\u5e95\u5c42\u5e93\u4e2d, \u8be5\u65b9\u6cd5\u7684\u4f7f\u7528\u573a\u666f\u8fd8\u662f\u6bd4\u8f83\u591a\u7684.<br/>\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `java.lang.Integer#valueOf`\\n\\n### getInstance\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u83b7\u53d6\u5355\u4f8b\u5bf9\u8c61.<br/>\\n\u5728`kotlin`\u4e2d, \u901a\u5e38\u4f7f\u7528`companion object`\u6765\u58f0\u660e\u5355\u4f8b\u5bf9\u8c61\\n\\n#### \u6848\u4f8b\\n\\n- \u901a\u8fc7\u58f0\u660e`getInstance`\u65b9\u6cd5\u6765\u83b7\u53d6\u5355\u4f8b\u5bf9\u8c61\\n\\n```kotlin\\nclass AccountService {\\n\\n\\tcompanion object {\\n\\n\\t\\tfun getInstance(): AccountService =\\n\\t\\t\\tTODO(\\"DO SOMETHING\\")\\n\\n\\t}\\n\\n}\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `org.springframework.cloud.openfeign.FeignContext#getInstance`\\n\\n### create\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u521b\u5efa\u65b0\u7684\u5bf9\u8c61\u5b9e\u4f8b, \u4f46\u662f\u5b83\u4e0e`new`\u65b9\u6cd5\u7684\u533a\u522b\u5728\u4e8e, \u5b83\u901a\u5e38\u7528\u4e8e\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u4e2d.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u901a\u8fc7`SessionRepositoryFactory`\u4e2d\u58f0\u660e\u7684\u5404\u79cd`create`\u65b9\u6cd5\u6765\u521b\u5efa\u4e0d\u540c\u7684`SessionRepository`\u5bf9\u8c61\\n\\n```kotlin\\ninterface SessionRepository {\\n\\n\\tfun getSession(requestId: String): Session\\n\\n}\\n\\ninterface SessionRepositoryFactory {\\n\\n\\tfun createInMemorySessionRepository(): SessionRepository\\n\\n\\tfun createDatabaseSessionRepository(): SessionRepository\\n\\n}\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBean`\\n\\n### from\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5c06\u5bf9\u8c61\u4ece\u4e00\u79cd\u7c7b\u578b\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u7c7b\u578b.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u901a\u8fc7`Account`\u4e2d\u58f0\u660e\u7684`fromDto`\u548c`fromEntity`\u65b9\u6cd5\u6765\u5c06`AccountDto`\u548c`AccountEntity`\u8f6c\u6362\u4e3a`Account`\u5bf9\u8c61\\n\\n```kotlin\\nclass Account {\\n\\n\\tcompanion object {\\n\\n\\n\\t\\tfun fromDto(dto: AccountDto): Account =\\n\\t\\t\\tTODO(\\"DO SOMETHING\\")\\n\\n\\t\\tfun fromEntity(entity: AccountEntity): Account =\\n\\t\\t\\tTODO(\\"DO SOMETHING\\")\\n\\n\\t}\\n\\n}\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `java.time.ZonedDateTime#from`\\n- `io.vavr.control.Validation#fromEither`\\n\\n### copy\\n\\n\u8be5\u65b9\u6cd5\u7528\u4e8e\u590d\u5236\u5bf9\u8c61, \u8fd4\u56de\u65b0\u7684\u526f\u672c.<br/>\\n\u5728`kotlin`\u4e2d`copy`\u662f`data class`\u81ea\u5e26\u7684\u65b9\u6cd5, \u8be5\u65b9\u6cd5\u7528\u4e8e\u590d\u5236\u4e00\u4e2a\u4e0d\u53ef\u53d8\u5bf9\u8c61.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- `kotlin`\u4e2d\u7684`copy`\u65b9\u6cd5\\n\\n```kotlin\\ndata class Person(val name: String, val age: Int)\\n\\nval person = Person(\\"Tom\\", 18)\\nval copiedPerson = person.copy(age = 20)\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `java.lang.String#copyValueOf`\\n\\n### clone\\n\\n\u8be5\u65b9\u6cd5\u7528\u4e8e\u590d\u5236\u5bf9\u8c61, \u8fd4\u56de\u65b0\u7684\u526f\u672c.<br/>\\n\u5728`java`\u4e2d, `clone`\u662f`Object`\u7c7b\u4e2d\u7684\u65b9\u6cd5, \u8be5\u65b9\u6cd5\u7528\u4e8e\u590d\u5236\u4e00\u4e2a\u5bf9\u8c61.<br/>\\n`copy`\u548c`clone`\u4e4b\u95f4\u7684\u533a\u522b\u5728\u4e8e, `copy`\u65b9\u6cd5\u662f\u5bf9\u4e00\u4e2a\u4e0d\u53ef\u53d8\u5bf9\u8c61\u7684\u590d\u5236, \u800c`clone`\u65b9\u6cd5\u5219\u6ca1\u6709\u8fd9\u4e2a\u9650\u5236.<br/>\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `java.lang.Object#clone`\\n\\n#### \u6848\u4f8b\\n\\n- `java`\u4e2d\u7684`clone`\u65b9\u6cd5\\n\\n```java\\npublic class Person implements Cloneable {\\n\\n\\tprivate String name;\\n\\n\\tprivate int age;\\n\\n\\t@Override\\n\\tpublic Person clone() {\\n\\t\\ttry {\\n\\t\\t\\treturn (Person) super.clone();\\n\\t\\t} catch (CloneNotSupportedException e) {\\n\\t\\t\\tthrow new AssertionError();\\n\\t\\t}\\n\\t}\\n\\n}\\n```\\n\\n### with\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u590d\u5236\u5bf9\u8c61\u5e76\u4fee\u6539\u5176\u7279\u5b9a\u5c5e\u6027.<br/>\\n\u4e00\u822c\u88ab\u590d\u5236\u7684\u5bf9\u8c61\u4e3a\u4e0d\u53ef\u53d8\u5bf9\u8c61.<br/>\\n\u548ccopy\u7684\u533a\u522b\u5728\u4e8e, \u8c03\u7528copy\u65f6, \u53ef\u4ee5\u9009\u62e9\u6027\u7684\u4fee\u6539\u5bf9\u8c61\u7684\u67d0\u4e9b\u5c5e\u6027,\\n\u800c\u8c03\u7528with\u65f6, \u901a\u5e38\u662f\u4fee\u6539\u5bf9\u8c61\u7684\u5355\u4e2a\u5c5e\u6027.<br/>\\n\\n\u5b83\u4eec\u4e4b\u95f4\u7684\u533a\u522b\u7c7b\u4f3c\u4e8e\u51fd\u6570\u5f0f\u7f16\u7a0b\u4e2d`curring`\u548c`partial apply`\u7684\u533a\u522b.<br/>\\n\u4e3b\u8981\u76f8\u4f3c\u70b9\u5728\u4e8e, \u53c2\u6570\u4f20\u5165\u7684\u6570\u91cf\u4e0d\u540c, \u53e6\u5916\u8fd4\u56de\u7684\u90fd\u662f\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61/\u51fd\u6570.<br/>\\n\\n`curring`: \u6bcf\u6b21\u53ea\u80fd\u4f20\u5165\u4e00\u4e2a\u53c2\u6570, \u8fd4\u56de\u4e00\u4e2a\u51fd\u6570, \u8be5\u51fd\u6570\u63a5\u6536\u5269\u4f59\u7684\u53c2\u6570.<br/>\\n`partial apply`: \u6bcf\u6b21\u53ef\u4ee5\u4f20\u5165\u591a\u4e2a\u53c2\u6570, \u8fd4\u56de\u4e00\u4e2a\u51fd\u6570, \u8be5\u51fd\u6570\u63a5\u6536\u5269\u4f59\u7684\u53c2\u6570.<br/>\\n\\n\u5728`lombok`\u4e2d, \u901a\u8fc7`@With`\u6ce8\u89e3\u6765\u5b9e\u73b0`with`\u65b9\u6cd5.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u901a\u8fc7`with`\u65b9\u6cd5\u4fee\u6539\u7279\u5b9a\u5c5e\u6027\\n\\n```kotlin\\nval person = Person()\\nperson.withName(\\"John\\").withAge(30)\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `io.vavr.collection.BitSet#withBytes`\\n\\n### parse\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5c06\u5b57\u7b26\u4e32\u89e3\u6790\u4e3a\u5bf9\u8c61.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u5c06\u5b57\u7b26\u4e32\u89e3\u6790\u4e3a`Date`\u5bf9\u8c61\\n\\n```kotlin\\nval date = Date.parse(\\"2020-01-01\\")\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `java.time.ZonedDateTime#parse`\\n\\n### of\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5c06\u591a\u4e2a\u53c2\u6570\u7ec4\u5408\u4e3a\u4e00\u4e2a\u5bf9\u8c61.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u5c06\u591a\u4e2a\u53c2\u6570\u7ec4\u5408\u4e3a\u4e00\u4e2a\u5bf9\u8c61\\n\\n```kotlin\\nval list = List.of(1, 2, 3)\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `java.time.ZonedDateTime#of`\\n\\n## \u5c5e\u6027\u548c\u72b6\u6001\\n\\n\u8fd9\u4e9b\u547d\u540d\u524d\u7f00\u7528\u4e8e\u8868\u793a\u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u72b6\u6001\\n\\n### get\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u83b7\u53d6\u5bf9\u8c61\u7684\u5c5e\u6027.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u83b7\u53d6\u7528\u6237\u7684\u59d3\u540d\\n\\n```kotlin\\nperson.getName()\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `org.springframework.boot.configurationprocessor.json.JSONObject#getString`\\n\\n### set or put\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u8bbe\u7f6e\u5bf9\u8c61\u7684\u5c5e\u6027.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u4fee\u6539\u7528\u6237\u7684\u59d3\u540d\\n\\n```kotlin\\nperson.setName(name = \\"Jack\\")\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `org.springframework.boot.configurationprocessor.json.JSONObject#put`\\n\\n### is\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5224\u65ad\u5bf9\u8c61\u7684\u72b6\u6001.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u5224\u65ad\u7528\u6237\u662f\u5426\u6210\u5e74\\n\\n```kotlin\\nperson.isAdult()\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `org.springframework.boot.configurationprocessor.json.JSONObject#isNull`\\n\\n## \u5bf9\u8c61\u7684\u5143\u7d20\u64cd\u4f5c\\n\\n\u8fd9\u4e9b\u547d\u540d\u524d\u7f00\u7528\u4e8e\u8868\u793a\u542b\u6709\u4e00\u4e9b\u5143\u7d20\u7684\u5bf9\u8c61\u7684\u64cd\u4f5c, \u901a\u5e38\u5728\u5177\u6709\u4e00\u5bf9\u591a\u7684\u5173\u7cfb\u7684\u5bf9\u8c61\u4e2d\u6bd4\u8f83\u5e38\u89c1<br/>\\n\\n### has\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u5305\u542b\u67d0\u4e2a\u5143\u7d20.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u5224\u65ad\u7528\u6237\u662f\u5426\u5177\u6709`ADMIN`\u89d2\u8272\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `org.springframework.boot.configurationprocessor.json.JSONObject#has`\\n\\n```kotlin\\nuser.hasRole(role = \\"ADMIN\\")\\n```\\n\\n### add\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5411\u5bf9\u8c61\u4e2d\u6dfb\u52a0\u5143\u7d20.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u4e3a\u7528\u6237\u6388\u4e88`ADMIN`\u89d2\u8272\\n\\n```kotlin\\nuser.addRole(role = \\"ADMIN\\")\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `java.util.List#add`\\n\\n### remove\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u4ece\u5bf9\u8c61\u4e2d\u79fb\u9664\u5143\u7d20.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u4e3a\u7528\u6237\u79fb\u9664`ADMIN`\u89d2\u8272\\n\\n```kotlin\\nuser.removeRole(role = \\"ADMIN\\")\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `java.util.List#remove`\\n\\n## \u5176\u4ed6\\n\\n\u8fd9\u4e9b\u547d\u540d\u524d\u7f00\u6ca1\u6709\u7279\u5b9a\u7684\u542b\u4e49, \u4f46\u662f\u5728\u4e00\u4e9b\u7279\u5b9a\u7684\u573a\u666f\u4e2d, \u4f1a\u6709\u7279\u5b9a\u7684\u542b\u4e49.<br/>\\n\\n### to\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5c06\u5bf9\u8c61\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u7c7b\u578b.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- \u5c06`Account`\u8f6c\u6362\u4e3a`AccountDto`\\n\\n```kotlin\\naccount.toDto()\\n```\\n\\n- \u5c06`Account`\u8f6c\u6362\u4e3a`AccountEntity`\\n\\n```kotlin\\naccount.toEntity()\\n```\\n\\n#### \u73b0\u6709\u6848\u4f8b\\n\\n- `org.springframework.boot.configurationprocessor.json.JSONObject#toJSONArray`\\n- `java.time.ZonedDateTime#toLocalDateTime`\\n\\n### do\\n\\n\u8be5\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u6267\u884c\u67d0\u4e2a\u64cd\u4f5c.<br/>\\n\u8be5\u65b9\u6cd5\u5728`spring`\u4e2d\u6bd4\u8f83\u5e38\u89c1, \u901a\u5e38\u8868\u793a\u5728\u6267\u884c\u5b8c\u67d0\u4e9b\u524d\u7f6e\u5de5\u4f5c, \u4f8b\u5982\u8f93\u5165\u9a8c\u8bc1, \u7136\u540e\u5f00\u59cb\u6267\u884c\u771f\u6b63\u7684\u64cd\u4f5c.<br/>\\n\\n#### \u6848\u4f8b\\n\\n- `org.springframework:spring-beans`\u4e2d`AbstractBeanFactory`\u7684`doGetBean`\u65b9\u6cd5\\n\\n```java\\npublic abstract class AbstractBeanFactory extends FactoryBeanRegistrySupport implements ConfigurableBeanFactory {\\n\\n\\tprotected <T> T doGetBean(\\n\\t\\tString name, @Nullable Class<T> requiredType, @Nullable Object[] args, boolean typeCheckOnly)\\n\\t\\tthrows BeansException {\\n\\n\\t}\\n\\n}\\n```\\n\\n- `org.springframework:spring-webmvc`\u4e2d`DispatcherServlet`\u7684`doDispatch`\u65b9\u6cd5\\n\\n```java\\npublic class DispatcherServlet extends FrameworkServlet {\\n\\n\\t@Override\\n\\tprotected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception {\\n\\t\\t// DO SOMETHING\\n\\t}\\n\\n}\\n```\\n\\n- `org.springframework:spring-jdbc`\u4e2d`AbstractPlatformTransactionManager`\u7684`doBegin`\u65b9\u6cd5\\n\\n```java\\npublic abstract class AbstractPlatformTransactionManager implements PlatformTransactionManager {\\n\\n\\tprotected void doBegin(Object transaction, TransactionDefinition definition) {\\n\\t\\t// DO SOMETHING\\n\\t}\\n\\n}\\n```\\n\\n## \u53c2\u8003\\n\\n- [Effective Java\u7b2c\u4e00\u7ae0\u4e2d\u5173\u4e8e\u9759\u6001\u5de5\u5382\u7684\u547d\u540d\u4e60\u60ef](https://github.com/clxering/Effective-Java-3rd-edition-Chinese-English-bilingual/blob/dev/Chapter-2/Chapter-2-Item-1-Consider-static-factory-methods-instead-of-constructors.md)\\n- [ORACLE Naming Conventions](https://www.oracle.com/java/technologies/javase/codeconventions-namingconventions.html)\\n- [Naming Conventions in Java](https://www.geeksforgeeks.org/java-naming-conventions/)"},{"id":"/2023/02/22/","metadata":{"permalink":"/markdowns/blog/2023/02/22/","source":"@site/blog/2023-02-22.md","title":"springdoc-v2\u4e2d\u5728\u4e0d\u914d\u7f6e@ParameterObject\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0Pageable\u4ee5\u53caSort\u5bf9\u8c61\u5230API\u53c2\u6570\u7684\u8f6c\u6362","description":"springdoc\u662f\u4e00\u4e2a\u53ef\u4ee5\u5feb\u901f\u751f\u6210API\u6587\u6863\u7684\u7b2c\u4e09\u65b9\u516c\u5171\u5e93, \u5e76\u63d0\u4f9b\u4e86UI\u9875\u9762\u4ee5\u4f9b\u8bbf\u95ee.","date":"2023-02-22T00:00:00.000Z","formattedDate":"February 22, 2023","tags":[{"label":"springdoc","permalink":"/markdowns/blog/tags/springdoc"},{"label":"spring","permalink":"/markdowns/blog/tags/spring"}],"readingTime":4.98,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["springdoc","spring"]},"prevItem":{"title":"\u5e38\u89c1\u7684\u547d\u540d\u524d\u7f00","permalink":"/markdowns/blog/2023/02/23/"},"nextItem":{"title":"\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6ce8\u5165\u6570\u7ec4\u5230\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e","permalink":"/markdowns/blog/2023/02/21/"}},"content":"`springdoc`\u662f\u4e00\u4e2a\u53ef\u4ee5\u5feb\u901f\u751f\u6210`API`\u6587\u6863\u7684\u7b2c\u4e09\u65b9\u516c\u5171\u5e93, \u5e76\u63d0\u4f9b\u4e86`UI`\u9875\u9762\u4ee5\u4f9b\u8bbf\u95ee.<br/>\\n\u540c\u65f6\u5b83\u4e5f\u63d0\u4f9b\u4e86`spring-webmvc`\u4e2d\u7684`handler`\u4e2d\u7684\u53c2\u6570\u5bf9\u8c61\u5230`API`\u53c2\u6570\u7684\u8f6c\u6362.<br/>\\n\u5bf9\u4e8e`spring-data-commons`\u4e2d\u7684`Pageable`\u548c`Sort`, `springdoc`\u63d0\u4f9b\u4e86\u5f00\u7bb1\u5373\u7528\u7684\u529f\u80fd,\\n\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u542f\u7528\u4ee5\u53ca\u5728\u53c2\u6570\u4e2d\u58f0\u660e`@ParameterObject`<br/>\\n\\n```yaml title=\\"application.yml\\"\\nspringdoc:\\n  model-converters:\\n    pageable-converter:\\n      enabled: true\\n```\\n\\n\u5bf9\u4e8e\u5df2\u7ecf\u5b58\u5728\u7684\u9879\u76ee, \u5f53\u521a\u5f15\u5165`springdoc`\u65f6, \u9700\u8981\u914d\u7f6e\u5927\u91cf\u7684`@ParameterObject`\u6ce8\u89e3\u4ee5\u5b9e\u73b0\u53c2\u6570\u8f6c\u6362\u529f\u80fd.<br/>\\n\u8fd9\u4e2a\u8fc7\u7a0b\u901a\u5e38\u6bd4\u8f83\u7e41\u7410, \u56e0\u4e3a\u5bf9\u4e8e\u4e00\u4e2a\u5177\u6709\u4e00\u5b9a\u89c4\u6a21\u7684\u9879\u76ee\u800c\u8a00, \u5176\u5bf9\u5916\u63d0\u4f9b\u7684`API`\u5f80\u5f80\u4f1a\u975e\u5e38\u591a,\\n\u9700\u8981\u8fdb\u884c\u5927\u91cf\u7684\u4fee\u6539\u529f\u80fd\u624d\u80fd\u5b9e\u73b0\u8be5\u529f\u80fd<br/>\\n\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u9700\u8981\u4e00\u79cd\u89e3\u51b3\u65b9\u6848, \u5373\u5982\u4f55\u5728\u4e0d\u914d\u7f6e`@ParameterObject`\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0`Pageable`\u4ee5\u53ca`Sort`\u5bf9\u8c61\u5230API\u53c2\u6570\u7684\u8f6c\u6362\\n\\n\x3c!--truncate--\x3e\\n\\n## \u601d\u8def\\n\\n### @ParameterObject\\n\\n\u5728`springdoc`\u4e2d, `@ParameterObject`\u6ce8\u89e3\u7684\u83b7\u53d6\u662f\u6765\u81ea\u4e8e`spring-webmvc`\u4e2d\u7684`HandlerMethod`\u5bf9\u8c61\\n\\n### HandlerMethod\\n\\n\u8fd9\u4e2a\u5bf9\u8c61\u662f\u6211\u4eec\u5728`Controller`\u4e2d\u58f0\u660e\u7684`Handler`\u7684\u62bd\u8c61, \u5b83\u4e3b\u8981\u4fdd\u5b58\u4e86\u6211\u4eec\u58f0\u660e\u7684`Handler`\u7684\u4e00\u4e9b\u5143\u4fe1\u606f. <br/>\\n\u5b83\u7684`MethodParameter[] parameters`\u5c5e\u6027\u5305\u542b\u4e86\u8be5\u65b9\u6cd5\u7684\u6240\u6709\u53c2\u6570\u7684\u4fe1\u606f.<br/>\\n\\n### MethodParameter\\n\\n`MethodParameter`\u5bf9\u8c61\u7684`Annotation[] parameterAnnotations`\u5c5e\u6027\u5305\u542b\u4e86\u8be5\u53c2\u6570\u7684\u6240\u6709\u6ce8\u89e3.<br/>\\n\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u4fee\u6539`Annotation[] parameterAnnotations`\u5c5e\u6027\u4ee5\u5b9e\u73b0\u52a8\u6001\u6dfb\u52a0`@ParameterObject`\u6ce8\u89e3\u7684\u529f\u80fd.<br/>\\n\\n### HandlerMapping\\n\\n\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u4ece`spring`\u5bb9\u5668\u4e2d\u83b7\u53d6\u5230`MethodHandler`, \u56e0\u4e3a\u5176\u662f\u4fdd\u5b58\u5728`HandlerMapping`\u4e2d\u7684, `HandlerMapping`\\n\u53ef\u4ee5\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6\u5230.<br/>\\n\\n### BeanPostProcessor\\n\\n`spring`\u4e2d\u63d0\u4f9b\u4e86`BeanPostProcess`\u673a\u5236, \u4e3b\u8981\u5b9e\u73b0\u4e86\u5bf9`Bean`\u7684\u521b\u5efa\u8fdb\u884c\u62e6\u622a\u5904\u7406.<br/>\\n\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0`BeanPostProcessor`\u6765\u5bf9`HandlerMapping`\u4e2d\u7684`MethodHandler`\u4e2d\u7684`MethodParameter`\u7684`parameterAnnotations`\\n\u8fdb\u884c\u4fee\u6539\u4ee5\u5b9e\u73b0\u8ffd\u52a0`@ParameterObject`\u6ce8\u89e3\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u65b0\u589e`AppendSpringdocAnnotationBeanPostProcessor`\u7528\u4e8e\u5b9e\u73b0\u589e\u52a0`@ParameterObject`\u6ce8\u89e3\u7684\u80fd\u529b\\n\\n```kotlin title=\\"AppendSpringdocAnnotationBeanPostProcessor.kt\\"\\n/**\\n * We must add @ParameterObject annotation to Pageable and Sort parameter to ensure that springdoc can generate correct.\\n * But declaring @ParameterObject in the controller method is not a good idea, because it will take some time to.\\n * So we can use this class to avoid declaring @ParameterObject on method parameter which type is Pageable or Sort.\\n *\\n * @author Xiangcheng.Kuo\\n * @see org.springdoc.core.annotations.ParameterObject\\n * @see <a href=\\"https://springdoc.org/v2/#how-can-i-map-pageable-spring-data-commons-object-to-correct-url-parameter-in-swagger-ui\\">13.22. How can I map Pageable (spring-data-commons) object to correct URL-Parameter in Swagger UI?</a>\\n */\\ninternal class AppendSpringdocAnnotationBeanPostProcessor : BeanPostProcessor {\\n\\n\\toverride fun postProcessAfterInitialization(bean: Any, beanName: String): Any {\\n\\t\\tif (bean !is AbstractHandlerMethodMapping<*>) {\\n\\t\\t\\treturn bean\\n\\t\\t}\\n\\t\\tbean.handlerMethods?.forEach { (_: Any, handlerMethod: HandlerMethod) ->\\n\\t\\t\\thandlerMethod\\n\\t\\t\\t\\t.methodParameters\\n\\t\\t\\t\\t.filter {\\n\\t\\t\\t\\t\\tPageable::class.java.isAssignableFrom(it.parameterType) || Sort::class.java.isAssignableFrom(it.parameterType)\\n\\t\\t\\t\\t}.forEach { methodParameter: MethodParameter ->\\n\\t\\t\\t\\t\\taddAnnotationForParameter(methodParameter)\\n\\t\\t\\t\\t}\\n\\t\\t}\\n\\t\\treturn bean\\n\\t}\\n\\n\\tprivate fun addAnnotationForParameter(methodParameter: MethodParameter) {\\n\\t\\tval parameterAnnotationsField =\\n\\t\\t\\tFieldUtils.getDeclaredField(MethodParameter::class.java, \\"parameterAnnotations\\", true)\\n\\t\\tval annotations: MutableList<Annotation> =\\n\\t\\t\\t((parameterAnnotationsField[methodParameter] as Array<Annotation>?)\\n\\t\\t\\t\\t?: emptyArray<Annotation>()).toMutableList()\\n\\n\\t\\tif (annotations.stream().anyMatch(ParameterObject::class::isInstance)) {\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tannotations.add(FakeParameterObject.create())\\n\\t\\tparameterAnnotationsField[methodParameter] = annotations.toTypedArray()\\n\\t}\\n\\n}\\n```\\n\\n### \u65b0\u589e`@ParameterObject`\u7684\u5b9e\u73b0\u7c7b, \u7531\u4e8e`kotlin`\u4e0d\u652f\u6301\u7ee7\u627f`annotation`, \u9700\u8981\u65b0\u5efa`java`\u7c7b\u6765\u7ee7\u627f`annotation`\\n\\n```java title=\\"FakeParameterObject.java\\"\\n/**\\n * Avoid the following kotlin compile error\\n * This type has a constructor, and thus must be initialized here\\n * This type is final, so it cannot be inherited from\\n *\\n * @author Xiangcheng.Kuo\\n * @see <a href=\\"https://stackoverflow.com/questions/51608924/implement-inherit-extend-annotation-in-kotlin\\">Implement (/inherit/~extend) annotation in Kotlin</a>\\n */\\npublic class FakeParameterObject implements ParameterObject {\\n\\n\\t@Override\\n\\tpublic Class<? extends Annotation> annotationType() {\\n\\t\\treturn FakeParameterObject.class;\\n\\t}\\n\\n\\tpublic static ParameterObject create() {\\n\\t\\treturn new FakeParameterObject();\\n\\t}\\n\\n}\\n```\\n\\n### \u65b0\u589eConfiguration, \u5c06`AppendSpringdocAnnotationBeanPostProcessor`\u6dfb\u52a0\u5230\u5bb9\u5668\u4e2d\\n\\n```kotlin title=\\"ApidocAutoConfiguration.kt\\"\\n/**\\n * @author Xiangcheng.Kuo\\n */\\n@Configuration\\ninternal class ApidocAutoConfiguration {\\n\\n\\t@Bean\\n\\t@ConditionalOnProperty(Constants.SPRINGDOC_ENABLED, matchIfMissing = true)\\n\\tfun appendSpringdocAnnotationBeanPostProcessor(): BeanPostProcessor =\\n\\t\\tAppendSpringdocAnnotationBeanPostProcessor()\\n\\n}\\n```\\n\\n## \u5907\u6ce8\\n\\n### \u53cd\u5c04\\n\\n\u8be5\u89e3\u51b3\u65b9\u6cd5\u662f\u57fa\u4e8e\u53cd\u5c04\u7684, \u5e76\u4e14\u5728`spring`\u7684`BeanPostProcessor`\u4e2d\u4fee\u6539\u4e86`MethodParameter`\u7684`parameterAnnotations`\u5c5e\u6027.\\n\u8be5\u5c5e\u6027\u53ef\u80fd\u4f1a\u5728`spring`\u7684\u5176\u4ed6\u5730\u65b9\u88ab\u4f7f\u7528, \u56e0\u6b64\u53ef\u80fd\u4f1a\u5f15\u8d77\u4e00\u4e9b\u4e0d\u53ef\u9884\u77e5\u7684\u95ee\u9898.\\n\\n### `springdoc`\u5e94\u8be5\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5173\u95ed\\n\\n\u5728\u751f\u4ea7\u73af\u5883\u4e2d, \u4e0d\u5e94\u8be5\u5f00\u542f`springdoc`, \u56e0\u4e3a\u8fd9\u4f1a\u66b4\u9732`swagger`\u7684`api`\u6587\u6863, \u4ece\u800c\u5bfc\u81f4`api`\u6587\u6863\u6cc4\u9732,\\n\\n\u4f7f\u7528`spring`\u4e2d\u63d0\u4f9b\u7684`profile`\u529f\u80fd\u4ee5\u5b9e\u73b0\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\u5f00\u542f`springdoc`, \u751f\u4ea7\u6a21\u5f0f\u4e0b\u5173\u95ed`springdoc`\\n\\n```yaml title=\\"application.yml\\"\\nspringdoc:\\n  api-docs:\\n    enabled: false\\n  model-converters:\\n    pageable-converter:\\n      enabled: true\\n```\\n\\n```yaml title=\\"application-dev.yml\\"\\nspringdoc:\\n  api-docs:\\n    enabled: true\\n  model-converters:\\n    pageable-converter:\\n      enabled: true\\n```\\n\\n## \u53c2\u8003\\n\\n### springdoc-v2\\n\\n- [springdoc v2](https://springdoc.org/v2/)\\n- [13.22. How can I map Pageable (spring-data-commons) object to correct URL-Parameter in Swagger UI?](https://springdoc.org/v2/#how-can-i-map-pageable-spring-data-commons-object-to-correct-url-parameter-in-swagger-ui)\\n- [13.61. How can I extract fields from parameter object ?](https://springdoc.org/v2/#how-can-i-extract-fields-from-parameter-object)\\n\\n### spring\\n\\n- [Class HandlerMethod](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/method/HandlerMethod.html)\\n- [Class MethodParameter](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/MethodParameter.html)\\n- [Interface HandlerMapping](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/HandlerMapping.html)\\n- [Interface BeanPostProcessor](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/config/BeanPostProcessor.html)\\n\\n### kotlin\\n\\n- [Implement (/inherit/~extend) annotation in Kotlin](https://stackoverflow.com/questions/51608924/implement-inherit-extend-annotation-in-kotlin)"},{"id":"/2023/02/21/","metadata":{"permalink":"/markdowns/blog/2023/02/21/","source":"@site/blog/2023-02-21.md","title":"\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6ce8\u5165\u6570\u7ec4\u5230\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e","description":"\u5bb9\u5668\u542f\u52a8\u65f6, \u9700\u8981\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6ce8\u5165\u914d\u7f6e\u7ed9\u5e94\u7528\u7a0b\u5e8f.","date":"2023-02-21T00:00:00.000Z","formattedDate":"February 21, 2023","tags":[{"label":"spring","permalink":"/markdowns/blog/tags/spring"}],"readingTime":0.65,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["spring"]},"prevItem":{"title":"springdoc-v2\u4e2d\u5728\u4e0d\u914d\u7f6e@ParameterObject\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0Pageable\u4ee5\u53caSort\u5bf9\u8c61\u5230API\u53c2\u6570\u7684\u8f6c\u6362","permalink":"/markdowns/blog/2023/02/22/"},"nextItem":{"title":"\u6e05\u7406\u65e7\u7248\u672c\u7684snap\u5e94\u7528\u4ee5\u91ca\u653e\u7a7a\u95f4","permalink":"/markdowns/blog/2023/02/20/"}},"content":"\u5bb9\u5668\u542f\u52a8\u65f6, \u9700\u8981\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6ce8\u5165\u914d\u7f6e\u7ed9\u5e94\u7528\u7a0b\u5e8f.<br/>\\n\u4ee5`spring.ldap.urls`\u6b64\u914d\u7f6e\u4e3a\u4f8b, \u5b83\u662f\u4e00\u4e2a\u6570\u7ec4.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n\u6709\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u6b64\u9700\u8981, \u9009\u5176\u4e2d\u4e00\u4e2a\u5373\u53ef.<br/>\\n\u63a8\u8350\u7b2c\u4e8c\u79cd, \u56e0\u4e3a\u4e0b\u6807\u7684\u914d\u7f6e\u65b9\u5f0f\u5bf9\u4e8e\u5217\u8868\u7684\u6570\u91cf\u662f\u975e\u56fa\u5b9a\u7684\u573a\u666f\u662f\u4e0d\u591f\u7075\u6d3b\u7684\\n\\n**\u65b9\u5f0f1: \u4e0b\u6807\u914d\u7f6e**\\n```bash\\nSPRING_LDAP_URLS[0]=ldap://host-1:389\\nSPRING_LDAP_URLS[1]=ldap://host-2:389\\n```\\n\\n**\u65b9\u5f0f2: \u65e0\u4e0b\u6807\u914d\u7f6e**\\n```bash\\nSPRING_LDAP_URLS=ldap://host-1:389,ldap://host-2:389\\n```\\n\\n## \u53c2\u8003\\n\\n- [Inject Arrays and Lists From Spring Properties Files](https://www.baeldung.com/spring-inject-arrays-lists#reading-properties-programmatically)"},{"id":"/2023/02/20/","metadata":{"permalink":"/markdowns/blog/2023/02/20/","source":"@site/blog/2023-02-20.md","title":"\u6e05\u7406\u65e7\u7248\u672c\u7684snap\u5e94\u7528\u4ee5\u91ca\u653e\u7a7a\u95f4","description":"snap\u9ed8\u8ba4\u4f1a\u4fdd\u7559\u65e7\u7248\u672c\u7684\u5e94\u7528, \u4f46\u662f\u8fd9\u4e9b\u65e7\u7248\u672c\u7684\u5e94\u7528\u5360\u7528\u4e86\u5927\u91cf\u7684\u7a7a\u95f4, \u6240\u4ee5\u6211\u4eec\u9700\u8981\u6e05\u7406\u65e7\u7248\u672c\u7684\u5e94\u7528, \u4ee5\u91ca\u653e\u7a7a\u95f4.","date":"2023-02-20T00:00:00.000Z","formattedDate":"February 20, 2023","tags":[{"label":"snap","permalink":"/markdowns/blog/tags/snap"}],"readingTime":0.645,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["snap"]},"prevItem":{"title":"\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6ce8\u5165\u6570\u7ec4\u5230\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e","permalink":"/markdowns/blog/2023/02/21/"},"nextItem":{"title":"\u901a\u8fc7\u4e3aaws-eks\u6258\u7ba1\u7684k8s\u4e2d\u7684service\u542f\u7528nlb\u4ee5\u5b9e\u73b0\u5bf9\u5916\u66b4\u9732\u670d\u52a1","permalink":"/markdowns/blog/2023/02/19/"}},"content":"`snap`\u9ed8\u8ba4\u4f1a\u4fdd\u7559\u65e7\u7248\u672c\u7684\u5e94\u7528, \u4f46\u662f\u8fd9\u4e9b\u65e7\u7248\u672c\u7684\u5e94\u7528\u5360\u7528\u4e86\u5927\u91cf\u7684\u7a7a\u95f4, \u6240\u4ee5\u6211\u4eec\u9700\u8981\u6e05\u7406\u65e7\u7248\u672c\u7684\u5e94\u7528, \u4ee5\u91ca\u653e\u7a7a\u95f4.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n\u65b0\u589e\u811a\u672c\u7528\u4e8e\u6e05\u7406\u65e7\u7248\u672c\u7684`snap`\u5e94\u7528.\\n\\n```bash title=\\"cleanup-old-snaps.sh\\"\\n#!/bin/bash\\n\\nset -eu\\n\\necho \\"Old versions of snaps will be removed.\\"\\n\\nsudo rm -rf /var/lib/snapd/cache/*\\nsnap list --all | awk \'/disabled/{print $1, $3}\' | while read -r package revision; do\\n  snap remove \\"$package\\" --revision=\\"$revision\\"\\ndone\\n\\necho \\"Old revisions of snaps are removed.\\"\\n\\n```\\n\\n## \u53c2\u8003\\n\\n- [How To Remove Old Snap Versions To Free Up Disk Space](https://www.linuxuprising.com/2019/04/how-to-remove-old-snap-versions-to-free.html)"},{"id":"/2023/02/19/","metadata":{"permalink":"/markdowns/blog/2023/02/19/","source":"@site/blog/2023-02-19.md","title":"\u901a\u8fc7\u4e3aaws-eks\u6258\u7ba1\u7684k8s\u4e2d\u7684service\u542f\u7528nlb\u4ee5\u5b9e\u73b0\u5bf9\u5916\u66b4\u9732\u670d\u52a1","description":"\u9ed8\u8ba4\u60c5\u51b5\u4e0bk8s\u4e2d\u7684Service\u4e3aClusterIP\u7c7b\u578b, \u5373\u53ea\u80fd\u5728\u96c6\u7fa4\u5185\u90e8\u8bbf\u95ee, \u65e0\u6cd5\u901a\u8fc7\u5916\u90e8\u8bbf\u95ee(\u8fd9\u91cc\u7684\u5916\u90e8\u6307\u7684\u662fk8s\u96c6\u7fa4\u5916\u90e8,","date":"2023-02-19T00:00:00.000Z","formattedDate":"February 19, 2023","tags":[{"label":"k8s","permalink":"/markdowns/blog/tags/k-8-s"},{"label":"aws","permalink":"/markdowns/blog/tags/aws"}],"readingTime":1.135,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["k8s","aws"]},"prevItem":{"title":"\u6e05\u7406\u65e7\u7248\u672c\u7684snap\u5e94\u7528\u4ee5\u91ca\u653e\u7a7a\u95f4","permalink":"/markdowns/blog/2023/02/20/"},"nextItem":{"title":"\u4f7f\u7528aliyundrive-webdav\u642d\u914drclone\u5b9e\u73b0\u4ee5\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u7684\u65b9\u5f0f\u64cd\u4f5c\u963f\u91cc\u4e91\u76d8\u4e2d\u7684\u6587\u4ef6","permalink":"/markdowns/blog/2023/02/18/"}},"content":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b`k8s`\u4e2d\u7684`Service`\u4e3a`ClusterIP`\u7c7b\u578b, \u5373\u53ea\u80fd\u5728\u96c6\u7fa4\u5185\u90e8\u8bbf\u95ee, \u65e0\u6cd5\u901a\u8fc7\u5916\u90e8\u8bbf\u95ee(\u8fd9\u91cc\u7684\u5916\u90e8\u6307\u7684\u662f`k8s`\u96c6\u7fa4\u5916\u90e8,\\n\u5373`k8s`\u96c6\u7fa4\u6240\u5728\u7684`VPC`\u5916\u90e8).<br/>\\n`NodeProt`\u4e5f\u5b58\u5728\u540c\u6837\u7684\u95ee\u9898, \u65e0\u6cd5\u901a\u8fc7\u5916\u90e8\u8bbf\u95ee.<br/>\\n\u4e3a\u4e86\u80fd\u591f\u901a\u8fc7\u5916\u90e8\u8bbf\u95ee`k8s`\u4e2d\u7684`service`, \u9700\u8981\u542f\u7528`nlb`\u4ee5\u5b9e\u73b0\u4e3a`aws-eks`\u6258\u7ba1\u7684`k8s`\u4e2d\u7684`service`\u542f\u7528\u5916\u90e8\u8bbf\u95ee\u80fd\u529b.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u524d\u63d0\\n\\n`kubernetes`\u4e0a\u5b58\u5728`aws-load-balancer-controller`, \u5426\u5219\u8be5\u529f\u80fd\u65e0\u6cd5\u4f7f\u7528\\n\\n### \u66f4\u65b0`Service`, \u8ffd\u52a0`annotations`\u4ee5\u53ca\u4fee\u6539`type`\u4e3a`LoadBalancer`\\n\\n```yaml\\napiVersion: v1\\nkind: Service\\nmetadata:\\n  annotations:\\n    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: ip\\n    service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing\\n    service.beta.kubernetes.io/aws-load-balancer-type: external\\nspec:\\n  type: LoadBalancer\\n```\\n\\n\u7a0d\u7b49\u7247\u523b\u540e\u901a\u8fc7`kubectl get svc`\u67e5\u770b`service`\u7684`status`\u4fe1\u606f, \u53ef\u4ee5\u770b\u5230`status`\u4e2d\u7684`loadBalancer`\u4fe1\u606f\u4e2d\u5305\u542b\u4e86`hostname`\u4fe1\u606f.\\n\u901a\u8fc7`hostname`\u5373\u53ef\u8bbf\u95ee`service`.\\n\\n## \u53c2\u8003\\n\\n- [Installing the AWS Load Balancer Controller add-on](https://docs.aws.amazon.com/eks/latest/userguide/aws-load-balancer-controller.html)\\n- [Network load balancing on Amazon EKS](https://docs.aws.amazon.com/eks/latest/userguide/network-load-balancing.html)\\n- [Network Load Balancer](https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/guide/service/nlb/)"},{"id":"/2023/02/18/","metadata":{"permalink":"/markdowns/blog/2023/02/18/","source":"@site/blog/2023-02-18.md","title":"\u4f7f\u7528aliyundrive-webdav\u642d\u914drclone\u5b9e\u73b0\u4ee5\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u7684\u65b9\u5f0f\u64cd\u4f5c\u963f\u91cc\u4e91\u76d8\u4e2d\u7684\u6587\u4ef6","description":"aliyun-webdav\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5de5\u5177, \u53ef\u4ee5\u6839\u636e\u914d\u7f6e\u7684\u963f\u91cc\u4e91\u76d8\u5e10\u53f7\u4fe1\u606f\u5bf9\u5916\u63d0\u4f9bWebDAV\u670d\u52a1.","date":"2023-02-18T00:00:00.000Z","formattedDate":"February 18, 2023","tags":[{"label":"aliyundrive","permalink":"/markdowns/blog/tags/aliyundrive"},{"label":"rclone","permalink":"/markdowns/blog/tags/rclone"},{"label":"docker","permalink":"/markdowns/blog/tags/docker"}],"readingTime":2.445,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["aliyundrive","rclone","docker"]},"prevItem":{"title":"\u901a\u8fc7\u4e3aaws-eks\u6258\u7ba1\u7684k8s\u4e2d\u7684service\u542f\u7528nlb\u4ee5\u5b9e\u73b0\u5bf9\u5916\u66b4\u9732\u670d\u52a1","permalink":"/markdowns/blog/2023/02/19/"},"nextItem":{"title":"\u4f7f\u7528snap\u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684\u5e94\u7528","permalink":"/markdowns/blog/2023/02/17/"}},"content":"`aliyun-webdav`\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5de5\u5177, \u53ef\u4ee5\u6839\u636e\u914d\u7f6e\u7684\u963f\u91cc\u4e91\u76d8\u5e10\u53f7\u4fe1\u606f\u5bf9\u5916\u63d0\u4f9b`WebDAV`\u670d\u52a1.<br/>\\n`rclone`\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5de5\u5177, \u53ef\u4ee5\u5c06\u5404\u79cd\u7f51\u7edc\u6587\u4ef6\u534f\u8bae\u7684\u6587\u4ef6\u6302\u8f7d\u5230\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u5e76\u901a\u8fc7\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u7684\u65b9\u5f0f\u8fdb\u884c\u6587\u4ef6\u7684\u64cd\u4f5c.<br/>\\n\u5176\u652f\u6301\u7684\u7f51\u7edc\u6587\u4ef6\u534f\u8bae\u5982\u4e0b\\n\\n- S3\\n- WebDAV\\n- FTP\\n- SFTP\\n- ...\\n\\n\u4ee5\u4e0b\u5c06\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528`aliyun-webdav`\u642d\u914d`rclone`\u5b9e\u73b0\u672c\u5730\u6587\u4ef6\u540c\u6b65\u5230\u963f\u91cc\u4e91\u76d8.\\n\u672c\u6848\u4f8b\u662f\u57fa\u4e8e`ubuntu`\u5b9e\u73b0\u7684, \u7531\u4e8e\u8be5\u89e3\u51b3\u65b9\u6848\u4f7f\u7528\u4e86`docker`, \u56e0\u6b64\u7406\u8bba\u4e0a\u53ef\u4ee5\u5728\u4efb\u4f55\u652f\u6301`docker`\u7684\u7cfb\u7edf\u4e2d\u5b9e\u73b0.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u8981\u6c42\\n\\n\u7cfb\u7edf\u4e2d\u5fc5\u987b\u5b58\u5728\u4ee5\u4e0b\u5de5\u5177\\n\\n- docker\\n- docker-compose\\n\\n\u53e6\u5916\u786e\u4fdd\u5f53\u524d\u7528\u6237\u6709`docker`\u6743\u9650, \u5982\u679c\u6ca1\u6709, \u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u6dfb\u52a0\\n\\n```bash\\nsudo usermod -aG docker $USER\\nsudo newgrp docker\\n```\\n\\n### \u83b7\u53d6\u963f\u91cc\u4e91\u76d8\u4e2d\u7684`refresh_token`\\n\\n- \u767b\u5f55[\u963f\u91cc\u4e91\u76d8](https://www.aliyundrive.com/drive)\\n- \u6253\u5f00\u6d4f\u89c8\u5668\u7684`\u5f00\u53d1\u8005\u5de5\u5177`(`F12`\u5feb\u6377\u952e), \u5207\u6362\u5230`Console`\u9009\u9879\u5361, \u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4, \u5e76\u6309\u4e0b\u56de\u8f66\\n\\n```js\\nJSON.parse(localStorage.token).refresh_token\\n```\\n\\n- \u590d\u5236\u8f93\u51fa\u7684`refresh_token`\u503c, \u4f5c\u4e3a\u540e\u7eed\u914d\u7f6e, \u6ce8\u610f\u4e0d\u8981\u5305\u542b\u5f15\u53f7\\n\\n### \u65b0\u589e`docker-compose.yml`\u6587\u4ef6\\n\\n\u4ee5\u4e0b\u5185\u5bb9\u4f5c\u4e3a\u53c2\u8003\u5e76\u586b\u5165\u9700\u8981\u7684\u914d\u7f6e\\n\\n- `<\u586b\u5199\u4e0a\u4e00\u4e2a\u6b65\u9aa4\u83b7\u53d6\u5230\u7684refresh_token>`\\n\\n```yaml title=\\"docker-compose.yml\\"\\nversion: \\"2\\"\\nservices:\\n  aliyundrive:\\n    image: messense/aliyundrive-webdav:1.11.0\\n    container_name: aliyundrive\\n    hostname: aliyundrive\\n    ports:\\n      - \\"8080:8080\\"\\n    restart: always\\n    environment:\\n      REFRESH_TOKEN: <\u586b\u5199\u4e0a\u4e00\u4e2a\u6b65\u9aa4\u83b7\u53d6\u5230\u7684refresh_token>\\n\\n  rclone:\\n    restart: always\\n    image: rclone/rclone\\n    container_name: rclone\\n    hostname: rclone\\n    user: \\"1000:1000\\"\\n    volumes:\\n      - \\"./rclone.conf:/config/rclone/rclone.conf\\"\\n      - \\"./Aliyundrive:/Aliyundrive:rshared\\"\\n      - \\"/etc/passwd:/etc/passwd:ro\\"\\n      - \\"/etc/group:/etc/group:ro\\"\\n    devices:\\n      - \\"/dev/fuse:/dev/fuse\\"\\n    cap_add:\\n      - SYS_ADMIN\\n    security_opt:\\n      - \\"apparmor:unconfined\\"\\n    command:\\n      - \\"mount\\"\\n      - \\"--dir-cache-time=1h\\"\\n      - \\"--buffer-size=64M\\"\\n      - \\"--vfs-cache-mode=full\\"\\n      - \\"--transfers=16\\"\\n      - \\"--allow-non-empty\\"\\n      - \\"--no-update-modtime\\"\\n      - \\"aliyundrive:\\"\\n      - \\"/Aliyundrive\\"\\n\\nnetworks:\\n  network:\\n    driver: bridge\\n    ipam:\\n      driver: default\\n```\\n\\n### \u65b0\u589e`rclone.conf`\u6587\u4ef6\\n\\n```ini title=\\"rclone.conf\\"\\n[aliyundrive]\\ntype = webdav\\nurl = http://aliyundrive:8080\\nvendor = nextcloud\\n```\\n\\n### \u65b0\u589e\u811a\u672c`start.sh`, `stop.sh`\\n\\n```bash title=\\"start.sh\\"\\nmkdir -p ./Aliyundrive\\ndocker-compose up -d\\n```\\n\\n```bash title=\\"stop.sh\\"\\numount ./Aliyundrive\\ndocker-compose kill\\ndocker-compose rm -f\\n```\\n\\n## \u53c2\u8003\\n\\n- [aliyundrive-webdav](https://github.com/messense/aliyundrive-webdav)\\n- [rclone](https://rclone.org/)\\n- [docker](https://www.docker.com/)\\n- [docker-compose](https://docs.docker.com/compose/)\\n- [\u963f\u91cc\u4e91\u76d8](https://www.aliyundrive.com/drive)"},{"id":"/2023/02/17/","metadata":{"permalink":"/markdowns/blog/2023/02/17/","source":"@site/blog/2023-02-17.md","title":"\u4f7f\u7528snap\u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684\u5e94\u7528","description":"\u5728\u4f7f\u7528snap\u5b89\u88c5\u5e94\u7528\u65f6\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7248\u672c\uff0c\u4f1a\u9ed8\u8ba4\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684\u5e94\u7528.","date":"2023-02-17T00:00:00.000Z","formattedDate":"February 17, 2023","tags":[{"label":"snap","permalink":"/markdowns/blog/tags/snap"}],"readingTime":1.02,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["snap"]},"prevItem":{"title":"\u4f7f\u7528aliyundrive-webdav\u642d\u914drclone\u5b9e\u73b0\u4ee5\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u7684\u65b9\u5f0f\u64cd\u4f5c\u963f\u91cc\u4e91\u76d8\u4e2d\u7684\u6587\u4ef6","permalink":"/markdowns/blog/2023/02/18/"},"nextItem":{"title":"\u5728linux\u4e2d\u901a\u8fc7\u542f\u7528swapfile\u6765\u589e\u52a0\u865a\u62df\u5185\u5b58\u5e76\u63d0\u9ad8\u6027\u80fd","permalink":"/markdowns/blog/2023/02/16/"}},"content":"\u5728\u4f7f\u7528`snap`\u5b89\u88c5\u5e94\u7528\u65f6\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7248\u672c\uff0c\u4f1a\u9ed8\u8ba4\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684\u5e94\u7528.<br/>\\n\u6709\u4e9b\u573a\u666f\u4e0b\u9700\u8981\u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684\u5e94\u7528<br/>\\n\u4f8b\u5982`UI`\u9879\u76ee\u76ee\u524d\u4ec5\u652f\u6301`nodejs`\u7684`v12`\u7248\u672c, \u90a3\u4e48\u5c31\u4e0d\u80fd\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684`nodejs`<br/>\\n\u8fd9\u4e2a\u4f8b\u5b50\u4ec5\u4f5c\u4e3a\u53c2\u8003, \u56e0\u4e3a\u66f4\u597d\u7684\u89e3\u51b3\u65b9\u6848\u662f\u4f7f\u7528`nvm`\u6765\u7ba1\u7406`nodejs`\u7684\u7248\u672c<br/>\\n\u5728`python`\u4e2d,\u53ef\u4ee5\u4f7f\u7528`pyenv virtualenv`\u6765\u7ba1\u7406python\u7684\u7248\u672c<br/>\\n\u4e0b\u9762\u5c06\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528`snap`\u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684\u5e94\u7528\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n\u901a\u8fc7`snap`\u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684\u5e94\u7528, \u9700\u8981\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\\n\\n```bash\\nsnap install <app> --channel=<channel>\\n```\\n\\n\u4ee5nodejs\u4e3a\u4f8b, \u5b89\u88c5`v12`\u7248\u672c\u7684\u5e94\u7528, \u9700\u8981\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\\n\\n```bash\\nsnap install node --channel=12/stable\\n```\\n\\n## \u53c2\u8003\\n\\n- [man snap](https://manpages.org/snap)"},{"id":"/2023/02/16/","metadata":{"permalink":"/markdowns/blog/2023/02/16/","source":"@site/blog/2023-02-16.md","title":"\u5728linux\u4e2d\u901a\u8fc7\u542f\u7528swapfile\u6765\u589e\u52a0\u865a\u62df\u5185\u5b58\u5e76\u63d0\u9ad8\u6027\u80fd","description":"swapfile\u662flinux\u4e2d\u7684\u4e00\u79cd\u865a\u62df\u5185\u5b58, \u4e0ewindows\u4e2d\u7684pagefile\u7c7b\u4f3c.","date":"2023-02-16T00:00:00.000Z","formattedDate":"February 16, 2023","tags":[{"label":"linux","permalink":"/markdowns/blog/tags/linux"}],"readingTime":0.91,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["linux"]},"prevItem":{"title":"\u4f7f\u7528snap\u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684\u5e94\u7528","permalink":"/markdowns/blog/2023/02/17/"},"nextItem":{"title":"\u5728TestContainers\u4e2d\u5b9e\u73b0\u914d\u7f6e\u7684\u5bb9\u5668hostname\u4ee5\u89e3\u51b3\u5bb9\u5668\u4e4b\u95f4\u8bbf\u95ee\u95ee\u9898","permalink":"/markdowns/blog/2023/02/15/"}},"content":"`swapfile`\u662f`linux`\u4e2d\u7684\u4e00\u79cd\u865a\u62df\u5185\u5b58, \u4e0e`windows`\u4e2d\u7684`pagefile`\u7c7b\u4f3c.<br/>\\n`swapfile`\u7684\u4f5c\u7528\u662f\u5f53`RAM`\u4e0d\u8db3\u65f6, \u5c06\u4e00\u90e8\u5206`RAM`\u4e2d\u7684\u6570\u636e\u5199\u5165\u5230`swapfile`\u4e2d, \u4ece\u800c\u91ca\u653e\u51fa`RAM`\u7684\u7a7a\u95f4.<br/>\\n\u4f8b\u5982, \u5e73\u65f6\u4f7f\u7528\u6d4f\u89c8\u5668\u65f6\u4f1a\u5f00\u542f\u9875\u9762, \u8fd9\u4e9b\u9875\u9762\u901a\u5e38\u4f1a\u5360\u7528\u4e00\u5b9a\u7684`RAM`\u7a7a\u95f4.<br/>\\n\u5982\u679c\u5f00\u542f\u4e86\u592a\u591a\u7684\u9875\u9762, \u4f1a\u5bfc\u81f4`RAM`\u4e0d\u8db3, \u8fd9\u65f6\u5c31\u9700\u8981\u5c06\u4e00\u90e8\u5206\u9875\u9762\u7684\u6570\u636e\u5199\u5165\u5230`swapfile`\u4e2d, \u4ece\u800c\u91ca\u653e\u51fa`RAM`\u7684\u7a7a\u95f4<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u542f\u7528`swapfile`, \u5927\u5c0f\u4e3a`4G`\\n\\n```bash\\nsudo fallocate -l 4G /swapfile\\nsudo chmod 600 /swapfile\\nsudo mkswap /swapfile\\nsudo swapon /swapfile\\nsudo swapon --show\\nsudo free -h\\n```\\n\\n### \u7981\u7528`swapfile`\\n\\n```bash\\nsudo swapoff /swapfile\\n```\\n\\n## \u53c2\u8003\\n\\n- [Create a Linux Swap File](https://linuxize.com/post/create-a-linux-swap-file/)"},{"id":"/2023/02/15/","metadata":{"permalink":"/markdowns/blog/2023/02/15/","source":"@site/blog/2023-02-15.md","title":"\u5728TestContainers\u4e2d\u5b9e\u73b0\u914d\u7f6e\u7684\u5bb9\u5668hostname\u4ee5\u89e3\u51b3\u5bb9\u5668\u4e4b\u95f4\u8bbf\u95ee\u95ee\u9898","description":"\u5728\u4f7f\u7528TestContainers\u542f\u52a8\u5bb9\u5668\u65f6, \u53ef\u80fd\u4f1a\u5b58\u5728\u5bb9\u5668\u4e4b\u95f4\u4f9d\u8d56\u7684\u60c5\u51b5.","date":"2023-02-15T00:00:00.000Z","formattedDate":"February 15, 2023","tags":[{"label":"testcontainers","permalink":"/markdowns/blog/tags/testcontainers"},{"label":"docker","permalink":"/markdowns/blog/tags/docker"}],"readingTime":1.265,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["testcontainers","docker"]},"prevItem":{"title":"\u5728linux\u4e2d\u901a\u8fc7\u542f\u7528swapfile\u6765\u589e\u52a0\u865a\u62df\u5185\u5b58\u5e76\u63d0\u9ad8\u6027\u80fd","permalink":"/markdowns/blog/2023/02/16/"},"nextItem":{"title":"\u8df3\u8fc7SSH\u8fde\u63a5\u65f6\u7684\u786e\u8ba4\u63d0\u793a","permalink":"/markdowns/blog/2023/02/14/"}},"content":"\u5728\u4f7f\u7528`TestContainers`\u542f\u52a8\u5bb9\u5668\u65f6, \u53ef\u80fd\u4f1a\u5b58\u5728\u5bb9\u5668\u4e4b\u95f4\u4f9d\u8d56\u7684\u60c5\u51b5.<br/>\\n\u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u5bb9\u5668\u4f9d\u8d56\u4e8e\u53e6\u5916\u4e00\u4e2a\u5bb9\u5668, \u90a3\u4e48\u9700\u8981\u5728\u542f\u52a8\u88ab\u4f9d\u8d56\u7684\u5bb9\u5668\u65f6, \u6307\u5b9a`hostname`.<br/>\\n\u8fd9\u6837\u6709\u4f9d\u8d56\u9700\u6c42\u7684\u5bb9\u5668\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7`hostname`\u6765\u8bbf\u95ee\u88ab\u4f9d\u8d56\u7684\u5bb9\u5668.<br/>\\n\u4ee5\u4fbf\u4e8e\u88ab\u4f9d\u8d56\u7684\u5bb9\u5668\u80fd\u591f\u6b63\u786e\u7684\u89e3\u6790\u4f9d\u8d56\u5bb9\u5668\u7684`hostname`.\\n\u4e0b\u9762\u5c06\u4ecb\u7ecd\u5982\u4f55\u5728`TestContainers`\u4e2d\u5b9e\u73b0\u914d\u7f6e\u7684\u5bb9\u5668`hostname`\u4ee5\u89e3\u51b3\u5bb9\u5668\u4e4b\u95f4\u8bbf\u95ee\u95ee\u9898.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n\u5728\u542f\u52a8\u5bb9\u5668\u65f6, \u901a\u8fc7`withNetworkAliases`\u65b9\u6cd5\u6307\u5b9a\u5bb9\u5668\u7684`hostname`\\n\\n```kotlin\\nwithNetworkAliases(\\"ldap\\")\\n```\\n\\n\u9700\u8981\u6ce8\u610f\u7684\u662f, \u8fd9\u79cd\u5b9e\u73b0\u65b9\u5f0f\u662f\u91c7\u7528`docker`\u7684`--network-alias`\u53c2\u6570\u5b9e\u73b0\u7684, \u8be5\u53c2\u6570\u7684\u4f5c\u7528\u662f\u4e3a\u5bb9\u5668\u6307\u5b9a`hostname`<br/>\\n\u53e6\u5916\u9700\u8981\u786e\u4fdd\u9700\u8981\u4e92\u76f8\u8bbf\u95ee\u7684\u5bb9\u5668\u8981\u5728\u540c\u4e00\u4e2a`network`\u4e2d, \u5426\u5219\u65e0\u6cd5\u4e92\u76f8\u8bbf\u95ee.<br/>\\n\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u4ee3\u7801\u6765\u914d\u7f6e`network`\\n\\n```kotlin\\nval network = Network.newNetwork()\\ncontainer.withNetwork(network)\\n```\\n\\n## \u53c2\u8003\\n\\n- [Network settings](https://docs.docker.com/engine/reference/run/#network-settings)"},{"id":"/2023/02/14/","metadata":{"permalink":"/markdowns/blog/2023/02/14/","source":"@site/blog/2023-02-14.md","title":"\u8df3\u8fc7SSH\u8fde\u63a5\u65f6\u7684\u786e\u8ba4\u63d0\u793a","description":"\u5e73\u65f6\u5728\u5199\u4e00\u4e9b\u811a\u672c\u7684\u65f6\u5019, \u9700\u8981\u9891\u7e41\u5730\u8fde\u63a5\u5728\u4e91\u4e0a\u65b0\u521b\u5efa\u7684\u673a\u5668.","date":"2023-02-14T00:00:00.000Z","formattedDate":"February 14, 2023","tags":[{"label":"ssh","permalink":"/markdowns/blog/tags/ssh"}],"readingTime":1.13,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["ssh"]},"prevItem":{"title":"\u5728TestContainers\u4e2d\u5b9e\u73b0\u914d\u7f6e\u7684\u5bb9\u5668hostname\u4ee5\u89e3\u51b3\u5bb9\u5668\u4e4b\u95f4\u8bbf\u95ee\u95ee\u9898","permalink":"/markdowns/blog/2023/02/15/"},"nextItem":{"title":"\u4fee\u6539postgresql\u4e2d\u7684\u6700\u5927\u8fde\u63a5\u6570","permalink":"/markdowns/blog/2023/02/13/"}},"content":"\u5e73\u65f6\u5728\u5199\u4e00\u4e9b\u811a\u672c\u7684\u65f6\u5019, \u9700\u8981\u9891\u7e41\u5730\u8fde\u63a5\u5728\u4e91\u4e0a\u65b0\u521b\u5efa\u7684\u673a\u5668.<br/>\\n\u5728ssh\u4e2d\u7b2c\u4e00\u6b21\u8fde\u63a5\u65f6, \u4f1a\u8f93\u51fa\u5982\u4e0b\u63d0\u793a.<br/>\\n\\n```log\\nRSA key fingerprint is 96:a9:23:5c:cc:d1:0a:d4:70:22:93:e9:9e:1e:74:2f.\\nAre you sure you want to continue connecting (yes/no)? yes\\n```\\n\\n\u8fd9\u6837\u4f1a\u5bfc\u81f4\u6bcf\u6b21\u90fd\u9700\u8981\u8f93\u5165yes\u6765\u786e\u8ba4\u662f\u5426\u8fde\u63a5.<br/>\\n\u56e0\u4e3a\u811a\u672c\u4e0d\u53ef\u4ee5\u4ea4\u4e92, \u4f1a\u5bfc\u81f4\u811a\u672c\u5361\u5728\u8fd9\u4e00\u6b65\u65e0\u6cd5\u6267\u884c\u540e\u7eed\u7684\u64cd\u4f5c.<br/>\\n\u56e0\u6b64\u9700\u8981\u8df3\u8fc7\u8fd9\u4e00\u6b65\u7684\u786e\u8ba4.<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n\u5728ssh\u8fde\u63a5\u65f6, \u901a\u8fc7`-o StrictHostKeyChecking=no`\u53c2\u6570\u6765\u8df3\u8fc7\u786e\u8ba4.<br/>\\n\\n```bash\\nssh -o StrictHostKeyChecking=no -i <your-key> <username>@<hostname>\\n```\\n\\n## \u5907\u6ce8\\n\\n\u5728`man ssh`\u4e2d\u5bf9\u4e8e`StrictHostKeyChecking`\u53c2\u6570\u7684\u63cf\u8ff0\u5982\u4e0b:\\n\\n```text\\nThe StrictHostKeyChecking option can be used to control logins to machines whose host key is not known or has changed.\\n```\\n\\n## \u53c2\u8003\\n\\n- [how to avoid ssh asking permission?](https://unix.stackexchange.com/questions/33271/how-to-avoid-ssh-asking-permission)\\n- [How to accept \'yes\' from shell script \\"Are you sure you want to continue connecting (yes/no)?\\" using ssh. Without using StrictHostKeyChecking=no](https://stackoverflow.com/questions/64449495/how-to-accept-yes-from-shell-script-are-you-sure-you-want-to-continue-connect)"},{"id":"/2023/02/13/","metadata":{"permalink":"/markdowns/blog/2023/02/13/","source":"@site/blog/2023-02-13.md","title":"\u4fee\u6539postgresql\u4e2d\u7684\u6700\u5927\u8fde\u63a5\u6570","description":"postgresql\u9ed8\u8ba4\u8fde\u63a5\u6570\u91cf\u6709\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e0d\u591f\u7528\u7684\u60c5\u51b5, \u8fd9\u65f6\u5c31\u9700\u8981\u4fee\u6539postgresql\u7684\u6700\u5927\u8fde\u63a5\u6570","date":"2023-02-13T00:00:00.000Z","formattedDate":"February 13, 2023","tags":[{"label":"postgresql","permalink":"/markdowns/blog/tags/postgresql"}],"readingTime":0.51,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["postgresql"]},"prevItem":{"title":"\u8df3\u8fc7SSH\u8fde\u63a5\u65f6\u7684\u786e\u8ba4\u63d0\u793a","permalink":"/markdowns/blog/2023/02/14/"},"nextItem":{"title":"\u5c06postgresql\u4e2d\u6307\u5b9a\u7684database\u5bfc\u51fa\u4e3asql\u6587\u4ef6","permalink":"/markdowns/blog/2023/02/12/"}},"content":"`postgresql`\u9ed8\u8ba4\u8fde\u63a5\u6570\u91cf\u6709\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e0d\u591f\u7528\u7684\u60c5\u51b5, \u8fd9\u65f6\u5c31\u9700\u8981\u4fee\u6539`postgresql`\u7684\u6700\u5927\u8fde\u63a5\u6570\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u901a\u8fc7`ALTER SYSTEM`\u4fee\u6539\\n\\n```bash\\nALTER SYSTEM SET max_connections = 1000;\\n```\\n\\n## \u5907\u6ce8\\n\\n### \u91cd\u7f6e`max_connections`\\n\\n```bash\\nALTER SYSTEM RESET max_connections;\\n```\\n\\n### \u67e5\u770b`max_connections`\\n\\n```bash\\nSHOW max_connections;\\n```\\n\\n## \u53c2\u8003\\n\\n- [Query a parameter (postgresql.conf setting) like \\"max_connections\\"](https://stackoverflow.com/questions/8288823/query-a-parameter-postgresql-conf-setting-like-max-connections)\\n- [How to increase max_connection in the official PostgreSQL Docker image](https://stackoverflow.com/questions/47252026/how-to-increase-max-connection-in-the-official-postgresql-docker-image)\\n- [Tuning Postgres Max Connections](https://linuxhint.com/tuning-postgres-max-connections/)"},{"id":"/2023/02/12/","metadata":{"permalink":"/markdowns/blog/2023/02/12/","source":"@site/blog/2023-02-12.md","title":"\u5c06postgresql\u4e2d\u6307\u5b9a\u7684database\u5bfc\u51fa\u4e3asql\u6587\u4ef6","description":"\u5728\u4f7f\u7528postgresql\u65f6, \u6709\u65f6\u5019\u9700\u8981\u5c06database\u5bfc\u51fa\u4e3asql\u6587\u4ef6, \u4ee5\u4fbf\u4e8e\u5728\u5176\u4ed6\u73af\u5883\u4e2d\u4f7f\u7528.","date":"2023-02-12T00:00:00.000Z","formattedDate":"February 12, 2023","tags":[{"label":"postgresql","permalink":"/markdowns/blog/tags/postgresql"}],"readingTime":0.38,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["postgresql"]},"prevItem":{"title":"\u4fee\u6539postgresql\u4e2d\u7684\u6700\u5927\u8fde\u63a5\u6570","permalink":"/markdowns/blog/2023/02/13/"},"nextItem":{"title":"\u5728Docker\u4e2d\u4f7f\u7528Rclone\u5e76\u5c06\u5bf9\u5e94\u7684fuse\u6302\u8f7d\u5230\u5bbf\u4e3b\u673a","permalink":"/markdowns/blog/2023/02/11/"}},"content":"\u5728\u4f7f\u7528`postgresql`\u65f6, \u6709\u65f6\u5019\u9700\u8981\u5c06`database`\u5bfc\u51fa\u4e3a`sql`\u6587\u4ef6, \u4ee5\u4fbf\u4e8e\u5728\u5176\u4ed6\u73af\u5883\u4e2d\u4f7f\u7528.\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n```bash\\npg_dump --column-inserts --data-only --table=<table> <database>\\n```\\n\\n\u8be5\u547d\u4ee4\u4f1a\u5c06`<database>`\u4e2d\u7684`<table>`\u5bfc\u51fa\u4e3a`sql`\u6587\u4ef6\\n\\n### \u53c2\u8003\\n\\n- [Using pg_dump to only get insert statements from one table within database](https://stackoverflow.com/questions/2857989/using-pg-dump-to-only-get-insert-statements-from-one-table-within-database)\\n- [Dump Your PostgreSQL Database](https://www.netguru.com/blog/how-to-dump-and-restore-postgresql-database)"},{"id":"/2023/02/11/","metadata":{"permalink":"/markdowns/blog/2023/02/11/","source":"@site/blog/2023-02-11.md","title":"\u5728Docker\u4e2d\u4f7f\u7528Rclone\u5e76\u5c06\u5bf9\u5e94\u7684fuse\u6302\u8f7d\u5230\u5bbf\u4e3b\u673a","description":"\u5728Docker\u4e2d\u4f7f\u7528Rclone\u65f6\u9700\u8981\u5c06fuse\u6302\u8f7d\u5230\u5bbf\u4e3b\u673a.","date":"2023-02-11T00:00:00.000Z","formattedDate":"February 11, 2023","tags":[{"label":"rclone","permalink":"/markdowns/blog/tags/rclone"},{"label":"docker","permalink":"/markdowns/blog/tags/docker"},{"label":"fuse","permalink":"/markdowns/blog/tags/fuse"}],"readingTime":0.56,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["rclone","docker","fuse"]},"prevItem":{"title":"\u5c06postgresql\u4e2d\u6307\u5b9a\u7684database\u5bfc\u51fa\u4e3asql\u6587\u4ef6","permalink":"/markdowns/blog/2023/02/12/"},"nextItem":{"title":"\u4f7f\u7528pyenv\u5b9e\u73b0python\u591a\u7248\u672c\u7ba1\u7406","permalink":"/markdowns/blog/2023/02/10/"}},"content":"\u5728`Docker`\u4e2d\u4f7f\u7528`Rclone`\u65f6\u9700\u8981\u5c06`fuse`\u6302\u8f7d\u5230\u5bbf\u4e3b\u673a.<br/>\\n\u8fd9\u6837\u53ef\u4ee5\u5728\u5bbf\u4e3b\u673a\u4e0a\u4f7f\u7528`Rclone`\u6302\u8f7d\u7684\u6587\u4ef6\u5939\u4ee5\u53ca\u53ef\u4ee5\u5bf9`fuse`\u8fdb\u884c\u64cd\u4f5c<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n```bash\\n# perform mount inside Docker container, expose result to host\\nmkdir -p ~/data/mount\\ndocker run --rm \\\\\\n    --volume ~/.config/rclone:/config/rclone \\\\\\n    --volume ~/data:/data:shared \\\\\\n    --user $(id -u):$(id -g) \\\\\\n    --volume /etc/passwd:/etc/passwd:ro --volume /etc/group:/etc/group:ro \\\\\\n    --device /dev/fuse --cap-add SYS_ADMIN --security-opt apparmor:unconfined \\\\\\n    rclone/rclone \\\\\\n    mount dropbox:Photos /data/mount &\\nls ~/data/mount\\nkill %1\\n```\\n\\n## \u53c2\u8003\\n\\n- [Rclone docker | Explained](https://bobcares.com/blog/rclone-docker/)"},{"id":"/2023/02/10/","metadata":{"permalink":"/markdowns/blog/2023/02/10/","source":"@site/blog/2023-02-10.md","title":"\u4f7f\u7528pyenv\u5b9e\u73b0python\u591a\u7248\u672c\u7ba1\u7406","description":"pyenv\u662f\u4e00\u4e2apython\u7248\u672c\u7ba1\u7406\u5de5\u5177, \u53ef\u4ee5\u65b9\u4fbf\u7684\u7ba1\u7406\u591a\u4e2apython\u7248\u672c.","date":"2023-02-10T00:00:00.000Z","formattedDate":"February 10, 2023","tags":[{"label":"pyenv","permalink":"/markdowns/blog/tags/pyenv"},{"label":"python","permalink":"/markdowns/blog/tags/python"}],"readingTime":3.145,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["pyenv","python"]},"prevItem":{"title":"\u5728Docker\u4e2d\u4f7f\u7528Rclone\u5e76\u5c06\u5bf9\u5e94\u7684fuse\u6302\u8f7d\u5230\u5bbf\u4e3b\u673a","permalink":"/markdowns/blog/2023/02/11/"},"nextItem":{"title":"JDK\u6539\u8fdb\u9879\u76ee\u7684\u4ecb\u7ecd","permalink":"/markdowns/blog/2023/02/09/"}},"content":"`pyenv`\u662f\u4e00\u4e2a`python`\u7248\u672c\u7ba1\u7406\u5de5\u5177, \u53ef\u4ee5\u65b9\u4fbf\u7684\u7ba1\u7406\u591a\u4e2a`python`\u7248\u672c.<br/>\\n\u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\u6709\u7684\u65f6\u5019\u4f1a\u6709\u591a\u4e2a`python`\u7248\u672c\u7684\u9700\u6c42.<br/>\\n\u4f8b\u5982, \u6709\u7684\u9879\u76ee\u9700\u8981`python3.6`, \u6709\u7684\u9879\u76ee\u9700\u8981`python3.7`. \u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u4f7f\u7528`pyenv`\u6765\u7ba1\u7406\u591a\u4e2a`python`\u7248\u672c.<br/>\\n\u76ee\u524d\u5e02\u9762\u4e0a\u6709\u5f88\u591a`python`\u7248\u672c\u7ba1\u7406\u5de5\u5177, \u4f8b\u5982`pyenv`, `conda`\u7b49.<br/>\\n`pyenv`\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u5de5\u5177, \u4f46\u662f\u529f\u80fd\u4e5f\u5f88\u5f3a\u5927, \u9002\u5408\u4e8e\u5f00\u53d1\u8005\u4f7f\u7528.<br/>\\n\u4e0b\u9762\u5c06\u4ee5`python3.11.0`\u4e3a\u4f8b\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528`pyenv`\u6765\u7ba1\u7406\u591a\u4e2a`python`\u7248\u672c<br/>\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### \u5c06`github`\u4e0a\u7684`pyenv`\u4ed3\u5e93`clone`\u5230\u672c\u5730\\n\\n```bash\\ngit clone git@github.com:pyenv/pyenv.git\\n```\\n\\n### \u914d\u7f6e`~/.bashrc`\\n\\n\u5c06\u4ee5\u4e0b\u914d\u7f6e\u6dfb\u52a0\u5230`~/.bashrc`, \u6ce8\u610f\u5c06`<pyenv-path>`\u66ff\u6362\u4e3a`pyenv`\u7684\u5b9e\u9645\u8def\u5f84\\n\\n```bash\\n# pyenv\\nexport PATH=<pyenv-path>/bin:$PATH\\nexport PYENV_VIRTUALENV_DISABLE_PROMPT=1\\neval \\"$(pyenv init -)\\"\\neval \\"$(pyenv virtualenv-init -)\\"\\npyenv deactivate\\n```\\n\\n### \u4f7f`~/.bashrc`\u4e2d\u7684\u914d\u7f6e\u751f\u6548\\n\\n\u91cd\u65b0\u52a0\u8f7d`~/.bashrc`, \u8fd9\u4e48\u505a\u662f\u4e3a\u4e86\u8ba9`pyenv`\u7684\u914d\u7f6e\u751f\u6548\\n\\n```bash\\nsource ~/.bashrc\\n```\\n\\n### \u4e0b\u8f7d`python`\u5b89\u88c5\u5305\u5230`cache`\u76ee\u5f55\u4ee5\u52a0\u5feb\u5b89\u88c5\u901f\u5ea6\\n\\n\u4f7f\u7528`pyenv`\u5b89\u88c5`python`\u65f6\u4f1a\u6bd4\u8f83\u6162, \u8fd9\u662f\u56e0\u4e3a\u8bbf\u95ee\u56fd\u5916\u7f51\u7ad9\u4f1a\u6bd4\u8f83\u6162. <br/>\\n\u53ef\u4ee5\u5148\u5c06`python`\u7684\u5b89\u88c5\u5305\u4e0b\u8f7d\u5230\u521a\u624d`clone`\u7684\u9879\u76ee\u7684`cache`\u76ee\u5f55\u4e0b. <br/>\\n\u901a\u8fc7\u4e0b\u8f7d\u5668\u4f8b\u5982`\u8fc5\u96f7`\u53ef\u4ee5\u66f4\u5feb\u7684\u4e0b\u8f7d.<br/>\\n\u540e\u7eed\u4f7f\u7528`pyenv`\u8fdb\u884c`install`\u65f6\u4f1a\u4ece`cache`\u76ee\u5f55\u4e0b\u8bfb\u53d6\u5b89\u88c5\u5305, \u901f\u5ea6\u4f1a\u5feb\u5f88\u591a<br/>\\n\u4ee5`3.11.0`\u4e3a\u4f8b, \u4e0b\u8f7d\u5730\u5740\u4e3a: `https://www.python.org/ftp/python/3.11.0/Python-3.11.0.tar.xz` <br/>\\n\u53ef\u4ee5\u8fdb\u5165`https://www.python.org/ftp/python/` \u67e5\u770b\u6240\u6709`python`\u7248\u672c\u7684\u5b89\u88c5\u5305\u4e0b\u8f7d\u5730\u5740.<br/>\\n\\n### \u5b89\u88c5\u5fc5\u8981\u7684\u4f9d\u8d56\\n\\n\u4f7f\u7528`pyenv`\u5b89\u88c5`python`\u65f6, \u9700\u8981\u5b89\u88c5\u4e00\u4e9b\u4f9d\u8d56, \u5426\u5219\u5b89\u88c5\u65f6\u4f1a\u62a5\u9519.<br/>\\n\u901a\u5e38\u8fd9\u4e9b\u4f9d\u8d56\u7684\u524d\u7f00\u4e3a`lib***-dev`.<br/>\\n\\n\u4ee5\u4e0b\u662f\u6211\u4ee5\u524d\u5b89\u88c5`python`\u65f6\u9047\u5230\u7684\u4f9d\u8d56, \u5404\u4e2a\u7248\u672c\u53ef\u80fd\u4e0d\u4e00\u6837, \u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u5b89\u88c5.<br/>\\n\\n```bash\\nfor package in libncurses-dev build-essential zlib1g-dev libffi-dev libssl-dev libbz2-dev libreadline-dev libsqlite3-dev liblzma-dev; do\\n  apt-get install -y $package\\ndone\\n```\\n\\n```bash\\npyenv install 3.11.0\\n```\\n\\n### \u521b\u5efa`virtualenv`, \u540d\u79f0\u4e3a`python3.11.0`\\n\\n```bash\\npyenv virtualenv 3.11.0 python3.11.0\\npyenv activate 3.11.0/envs/python3.11.0\\n```\\n\\n### \u8ffd\u52a0`pyenv activate`\u5230`~/.bashrc`\\n\\n\u5c06\u4ee5\u4e0b\u914d\u7f6e\u6dfb\u52a0\u5230`~/.bashrc`, \u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u6bcf\u6b21\u6253\u5f00`terminal`\u65f6\u81ea\u52a8\u6fc0\u6d3b`virtualenv`.\\n\\n```bash\\npyenv activate python3.11.0\\n```\\n\\n## \u5907\u6ce8\\n\\n### \u5e38\u7528\u547d\u4ee4\\n\\n- \u5b89\u88c5\u7279\u5b9a\u7248\u672c\u7684python\\n\\n```bash\\npyenv install <python-version>\\n```\\n\\n- \u521b\u5efa\u865a\u62df\u73af\u5883\\n\\n```bash\\npyenv virtualenv <python-version> <virtualenv-name>\\n```\\n\\n- \u5217\u51fa\u6240\u6709\u865a\u62df\u73af\u5883\\n\\n```bash\\npyenv virtualenvs\\n```\\n\\n- \u4f7f\u7528\u865a\u62df\u73af\u5883\\n\\n```bash\\npyenv activate <python-version>/envs/<virtualenv-name>\\n```\\n\\n- \u89e3\u9664\u865a\u62df\u73af\u5883\\n\\n```bash\\npyenv deactivate\\n```\\n\\n## \u53c2\u8003\\n\\n- [pyenv](https://github.com/pyenv/pyenv)\\n- [python repo](https://www.python.org/ftp/python/)"},{"id":"/2023/02/09/","metadata":{"permalink":"/markdowns/blog/2023/02/09/","source":"@site/blog/2023-02-09.md","title":"JDK\u6539\u8fdb\u9879\u76ee\u7684\u4ecb\u7ecd","description":"\u4ee5\u4e0b\u5217\u8868\u662f\u622a\u81f3\u5230\u76ee\u524dOpen JDK\u4e2d\u90e8\u5206\u8fdb\u884c\u7684\u5bf9JDK\u7684\u6539\u8fdb\u9879\u76ee","date":"2023-02-09T00:00:00.000Z","formattedDate":"February 9, 2023","tags":[{"label":"java","permalink":"/markdowns/blog/tags/java"}],"readingTime":1.79,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["java"]},"prevItem":{"title":"\u4f7f\u7528pyenv\u5b9e\u73b0python\u591a\u7248\u672c\u7ba1\u7406","permalink":"/markdowns/blog/2023/02/10/"},"nextItem":{"title":"\u5728TestContainers\u4e2d\u5b9e\u73b0Docker registry\u8ba4\u8bc1","permalink":"/markdowns/blog/2023/02/08/"}},"content":"\u4ee5\u4e0b\u5217\u8868\u662f\u622a\u81f3\u5230\u76ee\u524d`Open JDK`\u4e2d\u90e8\u5206\u8fdb\u884c\u7684\u5bf9`JDK`\u7684\u6539\u8fdb\u9879\u76ee\\n\\n- Amber\\n- Galahad\\n- Leyden\\n- Lilliput\\n- Loom\\n- Panama\\n- Valhalla\\n\\n\u8fd9\u4e9b\u6539\u8fdb\u9879\u76ee\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u6539\u8fdb`Java`\u7684\u6027\u80fd\u548c\u5f00\u53d1\u4f53\u9a8c. \\n\u4ece\u800c\u4f7f`Java`\u80fd\u591f\u66f4\u597d\u5730\u9002\u5e94\u76ee\u524d\u7684\u8f6f\u4ef6\u5f00\u53d1\u9700\u6c42.<br/>\\n\u4ee5\u4e0b\u662f\u8fd9\u4e9b\u9879\u76ee\u7684\u7b80\u5355\u4ecb\u7ecd.\\n\\n\x3c!--truncate--\x3e\\n\\n## Amber\\n\\n\u8be5\u9879\u76ee\u7684\u76ee\u6807\u662f\u5728`Java`\u4e2d\u5f15\u5165\u65b0\u7684\u8bed\u6cd5\u6765\u6539\u8fdb`Java`\u7684\u5f00\u53d1\u4f53\u9a8c\\n\\n- [Project Amber](https://openjdk.org/projects/amber/)\\n\\n## Galahad\\n\\n\u8be5\u9879\u76ee\u7684\u76ee\u6807\u662f\u5c06`GraalVM`\u4e2d\u4f7f\u7528`Java`\u7f16\u7684`JIT`\u7f16\u8bd1\u5668\u66ff\u6362\u6389`OpenJDK`\u4e2d\u73b0\u6709\u7684`HotSpot`\u4e2d\u4f7f\u7528`C++`\u5b9e\u73b0\u7684`JIT`\u7f16\u8bd1\u5668.\\n\\n- [GraalVM, Galahad, and a New Release Schedule](https://medium.com/graalvm/graalvm-galahad-and-a-new-release-schedule-d081d1031bba)\\n\\n## Leyden\\n\\n\u8be5\u9879\u76ee\u7684\u76ee\u6807\u662f\u6539\u8fdb`Java`\u7a0b\u5e8f\u7684\u542f\u52a8\u65f6\u95f4\\n\\n- [Project Leyden](https://openjdk.org/projects/leyden/)\\n\\n## Lilliput\\n\\n\u8be5\u9879\u76ee\u7684\u76ee\u6807\u662f\u5c06`Java`\u4e2d\u5bf9\u8c61\u7684\u5934\u90e8\u4fe1\u606f\u4ece`128`\u4f4d\u538b\u7f29\u5230`64`\u4f4d\u6216\u66f4\u4f4e, \u4ece\u800c\u6539\u5584`Java`\u7a0b\u5e8f\u7684\u5185\u5b58\u5360\u7528\\n\\n- [Lilliput](https://openjdk.org/projects/lilliput/)\\n\\n## Loom\\n\\n\u8be5\u9879\u76ee\u7684\u76ee\u6807\u662f\u5728Java\u4e2d\u5f15\u5165\u534f\u7a0b(`coroutine`)\u4ee5\u6539\u8fdbJava\u7684\u5e76\u53d1\u6027\u80fd\\n\\n- [Loom - Fibers, Continuations and Tail-Calls for the JVM](https://openjdk.org/projects/loom/)\\n\\n## Panama\\n\\n\u8be5\u9879\u76ee\u7684\u76ee\u6807\u662f\u63d0\u4f9b\u66f4\u597d\u7684`Java`\u4e0e\u7b2c\u4e09\u65b9\u4ee3\u7801\u7684\u4e92\u64cd\u4f5c\u6027, \u4f7f`Java`\u4e0e\u975e`Java`\u7f16\u5199\u7684\u4ee3\u7801\u80fd\u591f\u66f4\u597d\u5730\u4ea4\u4e92\\n\\n- [Project Panama: Interconnecting JVM and native code](https://openjdk.org/projects/panama/)\\n\\n## Valhalla\\n\\n\u8be5\u9879\u76ee\u7684\u76ee\u6807\u662f\u5728`Java`\u4e2d\u589e\u52a0`Value Type`\u7684\u529f\u80fd\u4ee5\u63d0\u9ad8`Java`\u7a0b\u5e8f\u7684\u6027\u80fd\u548c\u5185\u5b58\u6548\u7387\\n\\n- [Project Valhalla](https://openjdk.org/projects/valhalla/)"},{"id":"/2023/02/08/","metadata":{"permalink":"/markdowns/blog/2023/02/08/","source":"@site/blog/2023-02-08.md","title":"\u5728TestContainers\u4e2d\u5b9e\u73b0Docker registry\u8ba4\u8bc1","description":"\u5728docker registry\u914d\u7f6e\u4e86\u8ba4\u8bc1\u540e, \u9879\u76ee\u4e2dCICD\u4e2d\u8fd0\u884c\u7684test case\u5931\u8d25, \u9519\u8bef\u65e5\u5fd7\u5982\u4e0b","date":"2023-02-08T00:00:00.000Z","formattedDate":"February 8, 2023","tags":[{"label":"testcontainers","permalink":"/markdowns/blog/tags/testcontainers"},{"label":"docker","permalink":"/markdowns/blog/tags/docker"}],"readingTime":0.99,"hasTruncateMarker":true,"authors":[{"name":"Xiangcheng Kuo","title":"programmer on jvm platform","url":"https://github.com/orange-guo","imageURL":"https://github.com/orange-guo.png","key":"xiangcheng.kuo"}],"frontMatter":{"authors":["xiangcheng.kuo"],"tags":["testcontainers","docker"]},"prevItem":{"title":"JDK\u6539\u8fdb\u9879\u76ee\u7684\u4ecb\u7ecd","permalink":"/markdowns/blog/2023/02/09/"}},"content":"\u5728`docker registry`\u914d\u7f6e\u4e86\u8ba4\u8bc1\u540e, \u9879\u76ee\u4e2d`CICD`\u4e2d\u8fd0\u884c\u7684`test case`\u5931\u8d25, \u9519\u8bef\u65e5\u5fd7\u5982\u4e0b\\n\\n```log\\nCaused by: org.testcontainers.containers.ContainerFetchException: Can\'t get Docker image: RemoteDockerImage(imageName=hub.fastonetech.com/cce/fastone-auditing:latest, imagePullPolicy=AlwaysPullPolicy(), imageNameSubstitutor=org.testcontainers.utility.ImageNameSubstitutor$LogWrappedImageNameSubstitutor@3b68a50c)\\n\\tat app//org.testcontainers.containers.GenericContainer.getDockerImageName(GenericContainer.java:1371)\\n\\tat app//org.testcontainers.containers.GenericContainer.logger(GenericContainer.java:651)\\n\\tat app//org.testcontainers.containers.GenericContainer.doStart(GenericContainer.java:331)\\n\\t... 153 more\\nCaused by: org.testcontainers.containers.ContainerFetchException: Failed to pull image: hub.fastonetech.com/cce/fastone-auditing:latest\\n\\tat app//org.testcontainers.images.RemoteDockerImage.resolve(RemoteDockerImage.java:119)\\n\\tat app//org.testcontainers.images.RemoteDockerImage.resolve(RemoteDockerImage.java:28)\\n\\tat app//org.testcontainers.utility.LazyFuture.getResolvedValue(LazyFuture.java:17)\\n\\tat app//org.testcontainers.utility.LazyFuture.get(LazyFuture.java:39)\\n\\tat app//org.testcontainers.containers.GenericContainer.getDockerImageName(GenericContainer.java:1369)\\n\\t... 155 more\\nCaused by: com.github.dockerjava.api.exception.InternalServerErrorException: Status 500: {\\"message\\":\\"unauthorized: unauthorized to access repository: cce/fastone-auditing, action: pull: unauthorized to access repository: cce/fastone-auditing, action: pull\\"}\\n\\n\\tat app//org.testcontainers.shaded.com.github.dockerjava.core.DefaultInvocationBuilder.execute(DefaultInvocationBuilder.java:247)\\n\\tat app//org.testcontainers.shaded.com.github.dockerjava.core.DefaultInvocationBuilder.lambda$executeAndStream$1(DefaultInvocationBuilder.java:269)\\n\\tat java.base@17.0.1/java.lang.Thread.run(Thread.java:833)\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n\u6839\u636e\u4e0a\u8ff0\u65e5\u5fd7\u4e2d\u7684\u5173\u952e\u4fe1\u606f\u5f97\u51fa\u7531\u4e8e`docker registry`\u672a\u8ba4\u8bc1\u5bfc\u81f4\u8be5\u95ee\u9898\u7684\u51fa\u73b0\\n\\n```log\\nCaused by: com.github.dockerjava.api.exception.InternalServerErrorException: Status 500: {\\"message\\":\\"unauthorized: unauthorized to access repository: cce/fastone-auditing, action: pull: unauthorized to access repository: cce/fastone-auditing, action: pull\\"}\\n```\\n\\n\u6267\u884c`docker login`\u547d\u4ee4\uff0c\u7136\u540e\u4ece`~/.docker/config.json`\u4e2d\u83b7\u53d6\u8ba4\u8bc1\u4fe1\u606f\u4f5c\u4e3a`DOCKER_AUTH_CONFIG`\u73af\u5883\u53d8\u91cf\u7684\u503c\\n\\n```bash\\ndocker login -u <username> -p <password> <registry>\\nDOCKER_AUTH_CONFIG=\\"\\"\\nDOCKER_AUTH_CONFIG=$(cat ~/.docker/config.json)\\nexport DOCKER_AUTH_CONFIG\\n```\\n\\n## \u53c2\u8003\\n\\n- [Docker registry authentication](https://www.testcontainers.org/supported_docker_environment/#docker-registry-authentication)"}]}')}}]);