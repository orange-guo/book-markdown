"use strict";(self.webpackChunkmarkdowns=self.webpackChunkmarkdowns||[]).push([[4361],{3905:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>v});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),c=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=c(e.components);return a.createElement(p.Provider,{value:t},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},b=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),g=c(r),b=n,v=g["".concat(p,".").concat(b)]||g[b]||u[b]||o;return r?a.createElement(v,i(i({ref:t},l),{},{components:r})):a.createElement(v,i({ref:t},l))}));function v(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=b;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[g]="string"==typeof e?e:n,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}b.displayName="MDXCreateElement"},9850:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=r(7462),n=(r(7294),r(3905));const o={},i="cluster-scheduler\u96c6\u6210fastone-security-spring-boot-starter\u540e\u62a5\u9519\u63d0\u793aNo ServletContext set",s={unversionedId:"problem/spring/0011",id:"problem/spring/0011",title:"cluster-scheduler\u96c6\u6210fastone-security-spring-boot-starter\u540e\u62a5\u9519\u63d0\u793aNo ServletContext set",description:"\u73b0\u8c61",source:"@site/docs/problem/spring/0011.md",sourceDirName:"problem/spring",slug:"/problem/spring/0011",permalink:"/markdowns/docs/problem/spring/0011",draft:!1,editUrl:"https://github.com/orange-guo/markdowns/tree/master/docs/problem/spring/0011.md",tags:[],version:"current",lastUpdatedBy:"xiangcheng.kuo",lastUpdatedAt:1676615144,formattedLastUpdatedAt:"Feb 17, 2023",frontMatter:{},sidebar:"problem",previous:{title:"fastone-billing-sync\u670d\u52a1\u5347\u7ea7springboot3\u4e2d\u6784\u5efanative-image\u9047\u5230\u7684\u95ee\u9898",permalink:"/markdowns/docs/problem/spring/0010"},next:{title:"fastone-api\u5347\u7ea7spring-boot3\u540e\u8bf7\u6c42/swagger-ui/index.html\u62a5\u9519",permalink:"/markdowns/docs/problem/spring/0012"}},p={},c=[{value:"\u73b0\u8c61",id:"\u73b0\u8c61",level:2},{value:"\u539f\u56e0",id:"\u539f\u56e0",level:2},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",level:2},{value:"\u5907\u6ce8",id:"\u5907\u6ce8",level:2}],l={toc:c};function g(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},l,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"cluster-scheduler\u96c6\u6210fastone-security-spring-boot-starter\u540e\u62a5\u9519\u63d0\u793ano-servletcontext-set"},"cluster-scheduler\u96c6\u6210fastone-security-spring-boot-starter\u540e\u62a5\u9519\u63d0\u793aNo ServletContext set"),(0,n.kt)("h2",{id:"\u73b0\u8c61"},"\u73b0\u8c61"),(0,n.kt)("p",null,"\u65e5\u5fd7\u5982\u4e0b\u3002"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-log"},"Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.\n2023-01-30T15:02:32.838Z ERROR 1 --- [           main] o.s.boot.SpringApplication               : Application run failed\n\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'resourceHandlerMapping' defined in class path resource [org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration$EnableWebMvcConfiguration.class]: Failed to instantiate [org.springframework.web.servlet.HandlerMapping]: Factory method 'resourceHandlerMapping' threw exception with message: No ServletContext set\n        at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:657) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:645) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1324) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1161) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:561) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:961) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:915) ~[spring-context-6.0.4.jar:6.0.4]\n        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:584) ~[spring-context-6.0.4.jar:6.0.4]\n        at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.0.2.jar:3.0.2]\n        at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:730) ~[spring-boot-3.0.2.jar:3.0.2]\n        at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:432) ~[spring-boot-3.0.2.jar:3.0.2]\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:308) ~[spring-boot-3.0.2.jar:3.0.2]\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1302) ~[spring-boot-3.0.2.jar:3.0.2]\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1291) ~[spring-boot-3.0.2.jar:3.0.2]\n        at com.fastonetech.clusterscheduler.ClusterSchedulerApplication.main(ClusterSchedulerApplication.java:20) ~[classes/:na]\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.web.servlet.HandlerMapping]: Factory method 'resourceHandlerMapping' threw exception with message: No ServletContext set\n        at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:171) ~[spring-beans-6.0.4.jar:6.0.4]\n        at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653) ~[spring-beans-6.0.4.jar:6.0.4]\n        ... 19 common frames omitted\nCaused by: java.lang.IllegalStateException: No ServletContext set\n        at org.springframework.util.Assert.state(Assert.java:76) ~[spring-core-6.0.4.jar:6.0.4]\n        at org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport.resourceHandlerMapping(WebMvcConfigurationSupport.java:581) ~[spring-webmvc-6.0.4.jar:6.0.4]\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\n        at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\n        at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:139) ~[spring-beans-6.0.4.jar:6.0.4]\n        ... 20 common frames omitted\n")),(0,n.kt)("h2",{id:"\u539f\u56e0"},"\u539f\u56e0"),(0,n.kt)("p",null,"FastoneSecurityContextService\u7c7b\u4e2d\u7684AuthService\u4e3a\u6784\u9020\u6ce8\u5165\u5bfc\u81f4\u8be5\u9519\u8bef\u53d1\u751f(\u5177\u4f53\u9519\u8bef\u539f\u56e0\u672a\u77e5),\n\u4e3aAuthService\u4e3a\u5c5e\u6027\u589e\u52a0@Autowired\u548c@Lazy\u6ce8\u89e3\u540e, \u8be5\u9519\u8bef\u6d88\u5931"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"\n@Service\n@RequiredArgsConstructor\npublic class FastoneSecurityContextService implements SecurityContextService {\n\n    private final FastoneUserDetailsService userDetailsService;\n\n    private final AuthService authService;\n\n}\n")),(0,n.kt)("h2",{id:"\u89e3\u51b3\u65b9\u6848"},"\u89e3\u51b3\u65b9\u6848"),(0,n.kt)("p",null,"\u4fee\u6539FastoneSecurityContextService\u7c7b, \u4e3aAuthService\u4e3a\u5c5e\u6027\u589e\u52a0@Autowired\u548c@Lazy\u6ce8\u89e3"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"\n@Service\n@RequiredArgsConstructor\npublic class FastoneSecurityContextService implements SecurityContextService {\n\n    @Autowired\n    private FastoneUserDetailsService userDetailsService;\n\n    @Autowired\n    private final AuthService authService;\n\n}\n")),(0,n.kt)("p",null,"\u6216\u8005\u4f7f\u7528",(0,n.kt)("inlineCode",{parentName:"p"},"java-config"),"\u65b9\u5f0f"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"\n@Configuration\npublic class UserConfiguration {\n\n    @Bean\n    public FastoneSecurityContextService securityContextService(FastoneUserDetailsService userDetailsService, @Lazy AuthService authService) {\n        return new FastoneSecurityContextService(userDetailsService, authService);\n    }\n\n}\n")),(0,n.kt)("h2",{id:"\u5907\u6ce8"},"\u5907\u6ce8"))}g.isMDXComponent=!0}}]);